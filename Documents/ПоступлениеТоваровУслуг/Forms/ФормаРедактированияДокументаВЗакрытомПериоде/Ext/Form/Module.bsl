
Процедура ЗаписатьДокСервер()
	
	ОбъектДок = РеквизитФормыВЗначение("Объект");
	ОбъектДок.НеПроверятьДатуЗапретаРедактирования = Истина;
	
	ОбъектДок.Записать();
	
	Если ОбъектДок.Проведен Тогда
		ОбъектДок.Движения.Финансовый.Прочитать();
		ОбъектДок.ВыполнитьДвиженияПоРасчетамСКонтрагентами();
		ОбъектДок.Движения.РасчетыСКонтрагентами.Записать();
	КонецЕсли; 
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаписатьДок(Команда)

	ЗаписатьДокСервер();
	
	Модифицированность=Ложь;
	
	ВладелецФормы.ЭтотОбъект.Прочитать();
	
КонецПроцедуры

&НаКлиенте
Процедура СтатусПолученныхДокументовПриИзменении(Элемент)
	
	Если ЗначениеЗаполнено(ВладелецФормы.ТекСтатус)
			И НЕ ЗначениеЗаполнено(Объект.СтатусПолученныхДокументов) Тогда
		
	    Сообщить("Нельзя очистить статус прикрепленных документов, если он был заполнен");
		Объект.СтатусПолученныхДокументов = ВладелецФормы.ТекСтатус;
		
	Иначе
		
		ВладелецФормы.ТекСтатус = Объект.СтатусПолученныхДокументов;
		Объект.ДокументыПолучены = ЗначениеЗаполнено(Объект.СтатусПолученныхДокументов);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ДокументОснованиеПриИзменении(Элемент)
	
	Если ТипЗнч(Объект.ДокументОснование) = Тип("ДокументСсылка.ЗаявкаНаРасходованиеСредств")
			И ЗначениеЗаполнено(Объект.ДокументОснование) Тогда
		//СтатусПолученныхДокументов=ДокументОснование.СтатусПолученныхДокументов;
		//ДокументыПолучены=ЗначениеЗаполнено(СтатусПолученныхДокументов);
		Объект.Товары.Очистить();
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ДокументОснованиеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если ТипЗнч(Объект.ДокументОснование) = Тип("ДокументСсылка.ПриходныйОрдерСклад") Тогда
		
		СтруктураОтбора = Новый Структура("Поставщик, Организация", Объект.Контрагент, Объект.Организация);
		мПараметры = Новый Структура("РежимВыбора, Отбор", Истина, СтруктураОтбора);
		ОткрытьФорму("Документ.ПриходныйОрдерСклад.ФормаВыбора", мПараметры, Элемент);
		
		СтандартнаяОбработка = Ложь;
		
	ИначеЕсли ТипЗнч(Объект.ДокументОснование) = Тип("ДокументСсылка.ЗаявкаНаРасходованиеСредств") Тогда
		
		СтруктураОтбора = Новый Структура("Контрагент, Организация", Объект.Контрагент, Объект.Организация);
		мПараметры = Новый Структура("РежимВыбора, Отбор", Истина, СтруктураОтбора);
		ОткрытьФорму("Документ.ЗаявкаНаРасходованиеСредств.ФормаВыбора", мПараметры, Элемент);
		
		СтандартнаяОбработка = Ложь;
	КонецЕсли;
	
КонецПроцедуры
