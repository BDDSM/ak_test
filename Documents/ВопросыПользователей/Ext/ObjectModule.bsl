////////////////////////////////////////////////////////////////////////////////
// ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ
////////////////////////////////////////////////////////////////////////////////

Перем Админ Экспорт;




////////////////////////////////////////////////////////////////////////////////
// ВСПОМОГАТЕЛЬНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ
////////////////////////////////////////////////////////////////////////////////

Процедура ПоказатьПрикрепленныйФайл(ИмяФайла) Экспорт
	НайдСтрока = ТЧФайлы.Найти(ИмяФайла, "ИмяФайла");
	Если НайдСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;
	ДвоичныеДанные = НайдСтрока.Файл.Получить();
	Если ДвоичныеДанные = Неопределено Тогда
		Сообщить("Внешний файл отсутствует в базе!");
		Возврат;
	КонецЕсли; 
	времФайл = КаталогВременныхФайлов() + НайдСтрока.ИмяФайла;
	ДвоичныеДанные.Записать(времФайл);
	ЗапуститьПриложение(времФайл);
	//УдалитьФайлы(времФайл);
КонецПроцедуры // ПоказатьПрикрепленныйФайл()

Функция СвойВопрос() Экспорт
	Возврат Автор = ПараметрыСеанса.ТекущийПользователь;
КонецФункции // СвойВопрос()

Функция ФорматироватьСтрокуДляHTML(стр) Экспорт
	RegExp = Новый COMОбъект("VBScript.RegExp");
	RegExp.MultiLine    = Истина;
	RegExp.Global 		= Истина;
	RegExp.IgnoreCase   = Истина;
	RegExp.Pattern = Символы.ПС;
	Возврат СокрЛП(RegExp.Replace(стр, "<br>"));
КонецФункции // ФорматироватьСтрокуДляHTML()

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	RegExp = Новый COMОбъект("VBScript.RegExp");
	RegExp.MultiLine    = Истина;
	RegExp.Global 		= Истина;
	RegExp.IgnoreCase   = Истина;
	RegExp.Pattern 		= "'";
	Вопрос = СокрЛП(RegExp.Replace(Вопрос, ""));
КонецПроцедуры



////////////////////////////////////////////////////////////////////////////////
// ОСНОВНАЯ ЧАСТЬ
////////////////////////////////////////////////////////////////////////////////

Админ = МодульФорум.ПолныеПраваНаФоруме();