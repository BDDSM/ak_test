
Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ЗначениеЗаполнено(Сотрудник) = Ложь Тогда	
		Отказ = Истина;	
		Сообщить("Необходимо указать сотрудника.");
		Возврат;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДатаС)= Ложь ИЛИ ЗначениеЗаполнено(ДатаПо)= Ложь Тогда
		Отказ = Истина;	
		Сообщить("Необходимо указать период отпуска.");
	КонецЕсли;
	
	Если  ((ДатаС - Сотрудник.ДатаПриемаНаРаботу)/86400)<180 Тогда
		Отказ = Истина;	
		Сообщить("От даты приема до даты отпуска менее 180 дней.");
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ЭтотОбъект.Ссылка) = Ложь Тогда 
		Если ЭтотОбъект.ВидОтпуска = Перечисления.ВидОтпуска.Отпуск Тогда 
			Если (Число(НачалоДня(ЭтотОбъект.ДатаС) - НачалоДня(ТекущаяДата()))/86400)<15 Тогда 
				Отказ = Истина;
				Сообщить("До даты начала отпуска менее 14ти дней.");
			КонецЕсли;
		ИначеЕсли ЭтотОбъект.ВидОтпуска = Перечисления.ВидОтпуска.ЗаСвойСчет Тогда
			Если (Число(НачалоДня(ЭтотОбъект.ДатаС) - НачалоДня(ТекущаяДата()))/86400)<1 Тогда 
				Отказ = Истина;
				Сообщить("Создать отпуск можно только со следующего дня.");
			КонецЕсли;
		КонецЕсли;
		Если День(ЭтотОбъект.ДатаС) = 13 или День(ЭтотОбъект.ДатаС) = 28 Тогда 
			Отказ = Истина;
			Сообщить("Отпуск не может начинатся в 13 и 28 числах месяца.");
		КонецЕсли;
		Если ДеньНедели(ЭтотОбъект.ДатаС) = 6 или ДеньНедели(ЭтотОбъект.ДатаС) =6 Тогда 
			Отказ = Истина;
			Сообщить("Отпуск не может начинатся в субботу и воскресенье.");
		КонецЕсли;
	КонецЕсли;
	
	Ответственный =  ПараметрыСеанса.ТекущийПользователь
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	
	Если Отказ = Ложь и Согласован Тогда 
	   ПланыОбмена.ЗарегистрироватьИзменения(ПланыОбмена.ОбменСЗУП.НайтиПоНаименованию("ЗУП") ,Ссылка);
   КонецЕсли;	
   
КонецПроцедуры
