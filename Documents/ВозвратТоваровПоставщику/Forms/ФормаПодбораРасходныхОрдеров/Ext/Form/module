
Процедура ПриОткрытии()
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Контрагент"	, Контрагент);
	Запрос.УстановитьПараметр("Возврат"		, ВозвратТоваров);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ИСТИНА КАК Использование,
	|	РасходныйОрдерСклад.Ссылка КАК РасходныйОрдер
	|ПОМЕСТИТЬ ВремТаб
	|ИЗ
	|	Документ.РасходныйОрдерСклад КАК РасходныйОрдерСклад
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровПоставщику.РасходныеОрдера КАК ВозвратТоваровПоставщикуРасходныеОрдера
	|		ПО РасходныйОрдерСклад.Ссылка = ВозвратТоваровПоставщикуРасходныеОрдера.РасходныйОрдер
	|ГДЕ
	|	РасходныйОрдерСклад.Проведен
	|	И РасходныйОрдерСклад.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийРасходСкладскойУчет.ВозвратПоставщику)
	|	И РасходныйОрдерСклад.Получатель = &Контрагент
	|	И ВозвратТоваровПоставщикуРасходныеОрдера.РасходныйОрдер ЕСТЬ NULL 
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ИСТИНА,
	|	ВозвратТоваровПоставщикуРасходныеОрдера.РасходныйОрдер
	|ИЗ
	|	Документ.ВозвратТоваровПоставщику.РасходныеОрдера КАК ВозвратТоваровПоставщикуРасходныеОрдера
	|ГДЕ
	|	ВозвратТоваровПоставщикуРасходныеОрдера.Ссылка = &Возврат
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВремТаб.Использование,
	|	ВремТаб.РасходныйОрдер
	|ИЗ
	|	ВремТаб КАК ВремТаб
	|
	|СГРУППИРОВАТЬ ПО
	|	ВремТаб.Использование,
	|	ВремТаб.РасходныйОрдер
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВремТаб.РасходныйОрдер.Дата";
	
	ТаблицаРасходныхОрдеров = Запрос.Выполнить().Выгрузить();
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОК(Кнопка)
	
	Список.Очистить();
	Для Каждого СтрокаТаблицы Из ТаблицаРасходныхОрдеров Цикл
		Если СтрокаТаблицы.Использование Тогда
			Список.Добавить(СтрокаТаблицы);
		КонецЕсли;
	КонецЦикла;
	
	Закрыть(КодВозвратаДиалога.ОК);	
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОтмена(Кнопка)
	
	Закрыть(КодВозвратаДиалога.Отмена);	
	
КонецПроцедуры

Процедура КоманднаяПанель1ВыделитьВсе(Кнопка)
	
	УстановитьЗначениеИспользования(Истина);	
	
КонецПроцедуры

Процедура КоманднаяПанель1СнятьВсе(Кнопка)
	
	УстановитьЗначениеИспользования(Ложь);
	
КонецПроцедуры

Процедура УстановитьЗначениеИспользования(ЗначениеИспользования)

	Для Каждого Строка Из ТаблицаРасходныхОрдеров Цикл
		Строка.Использование = ЗначениеИспользования;
	КонецЦикла;
	
КонецПроцедуры
