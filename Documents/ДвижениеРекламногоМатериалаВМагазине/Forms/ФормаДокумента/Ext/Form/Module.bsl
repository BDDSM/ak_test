
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	//+++АК sils 07.06.2018 ИП-00018876
	ОперацияАпдекс = APDEX_ОценкаПроизводительностиКлиентСервер.ПолучитьОперацию("Открытие документа Движение рекламного материала в магазине");
	APDEX_ОценкаПроизводительностиКлиентСервер.НачатьЗамерВремени(ОперацияАпдекс);
	//---АК
	
	Если Объект.Ссылка.Пустая() Тогда
		Попытка
			Если НЕ ЗначениеЗаполнено(Объект.ТорговаяТочка) 
				И ЗначениеЗаполнено(ПараметрыСеанса.ТекущийПродавец) Тогда
				Объект.ТорговаяТочка = ПараметрыСеанса.ТорговаяТочкаПоАйпи;
			КонецЕсли;	
		Исключение
		КонецПопытки;	
	КонецЕсли;
	
	Если ТипЗнч(Параметры.МассивТоварыПриСоздании) = Тип("Массив") Тогда
		Для Каждого ЭлементТовар Из Параметры.МассивТоварыПриСоздании Цикл
			СтрокаДоб = Объект.Товары.Добавить();
			СтрокаДоб.Номенклатура = ЭлементТовар;
			СтрокаДоб.Количество 		= 1;
		КонецЦикла;	
	КонецЕсли;	
	
	Если РольДоступна("Продавец") И ЗначениеЗаполнено(ПараметрыСеанса.ТорговаяТочкаПоАйпи) Тогда
		Элементы.Дата.Доступность = Ложь;
		Элементы.Магазин.Доступность = Ложь;
		Элементы.Номер.Доступность = Ложь;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)
	
	Оповестить("РеклМатериалы.ОбновитьОстатки");
	
КонецПроцедуры

//+++АК sils 07.06.2018 ИП-00018876
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	APDEX_ОценкаПроизводительностиКлиентСервер.ЗакончитьЗамерВремени(ОперацияАпдекс, ?(Параметры.Ключ.Пустая(), "Новый документ", "" + Объект.Ссылка));
КонецПроцедуры
