
Функция  ПриказМероприятий(Документ,ТабличныйДокумент) Экспорт
	
	Макет = Документы.ПриказОПроведениеМероприятия.ПолучитьМакет("ПриказМероприятий");
	
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	
	ЗаполнитьПараметры(Документ,ОбластьШапка);
	
	ОбластьШапка.Параметры.Заполнить(Документ);
	
	ОбластьШапка.Параметры.ФИОДолжностьСотрудника	= ОбщегоНазначения.ФамилияИнициалыФизЛица(СокрЛП(Документ.СотрудникиОрганизации))
	+" "+ Документ.Должность;	
	
	ОбластьШапка.Параметры.Организация = Документ.Организация.НаименованиеПолное;
	
	Если Документ.МестоСписком Тогда
		
		СписокМест = "";
		
		Для каждого ТекСтрока Из Документ.СписокМест Цикл
		
			СписокМест = СписокМест +  Строка(ТекСтрока.Место) + Символы.ПС;
		
		КонецЦикла;	
		
		СписокМест = Лев(СписокМест,СтрДлина(СписокМест)-1);
		
		ОбластьШапка.Параметры.Место = СписокМест;
	
	КонецЕсли;
	
	ТабличныйДокумент.Вывести(ОбластьШапка);
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьПараметры(Документ,ОбластьШапка)

	РуководительФИО = ОбщегоНазначения.ФамилияИнициалыФизЛица(СокрЛП(Документ.Организация.ГенеральныйДиректор));

	РуководительДолжность = СокрЛП(Документ.Организация.должностьРуководителя);

	ОбластьШапка.Параметры.ДолжностьРуководителя  = РуководительДолжность;
	ОбластьШапка.Параметры.ФИОРуководителя  = РуководительФИО;
	
	ОбластьШапка.Параметры.НомерДокумента  = ОбщегоНазначения.ПолучитьНомерНаПечать(Документ);
	ОбластьШапка.Параметры.ДатаСоставления  = Документ.Дата;

КонецПроцедуры

Функция  ОтчетМероприятий(Документ,ТабличныйДокумент) Экспорт
	
	Макет = Документы.ПриказОПроведениеМероприятия.ПолучитьМакет("ОтчетМероприятий");
	
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	
	//ЗаполнитьПараметры(Документ,ОбластьШапка);
	
	//ОбластьШапка.Параметры.ДолжностьСотудника  = Документ.Должность;
	
	ОбластьШапка.Параметры.Заполнить(Документ);
	
	ОбластьШапка.Параметры.ФИОДолжностьСотрудника	= ОбщегоНазначения.ФамилияИнициалыФизЛица(СокрЛП(Документ.СотрудникиОрганизацииОтчет))
	+" "+ Документ.ДолжностьОтчет;		
	
	Если Документ.МестоСпискомОтчет Тогда
		
		СписокМест = "";
		
		Для каждого ТекСтрока Из Документ.СписокМестОтчет Цикл
		
			СписокМест = СписокМест + Строка(ТекСтрока.Место) + Символы.ПС;
		
		КонецЦикла;	
		
		СписокМест = Лев(СписокМест,СтрДлина(СписокМест)-1);
		
		ОбластьШапка.Параметры.МестоОтчет	= СписокМест;
	
	КонецЕсли;
	ОбластьШапка.Параметры.Организация = Документ.Организация.НаименованиеПолное;
	
	ТабличныйДокумент.Вывести(ОбластьШапка);
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Функция РасчетДней(ДатаНачала,ДатаОкончания)   
    
    Возврат (НачалоДня(ДатаОкончания) - НачалоДня(ДатаНачала)) / 86400;
        
КонецФункции
