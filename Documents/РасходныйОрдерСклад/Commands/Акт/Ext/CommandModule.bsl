
&НаСервере
Функция ПровереноОператором(ПараметрКоманды)
	
	Возврат ПараметрКоманды.ПровереноОператором;
	
КонецФункции

&НаСервере
Функция Печать(ПараметрКоманды)
	//+++АК BELN 2018.11.06 ИП-00019252 
	УстановитьПривилегированныйРежим(Истина);
	Если НЕ Документы.РасходныйОрдерСклад.ДоступнаПечать() Тогда
		Сообщить("Нет права на печать");
		Возврат Неопределено;
	КонецЕсли; 
	//---АК BELN 2018.11.06	
	Если ПараметрКоманды.ВидОперации = Перечисления.ВидыОперацийРасходСкладскойУчет.ОтгрузкаВПереработку Тогда
		Сообщить("При передаче в переработку необходимо печатать форму М-15 в 2-ух экземплярах");
		Возврат Неопределено;
	КонецЕсли;
	
	Возврат Документы.РасходныйОрдерСклад.ПечатьАкт(ПараметрКоманды);
	
КонецФункции

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)

	Если ПровереноОператором(ПараметрКоманды) Тогда
		
		ТабДок = Печать(ПараметрКоманды);
	  	Если ТабДок = Неопределено Тогда
			Возврат;
		КонецЕсли;

		ТабДок.ОтображатьСетку 		= Ложь;
		ТабДок.Защита 				= Ложь;
		ТабДок.ТолькоПросмотр 		= Истина;
		ТабДок.ОтображатьЗаголовки 	= Ложь;
		ТабДок.Показать();
		
	Иначе
		Предупреждение("Акт можно распечатать только после проверки оператором",);
	КонецЕсли
	
КонецПроцедуры
