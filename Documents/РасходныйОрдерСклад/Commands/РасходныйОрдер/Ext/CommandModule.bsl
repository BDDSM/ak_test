
&НаСервере
Функция Печать(ПараметрКоманды)
	//+++АК BELN 2018.11.06 ИП-00019252 
	УстановитьПривилегированныйРежим(Истина);
	Если НЕ Документы.РасходныйОрдерСклад.ДоступнаПечать() Тогда
		Сообщить("Нет права на печать");
		Возврат Неопределено;
	КонецЕсли; 
	//---АК BELN 2018.11.06	
	Если ПараметрКоманды.Склад.ЭтоСкладРеклМатериалов Тогда
		Возврат Документы.РасходныйОрдерСклад.ПечатьРасходныйОрдерРеклМатериалы_Товары(ПараметрКоманды);
	ИначеЕсли ПараметрКоманды.ВидОперации = Перечисления.ВидыОперацийРасходСкладскойУчет.ОтгрузкаВПереработку Тогда
		Сообщить("При передаче в переработку необходимо печатать форму М-15 в 2-ух экземплярах");
		Возврат Неопределено;
	ИначеЕсли ПараметрКоманды.ВидОперации = Перечисления.ВидыОперацийРасходСкладскойУчет.ПередачаОборудованияВТорговуюТочку Тогда
		Возврат Документы.РасходныйОрдерСклад.ПечатьРасходныйОрдер_Оборудование(ПараметрКоманды);
	Иначе
		//+++АК BELN 2018.11.28 ИП-00020565      
		Мас=Новый Массив;
		Мас.Добавить(ПараметрКоманды);
		Возврат Документы.РасходныйОрдерСклад.ПечатьРасходныйОрдер_Товары(ПараметрКоманды);
		//---АК BELN 2018.11.28       
	КонецЕсли;
	УстановитьПривилегированныйРежим(Ложь);
КонецФункции

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	//+++АК BELN 2018.11.28 ИП-00020565      
	Соот = Печать(ПараметрКоманды);
	
 	Если Соот = Неопределено Тогда
		Возврат;
	КонецЕсли;
	Если ТипЗнч(Соот)=Тип("Соответствие") Тогда
		ТабДок=Соот.Получить(ПараметрКоманды);
		Если ТабДок = Неопределено Тогда
			Возврат;
		КонецЕсли;
	Иначе	
		ТабДок=Соот;
	КонецЕсли;
	//---АК BELN 2018.11.28       
	ОповеститьОбИзменении(ПараметрКоманды);
	
	ТабДок.ОтображатьСетку			= Ложь;
	ТабДок.Защита					= Ложь;
	ТабДок.ТолькоПросмотр			= Истина;
	ТабДок.ОтображатьЗаголовки		= Ложь;
	ТабДок.ОриентацияСтраницы		= ОриентацияСтраницы.Портрет;
	ТабДок.РазмерКолонтитулаСнизу	= 0;
	ТабДок.РазмерКолонтитулаСверху 	= 0;
	ТабДок.ПолеСверху 				= 5;
	ТабДок.ПолеСнизу 				= 5;
	ТабДок.ПолеСлева 				= 5;
	ТабДок.ПолеСправа 				= 5;
	ТабДок.АвтоМасштаб				= Истина;
	ТабДок.Показать();
	
КонецПроцедуры
