
&НаКлиенте
Процедура РедактироватьПериод(Команда)
	
	СтандартныйПериод = Новый СтандартныйПериод(ДатаНачала, ДатаОкончания);
	ДиалогРедактирования = Новый ДиалогРедактированияСтандартногоПериода();
	ДиалогРедактирования.Период = СтандартныйПериод;
	Если ДиалогРедактирования.Редактировать() Тогда
		СтандартныйПериод = ДиалогРедактирования.Период;
		ДатаНачала = СтандартныйПериод.ДатаНачала;
		ДатаОкончания = СтандартныйПериод.ДатаОкончания;
	КонецЕсли;	
	
КонецПроцедуры

&НаСервере
Процедура ЗагрузитьДанныеСервер(ДатаОбработки)
	
	Обработки.ЗагрузкаДанныхИзAccess.ЗагрузитьДанныеОБланках_СКЛ_Новая(ДатаОбработки);
	
КонецПроцедуры
																				
&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	
	ДатаОбработки = ДатаНачала;
	Пока ДатаОбработки <= ДатаОкончания Цикл
		Состояние("Загрузка бланков за " + Формат(ДатаОбработки, "ДФ=dd.MM.yyyy") + " ...");
		ЗагрузитьДанныеСервер(ДатаОбработки);
		ОбработкаПрерыванияПользователя();
		ДатаОбработки = ДатаОбработки + 86400;
	КонецЦикла;	
	
	Оповестить("ОбновитьБланки");
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если НЕ ЗначениеЗаполнено(ДатаНачала) Тогда
		ДатаНачала = ТекущаяДата() - 86400;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ДатаОкончания) Тогда
		ДатаОкончания = ТекущаяДата() - 86400;
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	
КонецПроцедуры
