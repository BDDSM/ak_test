
Процедура ОсновныеДействияФормыЗаписать(Кнопка)
	
	Для Каждого Строка Из ТаблицаНомеров Цикл
		Если Строка.ИнвентарныйНомер <> Строка.ИнвентарныйНомерСтарый 
				ИЛИ Строка.ЗаводскойНомер <> Строка.ЗаводскойНомерСтарый Тогда
			
			ДокументОбъект = СсылкаНаДокумент.ПолучитьОбъект();
			СтрокаИзменения = ДокументОбъект.Номенклатура.Найти(Строка.НомерСтроки, "НомерСтроки");
			Если СтрокаИзменения = Неопределено Тогда
				Продолжить;	
			КонецЕсли;
			СтрокаИзменения.ЗаводскойНомер = Строка.ЗаводскойНомер; 
			СтрокаИзменения.ИнвентарныйНомер = Строка.ИнвентарныйНомер;
			ДокументОбъект.ОбменДанными.Загрузка = Истина;
			ДокументОбъект.Записать(РежимЗаписиДокумента.Запись);
			
			
			ОСОбъект = Строка.ОсновноеСредство.ПолучитьОбъект();
			ОСОбъект.ИнвентарныйНомер = Строка.ИнвентарныйНомер;
			ОСОбъект.ЗаводскойНомер = Строка.ЗаводскойНомер; 
			ОСОбъект.Записать();
			
		КонецЕсли;
	КонецЦикла;
	
	ТаблицаНомеров.Очистить();
	Если ЗначениеЗаполнено(СсылкаНаДокумент) Тогда
		Для Каждого Строка Из СсылкаНаДокумент.Номенклатура Цикл
			НовСтрока = ТаблицаНомеров.Добавить();
			ЗаполнитьЗначенияСвойств(НовСтрока, Строка);
			НовСтрока.ИнвентарныйНомерСтарый = Строка.ИнвентарныйНомер;
			НовСтрока.ЗаводскойНомерСтарый   = Строка.ЗаводскойНомер; 			
		КонецЦикла;
	КонецЕсли;

	Сообщить("Изменения успешно завершены!");
	
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(СсылкаНаДокумент) Тогда
		Для Каждого Строка Из СсылкаНаДокумент.Номенклатура Цикл
			НовСтрока = ТаблицаНомеров.Добавить();
			ЗаполнитьЗначенияСвойств(НовСтрока, Строка);
			НовСтрока.ИнвентарныйНомерСтарый = Строка.ИнвентарныйНомер;
			НовСтрока.ЗаводскойНомерСтарый   = Строка.ЗаводскойНомер; 			
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры

Процедура ТаблицаНомеровПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	Если ДанныеСтроки.ИнвентарныйНомер <> ДанныеСтроки.ИнвентарныйНомерСтарый 
			ИЛИ ДанныеСтроки.ЗаводскойНомер <> ДанныеСтроки.ЗаводскойНомерСтарый Тогда
		ОформлениеСтроки.Шрифт = Новый Шрифт(,, Истина, Истина);
	КонецЕсли;
	
КонецПроцедуры

Процедура ТаблицаНомеровПередНачаломДобавления(Элемент, Отказ, Копирование)
	
	Отказ = Истина;
	
КонецПроцедуры
