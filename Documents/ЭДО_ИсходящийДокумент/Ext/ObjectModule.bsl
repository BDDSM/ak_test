
Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)

	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	ЭДО_ВходящийДокумент.Ссылка
	                      |ИЗ
	                      |	Документ.ЭДО_ВходящийДокумент КАК ЭДО_ВходящийДокумент
	                      |ГДЕ
	                      |	ЭДО_ВходящийДокумент.Ссылка <> &Ссылка
	                      |	И ЭДО_ВходящийДокумент.ИдентификаторДокумента = &ИдентификаторДокумента");
	
	Запрос.УстановитьПараметр("ИдентификаторДокумента", ИдентификаторДокумента);
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		ОбщегоНазначения.СообщитьОбОшибке("В базе уже существует входящий документ с идентификатором " + ИдентификаторДокумента + "! " + Выборка.Ссылка, Отказ);
	КонецЕсли; 
	
КонецПроцедуры
