
Функция AutorizationFree(Login, Pass) Экспорт //+++АК mika 2018.09.10 ИП-00019791
	
	ОбработкаОбъект = ПолучитьИПодключитьВнешнююОбработку("ВебСервис_StaffOutFree");
	Если ОбработкаОбъект <> Неопределено Тогда
		Возврат ОбработкаОбъект.AutorizationFree(Login, Pass);
	КонецЕсли;
	
КонецФункции

Функция GetTableTT(Login, СтрокаПараметров) Экспорт //+++АК mika 2018.09.10 ИП-00019791
	
	ОбработкаОбъект = ПолучитьИПодключитьВнешнююОбработку("ВебСервис_StaffOutFree");
	Если ОбработкаОбъект <> Неопределено Тогда
		Возврат ОбработкаОбъект.GetTableTT(Login, СтрокаПараметров);
	КонецЕсли;
	
КонецФункции

Функция AddTimeSheet(Период, Login, НомерТочки, Должность) Экспорт //+++АК mika 2018.09.10 ИП-00019791

	ОбработкаОбъект = ПолучитьИПодключитьВнешнююОбработку("ВебСервис_StaffOutFree");
	Если ОбработкаОбъект <> Неопределено Тогда
		Возврат ОбработкаОбъект.AddTimeSheet(Период, Login, НомерТочки, Должность);
	КонецЕсли;
	
КонецФункции

Функция ПолучитьИПодключитьВнешнююОбработку(ИмяОбработки = "ВебСервис_StaffOutFree")//+++АК mika 2018.09.10 ИП-00019791
	
	УстановитьПривилегированныйРежим(Истина);
	
	ВнешниеОбработкиСсылка = Справочники.ВнешниеОбработки.НайтиПоНаименованию(ИмяОбработки);
	Если НЕ ЗначениеЗаполнено(ВнешниеОбработкиСсылка) Тогда Возврат Неопределено; КонецЕсли;
	
	ДвоичныеДанные = ВнешниеОбработкиСсылка.ХранилищеВнешнейОбработки.Получить();
	
	#Если Сервер Тогда
		АдресВоВременномХранилище = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
		ИмяОбработки = ВнешниеОбработки.Подключить(АдресВоВременномХранилище, , Ложь);
	#Иначе
		ИмяОбработки = ПолучитьИмяВременногоФайла("epf");
		ДвоичныеДанные.Записать(ИмяОбработки); 
	#КонецЕсли
	
	Обработка = ВнешниеОбработки.Создать(ИмяОбработки);
	
	УстановитьПривилегированныйРежим(Ложь);
	
	Возврат Обработка;
	
КонецФункции





