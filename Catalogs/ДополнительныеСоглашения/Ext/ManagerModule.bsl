
Функция ПечатьДопСоглашение(Ссылка,ФИОДир,ФИОКлиента) Экспорт 

	
//	
	ТабДокумент = Новый ТабличныйДокумент;
  
	Макет = Справочники.ДополнительныеСоглашения.ПолучитьМакет("ДопСоглашениеУпаковка");
  
	СведенияОПокупателе = УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Ссылка.Договор.Владелец, Ссылка.Дата);
	СведенияОПоставщике = УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Ссылка.Договор.Организация, Ссылка.Дата);
	Руководители 		= ОбщегоНазначения.ОтветственныеЛица(Ссылка.Договор.Организация, Ссылка.Дата,);
    Контрагент=Ссылка.Договор.Владелец;
	Организация=Ссылка.Договор.Организация;
//	
//	//Вывод
//	
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	ОбластьМакета.Параметры.ДатаДок 	= Формат(Ссылка.Дата,"ДЛФ=DD");
	ОбластьМакета.Параметры.Организация = Организация.НаименованиеПолное;
	ОбластьМакета.Параметры.Клиент		= Контрагент.НаименованиеПолное;
	ОбластьМакета.Параметры.ДатаДог = Формат(Ссылка.Договор.Дата,"ДФ=dd.MM.yyyy");
	ОбластьМакета.Параметры.НомерДог		= Ссылка.Договор.Номер;
	//	
//	//Склоняем
	
	//ФИОДир = Руководители.Руководитель;
	
	//ЗагрузитьВнешнююКомпоненту("NameDecl.dll");
	//глКомпонентаСклоненияФИО = Новый("AddIn.NameDeclension");

	//ОбщиеПроцедуры.ПросклонятьФИО(ФИОДир, 2,,ФИОДир);
	ОбластьМакета.Параметры.ФИОДир = ФИОДир;
	
	//ФИОКлиента = Контрагент.ГенеральныйДиректор;
	//ОбщиеПроцедуры.Просклонять(ФИОКлиента, 2, ФИОКлиента);

	ОбластьМакета.Параметры.ФИОКлиента = ФИОКлиента;

	ОтвБух=Контрагент.ОсновнойБухгалтерПокупателя;
	Если ЗначениеЗаполнено(ОтвБух.ФизЛицо) Тогда

		Запрос = Новый Запрос;
		Запрос.Текст = 
			"ВЫБРАТЬ
			|	КонтактнаяИнформация.Представление
			|ИЗ
			|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
			|ГДЕ
			|	КонтактнаяИнформация.Объект = &Объект
			|	И КонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
			|	И КонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.EmailФизЛица)";

		Запрос.УстановитьПараметр("Объект", ОтвБух.ФизЛицо);

		Результат = Запрос.Выполнить();

		ВыборкаДетальныеЗаписи = Результат.Выбрать();
        ЕмейлБух="";
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ЕмейлБух=ВыборкаДетальныеЗаписи.Представление;
		КонецЦикла;
	КонецЕсли; 
	ОбластьМакета.Параметры.ЕмейлБух = ЕмейлБух;
	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	КонтактнаяИнформация.Представление
		|ИЗ
		|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|ГДЕ
		|	КонтактнаяИнформация.Объект = &Объект
		|	И КонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
		|	И КонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.АдресЭлектроннойПочтыКонтрагентаДляОбменаДокументами)";

	Запрос.УстановитьПараметр("Объект", Контрагент);

	Результат = Запрос.Выполнить();

	ВыборкаДетальныеЗаписи = Результат.Выбрать();
    ЕмейлКлиента="";
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ЕмейлКлиента=ВыборкаДетальныеЗаписи.Представление;
	КонецЦикла;
	ОбластьМакета.Параметры.ЕмейлКлиента = ЕмейлКлиента;
	
	ТабДокумент.Вывести(ОбластьМакета);
	ОбластьМакета = Макет.ПолучитьОбласть("Подвал");
	ОбластьМакета.Параметры.Организация = Организация.НаименованиеСокращенное;
	ОбластьМакета.Параметры.Покупатель		= Контрагент.НаименованиеПолное;
	
	ФИОДир = Руководители.Руководитель;
	МасФИО=Справочники.Контрагенты.РазложитьСтрокуВМассивПодстрок(ФИОДир," ");
	Для каждого Эл Из МасФИО Цикл
	   Эл=СокрЛП(Эл);
	КонецЦикла; 
	ФИОДир=""+МасФИО[0]+" "+?(МасФИО.Количество()>1,Лев(МасФИО[1],1)+".","")+?(МасФИО.Количество()>2,Лев(МасФИО[2],1)+".","");
	ОбластьМакета.Параметры.ФИОДир = ФИОДир;
	                                                                        
	ФИОКлиента = Контрагент.ГенеральныйДиректор;
	
	МасФИО=Справочники.Контрагенты.РазложитьСтрокуВМассивПодстрок(ФИОКлиента," ");
	Для каждого Эл Из МасФИО Цикл
	   Эл=СокрЛП(Эл);
	КонецЦикла; 
	ФИОКлиента=""+МасФИО[0]+" "+?(МасФИО.Количество()>1,Лев(МасФИО[1],1)+".","")+?(МасФИО.Количество()>2,Лев(МасФИО[2],1)+".","");
	ОбластьМакета.Параметры.ФИОКлиента = ФИОКлиента;
	ТабДокумент.Вывести(ОбластьМакета);
	
    ТабДокумент.ИмяПараметровПечати="ПечатьДопСоглашенияПоУпаковке";
	ТабДокумент.АвтоМасштаб = Истина;
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;



	Возврат ТабДокумент;
КонецФункции

Функция ПечатьДопСоглашениеЭДО(Ссылка,СтруктураПараметров) Экспорт 

	ТабДокумент = Новый ТабличныйДокумент;
  
	Макет = Справочники.ДополнительныеСоглашения.ПолучитьМакет("СоглашениеЭДО");
  
	СведенияОЭДООрг = УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Ссылка.ПоставщикЭДООрганизации, Ссылка.Дата);
	СведенияОЭДОКон = УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Ссылка.ПоставщикЭДОКонтрагента, Ссылка.Дата);
	Договор = Ссылка.Договор; 
    Контрагент = Договор.Владелец;
	Организация = Договор.Организация;
	Если ЗначениеЗаполнено(СтруктураПараметров.ФИОДир) Тогда
		РасшифровкаОрг = "в лице "+СтруктураПараметров.ФИОДир+", действующей на основании Устава";	
	иначе
		РасшифровкаОрг = "в лице ______________________, действующей на основании доверенности №_______ от __________ г.";
	КонецЕсли;
	
	Если ЗначениеЗаполнено(СтруктураПараметров.ФИОКлиента) Тогда
		РасшифровкаКон = " в лице "+СтруктураПараметров.ФИОКлиента+", действующей на основании Устава";	
	иначе
		РасшифровкаКон = "в лице ______________________, действующей на основании доверенности №_______ от __________ г.";
	КонецЕсли;
	
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	ОбластьМакета.Параметры.Покупатель = Контрагент.НаименованиеПолное;
	ОбластьМакета.Параметры.Организация = Организация.НаименованиеПолное;
	ОбластьМакета.Параметры.Номер = Ссылка.Номер;
	ОбластьМакета.Параметры.Дата = Ссылка.Дата;
	ОбластьМакета.Параметры.НомерОснования = Договор.Номер;
	ОбластьМакета.Параметры.ДатаОснования = Формат(Договор.Дата,"ДФ=dd.MM.yyyy");
	ОбластьМакета.Параметры.РасшифровкаОрг = РасшифровкаОрг;
	ОбластьМакета.Параметры.РасшифровкаКон = РасшифровкаКон;
	ОбластьМакета.Параметры.ПодписьПокупатель = ?(ЗначениеЗаполнено(СтруктураПараметров.ФИОКлиентаПодпись),"/ "+ОбщегоНазначения.ФамилияИнициалыФизЛица(СтруктураПараметров.ФИОКлиентаПодпись)+" /","/                   /");
	ОбластьМакета.Параметры.ПодписьПоставщик = ?(ЗначениеЗаполнено(СтруктураПараметров.ФИОДирПодпись),"/ "+ОбщегоНазначения.ФамилияИнициалыФизЛица(СтруктураПараметров.ФИОДирПодпись)+" /","/                   /");
	
	ОбластьМакета.Параметры.ПоставщикЭДОКонтрагента = ФормированиеПечатныхФормСервер.ОписаниеОрганизации(СведенияОЭДОКон, "НаименованиеДляПечатныхФорм,ИНН,ФактическийАдрес,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	ОбластьМакета.Параметры.ПоставщикЭДООрганизации = ФормированиеПечатныхФормСервер.ОписаниеОрганизации(СведенияОЭДООрг, "НаименованиеДляПечатныхФорм,ИНН,ФактическийАдрес,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	
	ТабДокумент.Вывести(ОбластьМакета);
	
    ТабДокумент.ИмяПараметровПечати="ПечатьДопСоглашенияЭДО";
	ТабДокумент.АвтоМасштаб = Истина;
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;

	Возврат ТабДокумент;
КонецФункции


 