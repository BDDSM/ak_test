
&НаСервере
Функция Печать(ПараметрКоманды,СтруктураПараметров)
	
	Возврат Справочники.ДополнительныеСоглашения.ПечатьДопСоглашениеЭДО(ПараметрКоманды,СтруктураПараметров);
	
КонецФункции

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	СтруктураПараметров = Новый Структура("ФИОДир, ФИОКлиента, ФИОДирПодпись, ФИОКлиентаПодпись","","","","");
	ПолучитьФИО(ПараметрКоманды, СтруктураПараметров);
	КомпонентаСклонения = ПолучитьКомпонентуСклонения();	
	Если не КомпонентаСклонения = Неопределено Тогда
		Если ЗначениеЗаполнено(СтруктураПараметров.ФИОДир) Тогда
			СтруктураПараметров.ФИОДир = КомпонентаСклонения.Просклонять(строка(СтруктураПараметров.ФИОДир),2);
		КонецЕсли;
		
		Если ЗначениеЗаполнено(СтруктураПараметров.ФИОКлиента) Тогда
			СтруктураПараметров.ФИОКлиента = КомпонентаСклонения.Просклонять(СтруктураПараметров.ФИОКлиента,2);	
		КонецЕсли;
	КонецЕсли;
	ТабДок = Печать(ПараметрКоманды,СтруктураПараметров);
	Если ТабДок = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ТабДок.ОтображатьСетку 		= Ложь;
	ТабДок.Защита 				= Ложь;
	ТабДок.ТолькоПросмотр 		= Истина;
	ТабДок.ОтображатьЗаголовки 	= Ложь;
	ТабДок.Показать();
			
КонецПроцедуры

&НаКлиенте
Функция ПолучитьКомпонентуСклонения()
	НайденноеЗначение = Неопределено;
	Попытка
		ПодключениеВыполнено = ПодключитьВнешнююКомпоненту("ОбщийМакет.КомпонентаNameDecl", "Decl", ТипВнешнейКомпоненты.Native);
		Если ПодключениеВыполнено Тогда
			НайденноеЗначение = Новый ("AddIn.Decl.CNameDecl"); 
		КонецЕсли; 
	Исключение
		Сообщить("Не удалось загрузить внешнюю компаненту по причине: "+ОписаниеОшибки());
	КонецПопытки;
	Возврат НайденноеЗначение;	
КонецФункции

&НаСервере
Процедура ПолучитьФИО(Ссылка,СтруктураПараметров)
	Руководители 		= ОбщегоНазначения.ОтветственныеЛица(Ссылка.Договор.Организация, Ссылка.Дата,);
    Контрагент=Ссылка.Договор.Владелец;
	Организация=Ссылка.Договор.Организация;
	
	СтруктураПараметров.ФИОДир = Руководители.Руководитель;
	СтруктураПараметров.ФИОДирПодпись = Руководители.Руководитель;
	СтруктураПараметров.ФИОКлиента = Контрагент.ГенеральныйДиректор;
    СтруктураПараметров.ФИОКлиентаПодпись = Контрагент.ГенеральныйДиректор;
КонецПроцедуры
