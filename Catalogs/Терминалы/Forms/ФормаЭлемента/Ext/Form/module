
Процедура ПриОткрытии()
	
	Если Не ЭтоНовый() Тогда
		СоответствиеОС.Отбор.Терминал.Установить(Ссылка);
		СоответствиеОС.Прочитать();
		Таб = СоответствиеОС.Выгрузить();
		Таб.Сортировать("Период Убыв");
		СоответствиеОС.Загрузить(Таб);
		
		ПривязкаКТТ.Отбор.Терминал.Установить(Ссылка);
		ПривязкаКТТ.Прочитать();
		Таб = ПривязкаКТТ.Выгрузить();
		Таб.Сортировать("Период Убыв");
		ПривязкаКТТ.Загрузить(Таб);
		Если СокрЛП(Мерчант)="" Тогда
			ЭлементыФормы.Мерчант.Доступность=Истина;
		КонецЕсли;	
	Иначе
		ЭлементыФормы.Мерчант.Доступность=Истина;
	КонецЕсли;	
	
КонецПроцедуры

Процедура ПослеЗаписи()
	
	ТабСоответствие = СоответствиеОС.Выгрузить();
	ТабСоответствие.ЗаполнитьЗначения(Ссылка, "Терминал");
	Набор = РегистрыСведений.СоответствиеОсновныхСредствТерминалам.СоздатьНаборЗаписей();
	Набор.Отбор.Терминал.Установить(Ссылка);
	Набор.Загрузить(ТабСоответствие);
	Набор.Записать();
	
	ТабСоответствие = ПривязкаКТТ.Выгрузить();
	ТабСоответствие.ЗаполнитьЗначения(Ссылка, "Терминал");
	Набор = РегистрыСведений.ПривязкаВременныхТерминаловКТорговымТочкам.СоздатьНаборЗаписей();
	Набор.Отбор.Терминал.Установить(Ссылка);
	Набор.Загрузить(ТабСоответствие);
	Набор.Записать();
	
КонецПроцедуры
