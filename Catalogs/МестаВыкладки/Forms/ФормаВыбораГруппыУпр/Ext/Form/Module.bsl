//+++АК KIRN 2018.03.12 ИП-00018103
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	ТорговаяМарка = Справочники.ТорговыеМарки.ПустаяСсылка();
	Если Параметры.Свойство("ТорговаяМарка") Тогда
		ТорговаяМарка = Параметры.ТорговаяМарка;
	Иначе
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		               |	СоответствиеТиповРозничныхТочекИТорговыхМарок.ТорговаяМарка
		               |ИЗ
		               |	РегистрСведений.СоответствиеТиповРозничныхТочекИТорговыхМарок КАК СоответствиеТиповРозничныхТочекИТорговыхМарок
		               |ГДЕ
		               |	СоответствиеТиповРозничныхТочекИТорговыхМарок.ТипРозничнойТочки = &ТипРозничнойТочки";
		Запрос.УстановитьПараметр("ТипРозничнойТочки",ПараметрыСеанса.ТорговаяТочкаПоАйпи.ТипРозничнойТочки);
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда
			ТорговаяМарка = Выборка.ТорговаяМарка;
		КонецЕСли;
	КонецЕСли;
	
	//ЭтоПродавец = ЗначениеЗаполнено(ПараметрыСеанса.ТорговаяТочкаПоАйпи);
	
	ЭтоПродавец = Ложь;
	ПОпытка
		ТекущийПродавец = ЗначениеЗаполнено(ПараметрыСеанса.ТекущийПродавец)
	Исключение
		ТекущийПродавец = ЛОжь;
	КонецПопытки;
	
	РольПолныеПрава = РольДоступна("ПолныеПрава");
	РольПродавец    = РольДоступна("Продавец");

	ЭтоПродавец = РольПродавец И НЕ РольПолныеПрава И ТекущийПродавец;

	Список.Параметры.УстановитьЗначениеПараметра("ЭтоПродавец", ЭтоПродавец);
	Список.Параметры.УстановитьЗначениеПараметра("ТорговаяМарка", ТорговаяМарка);
	
	Если ЭтоПродавец ТОгда
		ЭлементОформления = Список.УсловноеОформление.Элементы.Добавить();     
		ЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
		ЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных("ТорговаяМарка");
		ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;    
		ЭлементОтбора.ПравоеЗначение = ТорговаяМарка;
		ЭлементОтбора.Использование  = Истина; 	
		ЭлементОформления.Оформление.УстановитьЗначениеПараметра("Видимость", Ложь);
	КонецЕСли;

КонецПроцедуры
//---АК KIRN 