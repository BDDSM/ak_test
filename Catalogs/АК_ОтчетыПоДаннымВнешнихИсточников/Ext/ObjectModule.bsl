
//
Процедура ПередЗаписью(Отказ)
	
	//
	Структура = Новый Структура("СводнаяТаблица, ТаблицаВыбранныхПолей"); 
	ЗаполнитьЗначенияСвойств(Структура, ДополнительныеСвойства);
	
	//
	ОписаниеИсточникаДанных = Новый ХранилищеЗначения(Структура);
	
	//
	Если ДополнительныеСвойства.Свойство("НастройкиСКД") Тогда
		
		//
		Для Каждого СтрокаТЧ Из ВариантыНастроек Цикл
			
			//
			ИмяНастройки = "Настройка" + Формат(СтрокаТЧ.ID, "ЧН=0; ЧГ=");
			
			//
			Если ДополнительныеСвойства.НастройкиСКД.Свойство(ИмяНастройки) Тогда
				СтрокаТЧ.Настройка = Новый ХранилищеЗначения(ДополнительныеСвойства.НастройкиСКД[ИмяНастройки]);
			КонецЕсли;	
			
		КонецЦикла;	
		
	КонецЕсли;	
	
КонецПроцедуры

//
Если ЗначениеЗаполнено(Ссылка) Тогда

	//
	Структура = Ссылка.ОписаниеИсточникаДанных.Получить();
	Если ЗначениеЗаполнено(Структура) Тогда

		//
		ДополнительныеСвойства.Вставить("СводнаяТаблица", Структура.СводнаяТаблица);
		ДополнительныеСвойства.Вставить("ТаблицаВыбранныхПолей", Структура.ТаблицаВыбранныхПолей);
		
	КонецЕсли;

	//
	Структура = Новый Структура;
	Для Каждого СтрокаТЧ Из Ссылка.ВариантыНастроек Цикл
		
		//
		Структура.Вставить("Настройка" + Формат(СтрокаТЧ.ID, "ЧН=0; ЧГ="), СтрокаТЧ.Настройка.Получить());
		
	КонецЦикла;	

	//
	ДополнительныеСвойства.Вставить("НастройкиСКД", Структура);
	
КонецЕсли;	
