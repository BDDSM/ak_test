
Функция ПолучитьКодПродавца(Знач КодПродавца)
	
	ОбработатьСтроку = Истина;
	
	Пока ОбработатьСтроку Цикл
		Если Лев(КодПродавца, 1) = "0" Тогда
			КодПродавца = Прав(КодПродавца, СтрДлина(КодПродавца)-1);
		Иначе
			ОбработатьСтроку = Ложь;
		КонецЕсли;	
	КонецЦикла;
	
	Если СтрДлина(КодПродавца) <= 3 Тогда
		КодПродавца = "000" + КодПродавца;
		КодПродавца = "0." + Прав(КодПродавца, 3);
	Иначе
		КодПродавца = "00000" + КодПродавца;
		КодПродавца = Прав(КодПродавца, 5);
		КодПродавца = Лев(КодПродавца, 2) + "." + Прав(КодПродавца, 3);
	КонецЕсли;
	
	Возврат КодПродавца;
	
КонецФункции

Функция ПечатьБейджейНаСервере(МассивСотрудников)
	
	Возврат Справочники.СотрудникиАутсорсинг.ПечатьБейджейНаСервере(МассивСотрудников);
	
КонецФункции

&НаКлиенте
Процедура ПечатьБейджей(Команда)
	
	//+++АК mika 2018.01.22 ИП-00017263.02
	ОткрытьФорму("Обработка.ПечатьБейджейПродавцов.Форма.Форма", Новый Структура("ГруппаСотрудников", ДопМодульСервер.ПолучитьТекущуюГруппуСотрудниковАутсорсинг()), , "ТД_ПечатьБейджей");
	Возврат;
	//---АК mika

	МассивСотрудников = Новый Массив;
	Для Каждого ВыделеннаяСтрока Из Элементы.Список.ВыделенныеСтроки Цикл
		ТекДанные = Элементы.Список.ДанныеСтроки(ВыделеннаяСтрока);
		МассивСотрудников.Добавить(ТекДанные.Ссылка);
	КонецЦикла;	
	
	ТабДок = ПечатьБейджейНаСервере(МассивСотрудников);
	
	ОткрытьФорму("ОбщаяФорма.ФормаОтображенияТабДокумента", Новый Структура("ТабДок, УстановитьЗаголовок", ТабДок, "Бэйджи"));
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТекГруппаСотрудников = ДопМодульСервер.ПолучитьТекущуюГруппуСотрудниковАутсорсинг();
	Если НЕ ТекГруппаСотрудников = Неопределено Тогда
		
		ОтборНаФорме = ЭтаФорма.Список.Отбор;
		ПолеКомпоновкиГруппаСотрудников = Новый ПолеКомпоновкиДанных("ГруппаСотрудников");
			
		Если ОтборНаФорме.Элементы.Количество() = 0 Тогда
			
			ЭлементОтбора = ОтборНаФорме.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
			ЭлементОтбора.ЛевоеЗначение 	= ПолеКомпоновкиГруппаСотрудников;
			ЭлементОтбора.Использование 	= Истина;
			ЭлементОтбора.ВидСравнения 		= ВидСравненияКомпоновкиДанных.Равно;
			ЭлементОтбора.ПравоеЗначение 	= ТекГруппаСотрудников;
			//+++Ak ziga  20171119 Ип-00017049
			Если Не РольДоступна("ПолныеПрава") Тогда
			ЭлементОтбора.РежимОтображения=РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
			КонецЕсли;
			//---Ak ziga  20171119 Ип-00017049

		Иначе
			
			Для Каждого ЭлементОтбора Из ОтборНаФорме.Элементы Цикл
				
				Если ЭлементОтбора.ЛевоеЗначение = ПолеКомпоновкиГруппаСотрудников Тогда
					
					ЭлементОтбора.ПравоеЗначение = ТекГруппаСотрудников;
					
				КонецЕсли;
				
			КонецЦикла;
			
		КонецЕсли;
	КонецЕсли;
	//+++Ak ziga  20171109 Ип-00017049
	//ЭлементОтбора = ЭтаФорма.Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	//ПолеКомпоновкиМенеджер = Новый ПолеКомпоновкиДанных("Должность");
	//ЭлементОтбора.ЛевоеЗначение 	= ПолеКомпоновкиМенеджер;
	//ЭлементОтбора.Использование 	= Истина;
	//ЭлементОтбора.ВидСравнения 		= ВидСравненияКомпоновкиДанных.Равно;
	//ЭлементОтбора.ПравоеЗначение 	= Справочники.ДолжностиВнештатныхСотрудников.НайтиПоНаименованию("Менеджер");
	//Если Не РольДоступна("ПолныеПрава") Тогда
	//ЭлементОтбора.РежимОтображения=РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
	//КонецЕсли;
	//---ak ziga
		
КонецПроцедуры
