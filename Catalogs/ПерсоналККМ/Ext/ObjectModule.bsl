
Процедура ПередЗаписью(Отказ)
	
	Если НЕ ЗначениеЗаполнено(Код) Тогда
		УстановитьНовыйКод("0");
	КонецЕсли;	
	
	Если НЕ ЗначениеЗаполнено(Пароль) Тогда
		Пароль = Справочники.ПерсоналККМ.СгенеритьПарольДляПерсоналаККМ(Код);
	КонецЕсли;	
	
	//+++АК mika 2018.06.28 ИП-00019129 Добавление автоприсвоение роли на кассе «Кассир» Пекарям 
	//Временная доработка! ••Удалить ↓ После доработки SQL перенести установку в ПерсоналККМ.МодульМенеджера стр. 44 
	//Во вьшку пока не добавлялись новые признаки, единственный признак IsOutSource не правильно использовать для пекарей
	Если ЭтоНовый() И ПроверкаДолжностиПекарь() Тогда
		Если НЕ ЗначениеЗаполнено(РольНаКассе) Тогда
			РольНаКассе = 4;
		КонецЕсли;
	КонецЕсли;
	//---АК mika
	
КонецПроцедуры

Функция ПроверкаДолжностиПекарь() 
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ФизическиеЛица.Ссылка
	|ИЗ
	|	Справочник.ФизическиеЛица КАК ФизическиеЛица
	|ГДЕ
	|	ФизическиеЛица.Код = &Код
	|	И ФизическиеЛица.Должность = ""Пекарь""";
	
	Запрос.УстановитьПараметр("Код", Код);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Возврат НЕ РезультатЗапроса.Пустой();
	
КонецФункции
