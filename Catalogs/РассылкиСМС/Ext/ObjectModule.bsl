
Процедура ПередЗаписью(Отказ)
	
	НайденыйЭл = Справочники.РассылкиСМС.НайтиПоНаименованию(Наименование, Истина);
	
	Если НайденыйЭл <> Справочники.РассылкиСМС.ПустаяСсылка() И НайденыйЭл <> Ссылка Тогда
		
		Сообщить("В справочнике уже имеется элемент с наименованием """+Наименование+""". Запись не возможна!");
		Отказ = Истина;
		Возврат;
		
	КонецЕсли;	
	
	Если СокрЛП(ТекстСообщения) = "" Тогда
		
		Сообщить("Не указан текст сообщения. Запись не возможна!");
		Отказ = Истина;
		Возврат;
		
	КонецЕсли;
		
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	SMS.GUID_Записи
		|ИЗ
		|	РегистрСведений.SMS КАК SMS
		|ГДЕ
		|	SMS.Рассылка = &Ссылка";

	Запрос.УстановитьПараметр("Ссылка", Ссылка);

	Результат = Запрос.Выполнить();

	Если НЕ Результат.Пустой() Тогда
		
		Сообщить("Данный элемент справочника уже используется в рассылках. Изменение не возможно!");
		Отказ = Истина;
		Возврат;	
		
    КонецЕсли;
	
	Ответственный = ПараметрыСеанса.ТекущийПользователь;
	
КонецПроцедуры
