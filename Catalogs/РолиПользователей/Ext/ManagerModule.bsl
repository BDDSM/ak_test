Функция ПолучитьРолиПользователя(Пользователь) Экспорт
	
	
	МассивРез = Новый Массив;
	Запрос1 = Новый Запрос;
	Запрос1.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	РолиПользователей.Ссылка
	|ИЗ
	|	Справочник.РолиПользователей КАК РолиПользователей
	|ГДЕ
	|	РолиПользователей.Ссылка В ИЕРАРХИИ
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				РолиПользователейПользователи.Ссылка
	|			ИЗ
	|				Справочник.РолиПользователей.СоставРоли КАК РолиПользователейПользователи
	|			ГДЕ
	|				РолиПользователейПользователи.Сотрудник = &Сотрудник
	|				И РолиПользователейПользователи.Ссылка.ПометкаУдаления = ЛОЖЬ)
	|	И РолиПользователей.ПометкаУдаления = ЛОЖЬ";
	
	Запрос1.УстановитьПараметр("Сотрудник", Пользователь.ФизЛицо);
	// для конфигурации магазина
	//Запрос1.УстановитьПараметр("Сотрудник", Пользователь.Сотрудник);
		
	Рез1 = Запрос1.Выполнить();
	Выб1 = Рез1.Выбрать();
	//МассивОснРолей = Новый Массив;
	Пока Выб1.Следующий() Цикл
		МассивРез.Добавить(Выб1.Ссылка);
	КонецЦикла;
	
	Возврат МассивРез;
	

КонецФункции // ПолучитьРолиПользователя()

//Функция возвращает ссылку на физическое лицо Помощника Управляющего
//(если  у "текущего пользователя" доступна функ. роль "Помощник розница" (код: PomoshnikTerrUpravlyushego))
//+++ AK suvv 2018.06.08 ИП-00018376.01
//или доступна функ. роль "Помощник сторонней розницы" (код: PomoshnikStorRozn)
//--- AK suvv
//
Функция ПолучитьТекущегоПомощникаУправляющего() Экспорт //+++АК mika 2018.01.30 ИП-00016863.02
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	РолиПользователейСоставРоли.Сотрудник КАК ФизическоеЛицо,
	|	РолиПользователейСоставРоли.Ссылка КАК Роль,
	|	РолиПользователейТипыРолей.ТипРоли КАК ТипРоли,
	|	РолиПользователейТипыРолей.ТипРоли.Код
	|ИЗ
	|	Справочник.Пользователи КАК Пользователи
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.РолиПользователей.СоставРоли КАК РолиПользователейСоставРоли
	|			ЛЕВОЕ СОЕДИНЕНИЕ Справочник.РолиПользователей.ТипыРолей КАК РолиПользователейТипыРолей
	|			ПО РолиПользователейСоставРоли.Ссылка = РолиПользователейТипыРолей.Ссылка
	//+++ AK suvv 2018.06.08 ИП-00018376.01
	//|				И (РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikTerrUpravlyushego"")
	|				И (РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikTerrUpravlyushego""
	|               ИЛИ РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikStorRozn"")
	//--- AK suvv
	|		ПО Пользователи.ФизЛицо = РолиПользователейСоставРоли.Сотрудник
	|ГДЕ
	|	Пользователи.Ссылка = &ТекущийПользователь
	//+++ AK suvv 2018.06.08 ИП-00018376.01
	//|	И РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikTerrUpravlyushego""";
	|	И (РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikTerrUpravlyushego""
	|     ИЛИ РолиПользователейТипыРолей.ТипРоли.Код = ""PomoshnikStorRozn"")";
	//--- AK suvv
	
	Запрос.УстановитьПараметр("ТекущийПользователь", ПараметрыСеанса.ТекущийПользователь);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если Не РезультатЗапроса.Пустой() Тогда
		
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		
		Возврат Выборка.ФизическоеЛицо;
		
	Иначе
		
		Возврат Справочники.ФизическиеЛица.ПустаяСсылка();
		
	КонецЕсли;

КонецФункции


	
