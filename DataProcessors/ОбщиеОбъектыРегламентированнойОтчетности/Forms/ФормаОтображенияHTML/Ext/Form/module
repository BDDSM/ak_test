Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	ЭлементыФормы.HTMLПолеПротокола.УстановитьТекст(HTMLТекст);
	
	Если ПечатьВозможна <> Истина Тогда
		ЭлементыФормы.ПанельОсновныхДействийФормы.Свертка = РежимСверткиЭлементаУправления.Низ;
	КонецЕсли;
	
КонецПроцедуры


Процедура ОсновныеДействияФормыПечать(Кнопка)
	
	ЭлементыФормы.HTMLПолеПротокола.Документ.execCommand("Print");
	
КонецПроцедуры

Процедура HTMLПолеПротоколаonclick(Элемент, pEvtObj)
	
	Ссылка = Неопределено;
	Попытка
		Ссылка = pEvtObj.srcElement.href;
	Исключение
		Попытка
			Ссылка = pEvtObj.srcElement.parentElement.href;
		Исключение
			Попытка
				Ссылка = СокрЛП(нрег(pEvtObj.srcElement.innerText));
				Если Лев(Ссылка, 7) <> "http://" И Лев(Ссылка, 8) <> "https://" Тогда
					Ссылка = Неопределено;
				КонецЕсли;
			Исключение
			КонецПопытки;
		КонецПопытки;
	КонецПопытки;
	
	Если ЗначениеЗаполнено(Ссылка) Тогда
		ЗапуститьПриложение(Ссылка);
	КонецЕсли;
	
	Попытка
		pEvtObj.returnValue = Ложь;
	Исключение
	КонецПопытки;
	
КонецПроцедуры

