
Процедура ПриОткрытии()
	
	//
	НастройкиФорума = ОбработкаФорум.ПолучитьНастройки();
	Если НастройкиФорума = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ЭтаФорма.АдресSMTPСервера	= НастройкиФорума.АдресSMTPСервера;
	ЭтаФорма.ПортSMTP			= НастройкиФорума.ПортSMTP;
	ЭтаФорма.ПользовательSMTP	= НастройкиФорума.ПользовательSMTP;
	ЭтаФорма.ПарольSMTP			= НастройкиФорума.ПарольSMTP;
	ЭтаФорма.АутентификацияSMTP	= НастройкиФорума.АутентификацияSMTP;
	
КонецПроцедуры


Процедура ПутьКаталогаФорумаНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
	ДиалогОткрытияФайла.ПолноеИмяФайла		= "";
	ДиалогОткрытияФайла.Фильтр				= "Любые файлы(*.*)|*.*";
	ДиалогОткрытияФайла.МножественныйВыбор	= Ложь;
	ДиалогОткрытияФайла.Заголовок			= "Выберите файл";
	Если ДиалогОткрытияФайла.Выбрать() Тогда
		ПутьФорума = ДиалогОткрытияФайла.Каталог;
	КонецЕсли;
	Если СокрЛП(ПутьФорума) = "" Тогда 
		Сообщить("Не выбран каталог форума !", СтатусСообщения.Важное);
		Возврат;
	КонецЕсли;
	ПутьКаталогаФорума = ПутьФорума;
	ЭтаФорма.Модифицированность = Истина;
	
КонецПроцедуры


Процедура ОсновныеДействияФормыОк(Кнопка)
	
	Если ЭтаФорма.Модифицированность Тогда
		ОбработкаФорум.СохранитьНастройки(ЭтаФорма.АдресSMTPСервера, ЭтаФорма.ПортSMTP, ЭтаФорма.ПользовательSMTP, ЭтаФорма.ПарольSMTP, ЭтаФорма.АутентификацияSMTP);
	КонецЕсли;
	
	//
	ЭтаФорма.Закрыть();
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОтмена(Кнопка)
	
	ЭтаФорма.Закрыть();
	
КонецПроцедуры
