
Процедура ПриОткрытии()
	
	СотрудникОбъект = ПараметрыСеанса.ТекущийПользователь.ПолучитьОбъект();
	ЭлементыФормы.Надпись1.Заголовок = СотрудникОбъект.Наименование;
	ЭлементыФормы.Надпись2.Заголовок = "Количество сообщений: " + СотрудникОбъект.КоличествоСообщений;
	ЭлементыФормы.ПолеHTMLДокумента1.УстановитьТекст(СотрудникОбъект.Подпись);
	
	Аватар = Новый Картинка(КаталогВременныхФайлов() + "files\" + СотрудникОбъект.ИмяФайлаКартинки);
	ЭлементыФормы.ПолеКартинки1.Картинка = Аватар;
	
КонецПроцедуры


Процедура ИзменитьНажатие(Элемент)
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогОткрытияФайла.ПолноеИмяФайла 		= "";
	ДиалогОткрытияФайла.Фильтр				= "Любые файлы(*.*)|*.*";
	ДиалогОткрытияФайла.МножественныйВыбор	= Ложь;
	ДиалогОткрытияФайла.Заголовок			= "Выберите файл картинки(Аватар)";
	Если ДиалогОткрытияФайла.Выбрать() Тогда
		МасФайлов = ДиалогОткрытияФайла.ВыбранныеФайлы;
		Для каждого ТекФайл Из МасФайлов Цикл
			ПутьКФайлу = ТекФайл;
		конецЦикла;
	конецЕсли;
	Если СокрЛП(ПутьКФайлу) = "" тогда 
		Сообщить("Не выбран файл !", СтатусСообщения.Важное);
		Возврат;
	КонецЕсли;
	Попытка
		Аватар = Новый Картинка(ПутьКФайлу);
	Исключение
	    Сообщить("Выбран неудачный файл картинки!", СтатусСообщения.Важное);
		Возврат;
	КонецПопытки;
	ЭлементыФормы.ПолеКартинки1.Картинка = Аватар;
	
	Файл = Новый Файл(ПутьКФайлу);
	КопироватьФайл(ПутьКФайлу, КаталогВременныхФайлов() + "files\" + Файл.Имя);
	
	СотрудникОбъект.ИмяФайлаКартинки = Файл.Имя;
	СотрудникОбъект.Записать();
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОк(Кнопка)
	
	СотрудникОбъект.Подпись = ЭлементыФормы.ПолеHTMLДокумента1.ПолучитьТекст();	
	СотрудникОбъект.Записать();
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОтмена(Кнопка)
	
	ЭтаФорма.Закрыть();
	
КонецПроцедуры
