
// Процедура - При открытии
//
Процедура ПриОткрытии()
	//fillinUtils = Новый COMОбъект("Eurekabpo.Utils");
	Для Каждого Строка Из СписокПохожейНоменклатуры Цикл
		Строка1 = Строка.Номенклатура.Наименование; 
		Строка2 = ИсходнаяСтрока;
		//ПроцентПохожести = fillinUtils.StrCompare(Строка1,Строка2);
		ПроцентПохожести = ОбработкаОбъект.КоэффициентКорреляцииСтрок_Массивы_Квадр(Строка1,Строка2);
		Строка.ПроцентПохожести = ПроцентПохожести;
	КонецЦикла;
	Для Каждого Строка Из СписокПохожейНоменклатуры Цикл
		Если Строка.ПроцентПохожести = 0 Тогда 
			СписокПохожейНоменклатуры.Удалить(Строка);
		КонецЕсли;
	КонецЦикла;
	СписокПохожейНоменклатуры.Сортировать("ПроцентПохожести Убыв");
КонецПроцедуры

// Закрывает форму и возвращает выбранное значение
//
Процедура ОсновныеДействияФормыВыбрать(Кнопка)
	ТекущаяСтрока = ЭлементыФормы.СписокПохожейНоменклатуры.ТекущаяСтрока;
	ЗначениеВыбрано = Истина;
	ЭтаФорма.Закрыть(ТекущаяСтрока.Номенклатура);
КонецПроцедуры

// Процедура - Перед закрытием, возвращает неопределено, если ничего не выбрано
//
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	Если не ЗначениеВыбрано Тогда 
		ЭтаФорма.Закрыть(Неопределено);
	КонецЕсли;
КонецПроцедуры

// Открывает значение из ТЧ
//
Процедура СписокПохожейНоменклатурыВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	ОткрытьЗначение(ВыбраннаяСтрока.Номенклатура);
КонецПроцедуры


