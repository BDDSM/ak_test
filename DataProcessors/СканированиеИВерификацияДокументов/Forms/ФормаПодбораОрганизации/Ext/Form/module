
// Процедура - При открытии, заполняет таблицу подходящими организациями и выводит для них процент похожести на переданное значение
//
Процедура ПриОткрытии()
//	fillinUtils = Новый COMОбъект("Eurekabpo.Utils");	
	Для Каждого Строка Из СписокПохожихОрганизаций Цикл
		//Адин.ДобавитьВПодбор(Строка.Номенклатура.Наименование, Строка.НомерСтроки, Строка.Номенклатура.Наименование);
		Строка1 = Строка.Название.Наименование; 
		Строка2 = ИсходнаяСтрока; 
		//ПроцентПохожести = fillinUtils.StrCompare(Строка1,Строка2);
		ПроцентПохожести = ОбработкаОбъект.КоэффициентКорреляцииСтрок_Массивы_Квадр(Строка1,Строка2);				
		Строка.ПроцентПохожести = ПроцентПохожести;
	КонецЦикла;
	Для Каждого Строка Из СписокПохожихОрганизаций Цикл
		Если Строка.ПроцентПохожести = 0 Тогда 
			СписокПохожихОрганизаций.Удалить(Строка);
		КонецЕсли;
	КонецЦикла;
	СписокПохожихОрганизаций.Сортировать("ПроцентПохожести Убыв");
КонецПроцедуры

// Закрывает форму и возвращает выбранное значение
//
Процедура ОсновныеДействияФормыВыбрать(Кнопка)
	ТекущаяСтрока = ЭлементыФормы.СписокПохожихОрганизаций.ТекущаяСтрока;
	ЗначениеВыбрано = Истина;
	ЭтаФорма.Закрыть(ТекущаяСтрока.Название);
КонецПроцедуры

// Процедура - Перед закрытием, возвращает неопределено, если ничего не выбрано
//
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	Если не ЗначениеВыбрано Тогда 
		ЭтаФорма.Закрыть(Неопределено);
	КонецЕсли;
КонецПроцедуры

// Открывает значение из ТЧ
//
Процедура СписокПохожихОрганизацийВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	ОткрытьЗначение(ВыбраннаяСтрока.Название);
КонецПроцедуры

