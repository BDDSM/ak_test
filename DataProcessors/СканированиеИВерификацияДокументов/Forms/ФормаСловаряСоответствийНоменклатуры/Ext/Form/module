
// Кнопка открытия словаря соответствий, открывает список выбора файла и получает оттуда данные
//
Процедура ДействияФормыОткрытьФайлСловаряСоответствий(Кнопка)
	ВыборФайла = Новый ДиалогВыбораФайла (РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.Фильтр = "XML (*.xml)|*.xml";
	ВыборФайла.ПроверятьСуществованиеФайла=Истина;
	ВыборФайла.МножественныйВыбор = Ложь;
	Выбор = ВыборФайла.Выбрать();
	Если Не Выбор Тогда
		Возврат;	                
	КонецЕсли;
	ИмяФайла = ВыборФайла.ВыбранныеФайлы[0];
	ОбработкаОбъект.ОткрытьФайлСловаряСоответствий(ИмяФайла);
КонецПроцедуры

// Кнопка записи словаря соответствий, открывает список выбора файла и сохраняет туда данные
//
Процедура ДействияФормыСохранитьФайлСловаряСоответствий(Кнопка)
	ВыборФайла = Новый ДиалогВыбораФайла (РежимДиалогаВыбораФайла.Сохранение);
	ВыборФайла.ПолноеИмяФайла = "Dictionary.xml";
	ВыборФайла.Фильтр = "XML (*.xml)|*.xml";
	Выбор = ВыборФайла.Выбрать();
	Если Не Выбор Тогда
		Возврат;	                
	КонецЕсли;
	Файл = Новый Файл(ВыборФайла.ВыбранныеФайлы[0]);
	Если Файл.Существует() Тогда
		Ответ = Вопрос("Файл " + ВыборФайла.ВыбранныеФайлы[0] + " существует. Заменить?",РежимДиалогаВопрос.ДаНет);
		Если Ответ = КодВозвратаДиалога.Нет Тогда
			Сообщить("Сохранение отменено.");
			Возврат;
		КонецЕсли;
	КонецЕсли;	
	ОбработкаОбъект.СохранитьФайлСловаряСоответствий(ВыборФайла.ВыбранныеФайлы[0]);
КонецПроцедуры


Процедура ПриОткрытии()
	// Вставить содержимое обработчика.
КонецПроцедуры

