
Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	МассивЭлементов = Новый Массив;
	МассивРодителейПользователей = Новый Массив;
	
	Для каждого ВыделеннаяСтрока Из ЭлементыФормы.ГруппыПользователей.ВыделенныеСтроки Цикл
		МассивЭлементов.Добавить(ВыделеннаяСтрока.Ссылка);
	КонецЦикла;
	
	Закрыть(МассивЭлементов);
	
КонецПроцедуры

Процедура ГруппыПользователейВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если ТипЗнч(ВыбраннаяСтрока) = Тип("СправочникСсылка.ГруппыПользователей") Тогда
		
		МассивЗначений = Новый Массив;
		
		МассивЗначений.Добавить(ВыбраннаяСтрока);
		
		Закрыть(МассивЗначений);
	
	КонецЕсли; 
	
КонецПроцедуры

Процедура УстановитьОтборСтрокПоОбъектуДоступа()

	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	               |	НазначениеВидовОбъектовДоступа.ГруппаПользователей КАК ГруппаПользователей
	               |ИЗ
	               |	РегистрСведений.НазначениеВидовОбъектовДоступа КАК НазначениеВидовОбъектовДоступа
	               |ГДЕ
	               |	НазначениеВидовОбъектовДоступа.ВидОбъектаДоступа = &ВидОбъектаДоступа";
	 
	Запрос.Текст = ТекстЗапроса;
	Запрос.УстановитьПараметр("ВидОбъектаДоступа", ВидОбъектаДоступа);
	
	СписокСсылок = Новый СписокЗначений;
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		СписокСсылок.Добавить(Выборка.ГруппаПользователей);
	КонецЦикла;
	
	ГруппыПользователей.Отбор.Ссылка.ВидСравнения = ВидСравнения.ВСписке;	
	ГруппыПользователей.Отбор.Ссылка.Значение = СписокСсылок;
	ГруппыПользователей.Отбор.Ссылка.Использование = Истина;	
	
КонецПроцедуры // УстановитьОтборСтрокПоОбъектуДоступа
 
Процедура ПриОткрытии()
	
	УстановитьОтборСтрокПоОбъектуДоступа();
	
КонецПроцедуры
