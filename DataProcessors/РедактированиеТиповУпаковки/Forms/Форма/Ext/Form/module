
Процедура КнопкаВыполнитьНажатие(Кнопка)
	Если ЗначениеЗаполнено(Характеристика) Тогда 
		УстановитьПривилегированныйРежим(Истина);	
		обХаркатеристика = Характеристика.ПолучитьОбъект();	
		обХаркатеристика.ТипыУпаковки.Очистить();
		Для каждого Стр Из  ТипыУпаковки Цикл
			НовСтр = обХаркатеристика.ТипыУпаковки.Добавить();
			ЗаполнитьЗначенияСвойств(НовСтр,стр);
		КонецЦикла; 
		Попытка
			обХаркатеристика.Записать();
			ЭтаФорма.Модифицированность = Ложь;
		Исключение
			Сообщить("Не удалось записать характеристику.");		
		КонецПопытки;
		УстановитьПривилегированныйРежим(Ложь);	
	КонецЕсли;	
КонецПроцедуры

Процедура ПриОткрытии()
	Если РольДоступна("ПолныеПрава")= Ложь и Не УправлениеДопПравамиПользователей.ПрочитатьЗначениеПраваПользователя(ПланыВидовХарактеристик.ПраваПользователей.МожетРедактироватьТипыУпаковки,Ложь,ПараметрыСеанса.ТекущийПользователь)[0] Тогда 
		Сообщить("У вас не достаточно прав для работы с обработкой");
		ЭтаФорма.Закрыть();
	КонецЕсли;
КонецПроцедуры

Процедура ХарактеристикаПриИзменении(Элемент)
	
	ЭтаФорма.Модифицированность = Истина;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ХарактеристикиНоменклатурыТипыУпаковки.Материал,
		|	ХарактеристикиНоменклатурыТипыУпаковки.ТипУпаковки
		|ИЗ
		|	Справочник.ХарактеристикиНоменклатуры.ТипыУпаковки КАК ХарактеристикиНоменклатурыТипыУпаковки
		|ГДЕ
		|	ХарактеристикиНоменклатурыТипыУпаковки.Ссылка = &Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка", Характеристика);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	ТипыУпаковки.Очистить();
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		НовСтр = ТипыУпаковки.Добавить();
		ЗаполнитьЗначенияСвойств(НовСтр,ВыборкаДетальныеЗаписи);
	КонецЦикла;
	
	
КонецПроцедуры

Процедура НоменклатураПриИзменении(Элемент)
	Характеристика = Неопределено;
	ТипыУпаковки.Очистить();
КонецПроцедуры

Процедура НоменклатураНачалоВыбора(Элемент, СтандартнаяОбработка)

	
КонецПроцедуры

Процедура ТипыУпаковкиМатериалНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка  = Ложь;
	
	нФормаВыбора = Справочники.Материал.ПолучитьФормуВыбора(, Элемент.Значение);
	нФормаВыбора.Отбор.ПометкаУдаления.ВидСравнения = ВидСравнения.Равно;
	нФормаВыбора.Отбор.ПометкаУдаления.Значение = Ложь;
	нФормаВыбора.Отбор.ПометкаУдаления.Использование = Истина;
	нФормаВыбора.ОткрытьМодально();
	Элемент.Значение = нФормаВыбора.ТекущийЭлемент.ТекущаяСтрока;
КонецПроцедуры
