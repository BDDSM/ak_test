
Процедура КнопкаВыполнитьНажатие(Кнопка)
	// Вставить содержимое обработчика.
КонецПроцедуры

Процедура КоманднаяПанель2Заполнить(Кнопка)
	
	Запрос = Новый Запрос;
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СпрНоменклатура.Ссылка КАК Номенклатура,
	|	СпрНоменклатура.Наименование КАК НаименованиеНом,
	|	ПорядокОбеспечения.ТорговаяТочка КАК ТорговаяТочка,
	|	ПорядокОбеспечения.ТорговаяТочка.Наименование КАК НаименованиеТТ,
	|	ПорядокОбеспечения.ГруппаНоменклатуры КАК ГруппаНоменклатуры,
	|	ПорядокОбеспечения.Расчетчик КАК Склад
	|ПОМЕСТИТЬ ВТНоменклатура
	|ИЗ
	|	Справочник.Номенклатура КАК СпрНоменклатура
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОбеспеченияТорговыхТочек.СрезПоследних КАК ПорядокОбеспечения
	|		ПО СпрНоменклатура.ГруппаНоменклатурыУРЗ = ПорядокОбеспечения.ГруппаУРЗ
	|ГДЕ
	|	НЕ СпрНоменклатура.Выведена
	|	И НЕ СпрНоменклатура.ПометкаУдаления
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТНоменклатура.Номенклатура,
	|	ВТНоменклатура.ТорговаяТочка,
	|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ВТНоменклатура.Склад) КАК Кол
	|ПОМЕСТИТЬ ВТПересечения2
	|ИЗ
	|	ВТНоменклатура КАК ВТНоменклатура
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТНоменклатура.Номенклатура,
	|	ВТНоменклатура.ТорговаяТочка
	|
	|ИМЕЮЩИЕ
	|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ВТНоменклатура.Склад) > 1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТНоменклатура.ТорговаяТочка,
	|	ВТНоменклатура.НаименованиеТТ,
	|	ВТНоменклатура.ГруппаНоменклатуры КАК ГруппаНоменклатуры,
	|	ВТНоменклатура.Склад КАК Склад
	|ИЗ
	|	ВТНоменклатура КАК ВТНоменклатура
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПересечения2 КАК ВТПересечения
	|		ПО (ВТПересечения.Номенклатура = ВТНоменклатура.Номенклатура)
	|			И (ВТПересечения.ТорговаяТочка = ВТНоменклатура.ТорговаяТочка)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТНоменклатура.ТорговаяТочка,
	|	ВТНоменклатура.НаименованиеТТ,
	|	ВТНоменклатура.ГруппаНоменклатуры,
	|	ВТНоменклатура.Склад
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВТНоменклатура.НаименованиеТТ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТНоменклатура
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТПересечения2";
	
	ЭтаФорма.ПорядокОбеспечения = Запрос.Выполнить().Выгрузить();
	
КонецПроцедуры
