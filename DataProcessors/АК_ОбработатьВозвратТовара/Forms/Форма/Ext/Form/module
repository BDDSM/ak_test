
Процедура КнопкаВыполнитьНажатие(Кнопка)
	Штрихкод = ОбщегоНазначенияКлиентСервер.ПолучитьШтрихкодПоУИНу(ПриходныйОрдер);
	Сообщить("" + Штрихкод);
КонецПроцедуры

Процедура ОбъектГУИДПриИзменении(Элемент)
	Если Не ЗначениеЗаполнено(ОбъектГУИД) Тогда
		Возврат;
	КонецЕсли;
	
	ГУИД = ОбъектГУИД.УникальныйИдентификатор();
	
	Сообщить("" + ГУИД);
КонецПроцедуры

Процедура ОсновныеДействияФормыВозвратПоПриходномуОрдеру(Кнопка)
	СделатьВозвратТоваровНаСервере(Истина);
КонецПроцедуры

Процедура ОсновныеДействияФормыВозвратТоваров(Кнопка)
	СделатьВозвратТоваровНаСервере(Ложь);
КонецПроцедуры

Процедура СделатьВозвратТоваровНаСервере(ВозвратПоОрдеру)
//тестовые данные	
	ГУИДПриходныйОрдер = "70e7b95a-cdf7-11e7-ad66-005056a06b0b";
	
	ТаблицаТовары = Новый ТаблицаЗначений;
	
	ОписательСтроки = Новый ОписаниеТипов("Строка", ,Новый КвалификаторыСтроки(36, ДопустимаяДлина.Переменная));
	
	ТаблицаТовары.Колонки.Добавить("Характеристика", ОписательСтроки);
	ТаблицаТовары.Колонки.Добавить("Номенклатура", ОписательСтроки);
	ТаблицаТовары.Колонки.Добавить("ЕдиницаИзмерения", ОписательСтроки);
	ТаблицаТовары.Колонки.Добавить("Количество", Новый ОписаниеТипов("Число"));
	ТаблицаТовары.Колонки.Добавить("КоличествоКоробок", Новый ОписаниеТипов("Число"));
	ТаблицаТовары.Колонки.Добавить("ДатаПроизводства", Новый ОписаниеТипов("Дата", , ,Новый КвалификаторыДаты(ЧастиДаты.Дата)));
	
	Строка = ТаблицаТовары.Добавить();
	Строка.Номенклатура = "53d4d6a3-e843-11e0-b470-001517297ae2";
	Строка.Характеристика = "426e597c-7f80-11e4-af01-005056a00106";
	Строка.ЕдиницаИзмерения = "53d4d6a4-e843-11e0-b470-001517297ae2";
	Строка.Количество = 123;
	Строка.КоличествоКоробок = 11;
	Строка.ДатаПроизводства = ТекущаяДата();
	
	Строка = ТаблицаТовары.Добавить();
	Строка.Номенклатура = "53d4d6a3-e843-11e0-b470-001517297ae2";
	Строка.Характеристика = "426e597c-7f80-11e4-af01-005056a00106";
	Строка.ЕдиницаИзмерения = "53d4d6a4-e843-11e0-b470-001517297ae2";
	Строка.Количество = 456;
	Строка.КоличествоКоробок = 22;
	Строка.ДатаПроизводства = ТекущаяДата();
	
	Кладовщик = "";
//	
	СтруктураДанных = Новый Структура;
	
	СтруктураДанных.Вставить("Возврат");
	СтруктураДанных.Вставить("СделатьВозврат");
	СтруктураДанных.Вставить("ГУИД", ГУИДПриходныйОрдер);
	СтруктураДанных.Вставить("ВозвратПоОрдеру", ВозвратПоОрдеру);
	СтруктураДанных.Вставить("Кладовщик", Кладовщик);
	СтруктураДанных.Вставить("Товары", ТаблицаТовары);
	
	Данные = Новый ХранилищеЗначения(СтруктураДанных, Новый СжатиеДанных(9));
	
	Попытка 	
		СтруктураОтвета = ЭтотОбъект.ПолучитьДанныеДляПриходника(Данные).Получить();
		
		Ошибка = ОшибкаПолученияДанных(СтруктураОтвета);
		
		Если ЗначениеЗаполнено(Ошибка) Тогда
			Сообщить(Ошибка);
		Иначе 
			Сообщить("Документы созданны");
		КонецЕсли;
	Исключение
		Ошибка = ОписаниеОшибки();
		
		Сообщить(Ошибка);
	КонецПопытки;
КонецПроцедуры

Функция ОшибкаПолученияДанных(СтруктураОтвета)	
	Если СтруктураОтвета.Свойство("ОписаниеОшибок") и ЗначениеЗаполнено(СокрЛП(СтруктураОтвета.ОписаниеОшибок)) Тогда		
		Возврат СтруктураОтвета.ОписаниеОшибок; 
	КонецЕсли;	
	
	Возврат Неопределено;
КонецФункции

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	Отказ = Истина;
	
	Предупреждение("Форма не предназначена для открытия!", 30);
КонецПроцедуры


