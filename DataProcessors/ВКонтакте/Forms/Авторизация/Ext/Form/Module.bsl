
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Объект.ПраваДоступа = "friends,photos,wall,ads,offline";
	
КонецПроцедуры

&НаКлиенте
// Возвращает для управляемых форм полный путь к форме отчёта, внешней обработки или любого объекта метаданных в виде:
// "Отчет.<ИмяОтчёта>.Форма.ИмяФормы"
// "ВнешняяОбработка.<ИмяВнешнейОбработки>.Форма.ИмяФормы"
// "Документ.<ИмяОбъекта>.Форма.ИмяФормы"
//
// Может быть полезна при встраивании внешней обработки/отчёта в конфигурацию или переименовании объекта, т.к. не требуется изменять вызовы форм. 
//
Функция ПолучитьПолноеИмяФормы(ИмяВызвавшейФормы, ИмяФормы = "") Экспорт
	
    ПозицияТочки = СтрДлина(ИмяВызвавшейФормы);
    Пока Сред(ИмяВызвавшейФормы, ПозицияТочки, 1) <> "." Цикл ПозицияТочки = ПозицияТочки - 1; КонецЦикла;
    Возврат Лев(ИмяВызвавшейФормы, ПозицияТочки - 1) + ?(ПустаяСтрока(ИмяФормы), "", "." + ИмяФормы);
	
КонецФункции

&НаКлиенте
Процедура ПолучитьКлючДоступа(Команда)
	
	Если ПроверитьЗаполнение() Тогда
		
		ФормаАвторизации = ПолучитьФорму(ПолучитьПолноеИмяФормы(ЭтаФорма.ИмяФормы, "ФормаАвторизации"));
		ФормаАвторизации.Объект.IDПриложения = Объект.IDПриложения;
		ФормаАвторизации.Объект.ПраваДоступа = Объект.ПраваДоступа;
		Результат = ФормаАвторизации.ОткрытьМодально();
		Если Результат <> Неопределено Тогда
			Объект.access_token = Результат;
			ЗапомнитьКлючДоступа();
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ЗапомнитьКлючДоступа()
	
	РаботаССайтомВКонтакте.access_tokenУстановить(Объект.access_token);
	
КонецПроцедуры

&НаКлиенте
Процедура ЧтениеЗаписейСоСтены(Команда)
	ОткрытьФорму(ПолучитьПолноеИмяФормы(ЭтаФорма.ИмяФормы, "ЧтениеЗаписейСоСтены"));
КонецПроцедуры


&НаКлиенте
Процедура РазмещениеЗаписиНаСтене(Команда)
	ОткрытьФорму(ПолучитьПолноеИмяФормы(ЭтаФорма.ИмяФормы, "РазмещениеЗаписиНаСтене"));
КонецПроцедуры


&НаКлиенте
Процедура ПолучитьКомментарииКЗаписиНаСтене(Команда)
	ОткрытьФорму(ПолучитьПолноеИмяФормы(ЭтаФорма.ИмяФормы, "ПолучитьКомментарииКЗаписиНаСтене"));
КонецПроцедуры


&НаКлиенте
Процедура ДобавитьКомментарийКЗаписиНаСтене(Команда)
	ОткрытьФорму(ПолучитьПолноеИмяФормы(ЭтаФорма.ИмяФормы, "ДобавитьКомментарийКЗаписиНаСтене"));
КонецПроцедуры

