
&НаКлиенте
Процедура ОбновитьИтог()
	
	Элементы.ТабТоварыПредполагаемаяДоля.ТекстПодвала = ТабТовары.Итог("ПредполагаемаяДоля");
	
КонецПроцедуры	

&НаКлиенте
Процедура Сохранить(Команда)
	
	Если ТабТовары.Итог("ПредполагаемаяДоля") <> 100 Тогда
		Сообщить("Сумма долей всех строк должна быть равна 100");
		Возврат;
	КонецЕсли;	

	//
	МассивДанные = Новый Массив;
	Для Каждого СтрокаГруппы Из ТабТовары Цикл
		МассивДанные.Добавить(Новый Структура("Идентификатор, Доля", СтрокаГруппы.Идентификатор, СтрокаГруппы.ПредполагаемаяДоля));
	КонецЦикла;
	Закрыть(МассивДанные);
	
КонецПроцедуры


&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Для Каждого ЭлементМассива Из Параметры.СтруктураДанные Цикл
		СтрокаДоб = ТабТовары.Добавить();
		СтрокаДоб.Идентификатор 		= ЭлементМассива.Идентификатор;
		СтрокаДоб.Номенклатура 			= ЭлементМассива.Номенклатура;
		СтрокаДоб.Характеристика 		= ЭлементМассива.Характеристика;
		СтрокаДоб.ПредполагаемаяДоля 	= ЭлементМассива.Доля;
	КонецЦикла;	
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ОбновитьИтог();
	
КонецПроцедуры


&НаКлиенте
Процедура ТабТоварыПредполагаемаяДоляПриИзменении(Элемент)
	
	ОбновитьИтог();
	
КонецПроцедуры
