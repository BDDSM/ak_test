Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.УстановитьПериод(ДатаНачала, КонецДня(ДатаКонца));
	НастройкаПериода.Редактировать();
	
	ДатаНачала = НастройкаПериода.ПолучитьДатуНачала();
	ДатаКонца = НастройкаПериода.ПолучитьДатуОкончания();
КонецПроцедуры // ВыбПериодНажатие

Процедура КнопкаВыполнитьНажатие(Кнопка)
	Если флагВыбора Тогда
		Если ДатаНачала = Дата("00010101000000") Тогда
			Предупреждение("Укажите дату начала!");
			Возврат;
		КонецЕсли;
		Если ДатаКонца = Дата("00010101000000") Тогда
			Предупреждение("Укажите дату окончания!");
			Возврат;
		КонецЕсли;
		Если ДатаНачала > ДатаКонца Тогда
			Предупреждение("Неверно указан период!");
			Возврат;
		КонецЕсли;
		
		Запись = РегистрыСведений.СтатусыОплатыПоДоговорамАренды.СоздатьМенеджерЗаписи();
		Запись.Договор = Договор;
		Запись.Период = ДатаНачала;
		Запись.Статус = Перечисления.СтатусыОплатыДоговоровКонтрагентов.Приостановлен;
		Запись.Комментарий = СокрЛП(Комментарий);
		Запись.Автор = ПараметрыСеанса.ТекущийПользователь;
		Запись.Записать();
		
		Запись = РегистрыСведений.СтатусыОплатыПоДоговорамАренды.СоздатьМенеджерЗаписи();
		Запись.Договор = Договор;
		Запись.Период = КонецДня(ДатаКонца) + 1;
		Запись.Статус = Перечисления.СтатусыОплатыДоговоровКонтрагентов.Действует;
		Запись.Комментарий = СокрЛП(Комментарий);
		Запись.Автор = ПараметрыСеанса.ТекущийПользователь;
		Запись.Записать();		
	Иначе
		Запись = РегистрыСведений.СтатусыОплатыПоДоговорамАренды.СоздатьМенеджерЗаписи();
		Запись.Договор = Договор;
		Запись.Период = Период;
		Запись.Статус = Статус;
		Запись.Комментарий = СокрЛП(Комментарий);
		Запись.Автор = ПараметрыСеанса.ТекущийПользователь;
		Запись.Записать();
	КонецЕсли;
	
	//+++АК LAGP 2018.11.13 ИП-00020021 Уведомление менджеров по аренде о приостановке оплаты
	Обработки.ПлатежныйКалендарьПоАренде.УведомитьМенеджеровОприостановкеОплаты(Договор);
	//---АК LAGP
	
	//+++АК LAGP 2018.10.08 ИП-00020016 Комментарий по платеж. календарю по аренде
	МЗ = РегистрыСведений.ПримечанияПоДоговорамАренды.СоздатьМенеджерЗаписи();
	МЗ.ДоговорКонтрагента 	= Договор;
	МЗ.МесяцАренды 			= НачалоМесяца(ДатаНачала);
	МЗ.Прочитать();
	МЗ.ДоговорКонтрагента 	= Договор;
	МЗ.МесяцАренды 			= НачалоМесяца(ДатаНачала);
	МЗ.Примечание 			= СокрЛП(Комментарий);
	МЗ.Записать();
	//---АК LAGP
	
	Закрыть(СокрЛП(Комментарий)); //+++АК LAGP 2018.10.08 ИП-00020016 Добавлен возврат комментария
КонецПроцедуры

Процедура ПриОткрытии()
	ДатаНачала = ТекущаяДата();
	ДатаКонца = ТекущаяДата();
	Период = ТекущаяДата();
	
	флагВыбора = Истина;
КонецПроцедуры

Процедура ПриостановкаНаНесколькоМесяцевПриИзменении(Элемент)
	Если флагВыбора Тогда
		ЭлементыФормы.Панель1.Страницы.НесколькоМесяцев.Видимость = Истина;
		ЭлементыФормы.Панель1.Страницы.ИзменениеСтатуса.Видимость = Ложь;
	Иначе
		ЭлементыФормы.Панель1.Страницы.НесколькоМесяцев.Видимость = Ложь;
		ЭлементыФормы.Панель1.Страницы.ИзменениеСтатуса.Видимость = Истина;
	КонецЕсли;
КонецПроцедуры




