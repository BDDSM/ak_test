//  Процедура печатает выбранный документ 
// Печатается та форма, которая была отпечатана при нажатии в документе кнопки
// печати по умолчанию
//
Процедура ДействияФормыДействиеПечать(Кнопка)

	Если ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока = Неопределено тогда
		Возврат
	КонецЕсли;

	УниверсальныеМеханизмы.НапечататьДокументИзФормыСписка(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока.ПолучитьОбъект());

КонецПроцедуры // ДействиеПечать()

// Процедура вызывается при выборе пункта подменю "Движения документа по регистрам" меню "Перейти".
// командной панели формы. Процедура отрабатывает печать движений документа по регистрам.
//
Процедура ДействияФормыДвиженияДокументаПоРегистрам(Кнопка)

	Если ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока = Неопределено тогда
		Возврат
	КонецЕсли;

	РаботаСДиалогами.НапечататьДвиженияДокумента(ЭлементыФормы.Список.ТекущиеДанные.Ссылка);

КонецПроцедуры // ДействияФормыДвиженияДокументаПоРегистрам()

// Процедура вызывается при выборе пункта подменю "Структура подчиненности" меню "Перейти".
Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	
	Если ЭлементыФормы.Список.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	РаботаСДиалогами.ПоказатьСтруктуруПодчиненностиДокумента(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока);
	
КонецПроцедуры

// Процедура вызывается при нажатии на кнопку "файлы"
Процедура ДействияФормыФайлы(Кнопка)
	
	Если ЭлементыФормы.Список.ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли; 
	
	Ссылка = ЭлементыФормы.Список.ТекущаяСтрока.Ссылка;
	ФормаФайлов = Справочники.ХранилищеДополнительнойИнформации.ПолучитьФорму("ФормаСпискаФайловИИзображений", ЭтаФорма);
	
	ФормаФайлов.Изображения.Отбор.Объект.Использование                               = Истина;
	ФормаФайлов.Изображения.Отбор.Объект.Значение                                    = Ссылка;
	ФормаФайлов.ЭлементыФормы.Изображения.НастройкаОтбора.Объект.Доступность         = Ложь;
	ФормаФайлов.ЭлементыФормы.Изображения.Колонки.Объект.Видимость                   = Ложь;

	ФормаФайлов.ДополнительныеФайлы.Отбор.Объект.Использование                       = Истина;
	ФормаФайлов.ДополнительныеФайлы.Отбор.Объект.Значение                            = Ссылка;
	ФормаФайлов.ЭлементыФормы.ДополнительныеФайлы.НастройкаОтбора.Объект.Доступность = Ложь;
	ФормаФайлов.ЭлементыФормы.ДополнительныеФайлы.Колонки.Объект.Видимость           = Ложь;

	ОбязательныеОтборы = Новый Структура;
	ОбязательныеОтборы.Вставить("Объект",Ссылка);

	ФормаФайлов.ОбязательныеОтборы = ОбязательныеОтборы;
	
	ФормаФайлов.Открыть();
	
КонецПроцедуры

Процедура ДействияФормыДействиеАнализ(Кнопка)
	Если ЭлементыФормы.Список.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	УправлениеЗаказами.СформироватьОтчетАнализЗаказа(ЭлементыФормы.Список.ТекущиеДанные.Ссылка,ложь, истина);

КонецПроцедуры

// Процедура - обработчик действия элемента "СогласованиеЗаказа" панели "ДействияФормы".
//
Процедура ДействияФормыСогласованиеЗаказа(Кнопка)

	ТекущиеДанные = ЭлементыФормы.Список.ТекущиеДанные;

	Если ТекущиеДанные <> Неопределено Тогда
		РаботаСБизнесПроцессами.ОткрытьСписокСогласованиеЗаказаПокупателяПоДокументу(ТекущиеДанные.Ссылка);
	КонецЕсли;

КонецПроцедуры // ДействияФормыСогласованиеЗаказа()

//+WA
Процедура ДействияФормыЗагрузитьЗаказы(Кнопка)
	Выборка = Справочники.CMS1C_НастройкиСайтов.Выбрать();	
	Список = Новый СписокЗначений;
	Пока Выборка.Следующий() Цикл
		Если Выборка.ПометкаУдаления Тогда
			Продолжить;
		КонецЕсли;
		Список.Добавить(Выборка.Ссылка,Выборка.Наименование); 
	КонецЦикла;
	
	
	Если Список.Количество() =0 Тогда
		Возврат;
	КонецЕсли;
	
	Если Список.Количество() > 1 Тогда
		Ф = ПолучитьФорму("Обработка.CMS1C_ОбработкаОбмена.Форма.ФормаВыбораСпискаСайтовДляЗагрузкиЗаказов");
		Список = Ф.ОткрытьМодально();
	КонецЕсли;
	
	Если Список = Неопределено тОгда
		Возврат;
	КонецЕсли;
	Отказ = Ложь;
	
	Для Каждого ЭлементСписка из Список Цикл
		//Если НЕ ЗначениеЗаполнено(Ссылка.Значение.СтатусЗаказаНовый) Тогда	 
		Если НЕ ЭлементСписка.Значение.СтатусыДляЗагрузки.Количество() Тогда	 
			Сообщить("В настройке сайта "+ЭлементСписка.Значение+" не заданы статусы загружаемых заказов");
			ЭлементСписка.Значение.ПолучитьФорму().Открыть();
			Отказ = Истина;
			Продолжить;
		КонецЕсли;
	КонецЦикла;
	Если Отказ Тогда
		Возврат;
	КонецЕСли;
	
	Параметры = Новый Структура;
	Параметры.Вставить("СписокНастроекСайтов",Список);
	ОткрытьФорму("Справочник.CMS1C_НастройкиСайтов.Форма.ФормаЗагрузкиЗаказов",Параметры);
КонецПроцедуры

Процедура СписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	CMS1C_ПроцедурыОбменаССайтомКлиент.ЗаказыПриВыводеСтроки(Элемент,ОформлениеСтроки,ДанныеСтроки);
КонецПроцедуры

Процедура СписокВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	CMS1C_ПроцедурыОбменаССайтомКлиент.ОткрытьФормуЗаказа(Элемент,ВыбраннаяСтрока);
КонецПроцедуры

Процедура СписокПередНачаломДобавления(Элемент, Отказ, Копирование)
	Отказ = Истина;
	CMS1C_ПроцедурыОбменаССайтомКлиент.ОткрытьФормуНовогоЗаказа(Элемент,ЭлементыФормы.Список.ТекущаяСтрока,Копирование);
КонецПроцедуры

CMS1C_ПроцедурыОбменаССайтомКлиент.ДобавитьКнопкиИКолонкиНаФормуСпискаЗаказов(ЭтаФорма);
//-WA

