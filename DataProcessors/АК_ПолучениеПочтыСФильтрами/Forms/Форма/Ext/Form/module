
Процедура ПрочитатьПочтуНажатие(Элемент)
	ПолучитьПочтуСФильтрами();
	//РегламентныеЗаданияСервер.ПолучениеПочтыСФильтрами();
КонецПроцедуры

Процедура ПроверкаТаблицыНажатие(Элемент)
	ЭлементыФормы.ТабличноеПоле1.Значение.Очистить();
	ПроверкаТаблицыНажатиеМодуль();   
КонецПроцедуры

Процедура ОчисткаТаблицыНажатие(Элемент)
	//Для Каждого Строка ИЗ ТаблицаРезультат Цикл
	//	Сообщить(Строка.email_uid);
	//	email_uid_del = СтрЗаменить(Строка.email_uid, "}", "");
	//	email_uid_del = СтрЗаменить(email_uid_del, "{", "");
		ADOСоединение = ПолучитьADOСоединение_();
		ТекстЗапроса = "DELETE FROM [SMS_Repl].[dbo].[List_answer_emails] WHERE email_uid=('" + СокрЛП(email_uid_del)  + "')";
		Сообщить(ТекстЗапроса);
		Попытка	
			ADOСоединение.Execute(ТекстЗапроса);
		Исключение
			Сообщить(ОписаниеОшибки());
		КонецПопытки;
	//КонецЦикла;
	
	//Для Каждого Строка ИЗ ТаблицаРезультат Цикл
	//	Сообщить(Строка.email_uid);
	//	email_uid_del = СтрЗаменить(Строка.email_uid, "}", "");
	//	email_uid_del = СтрЗаменить(email_uid_del, "{", "");
	//	ADOСоединение = ПолучитьADOСоединение_();
	//	ТекстЗапроса = "DELETE FROM [SMS_Repl].[dbo].[List_answer_emails] WHERE email_uid=('" + СокрЛП(email_uid_del)  + "')";
	//	Сообщить(ТекстЗапроса);
	//	Попытка	
	//		ADOСоединение.Execute(ТекстЗапроса);
	//	Исключение
	//		Сообщить(ОписаниеОшибки());
	//	КонецПопытки;
	//КонецЦикла;


	
КонецПроцедуры

Процедура Кнопка1Нажатие(Элемент)
	
	
	Почта 						= Новый ИнтернетПочта;
	//////Профиль 					= УправлениеЭлектроннойПочтой.ПолучитьИнтернетПочтовыйПрофиль(УчёткаЭлектроннойПочты);
	Профиль 					= Новый ИнтернетПочтовыйПрофиль;

	////
	////
	Сервер = "pop.gmail.com";  
	////Профиль.Пароль 				= "s539Ti11";
	////Профиль.Пользователь 		= "vkusvill@it-stuff.ru";;
	////Профиль.ПортPOP3 = 995;
	////Профиль.АдресСервераPOP3 = Сервер;
	////Профиль.АутентификацияPOP3 = СпособPOP3Аутентификации.Обычная;
	////
	////Профиль.ТолькоЗащищеннаяАутентификацияPOP3 = Истина;

	////
	////Профиль.Таймаут = 5;
	////
	////Почта.Подключиться(Профиль, ПротоколИнтернетПочты.POP3);
	////
	////Возврат;
	
	
//	Incoming Mail (POP) Server	
//pop.gmail.com

//Requires SSL: Yes

//Port: 995
//Почта 						= Новый ИнтернетПочта;
//	Профиль 					= УправлениеЭлектроннойПочтой.ПолучитьИнтернетПочтовыйПрофиль(УчёткаЭлектроннойПочты);
//	Профиль.Пользователь 		= АдресЭПОтправителя;
//	Профиль.ПользовательSMTP 	= "vkusvill.333@gmail.com"; //АдресЭПОтправителя;
//	Профиль.ПользовательIMAP 	= "vkusvill.333@gmail.com"; //АдресЭПОтправителя;
//	Профиль.Пароль 				= "v352aa44";
//	Профиль.ПарольSMTP 			= Профиль.Пароль;
//	Профиль.ПарольIMAP 			= Профиль.Пароль;
//	Профиль.ПортIMAP 			= 993;
//	Профиль.ИспользоватьSSLIMAP = Истина;
//	Профиль.АдресСервераIMAP 	= "imap.gmail.com";
//	Почта.Подключиться(Профиль, ПротоколИнтернетПочты.IMAP);

	
	

	
	
	Профиль.Пользователь 		= "vkusvill@it-stuff.ru";;
	Профиль.ПользовательSMTP 	= "vkusvill@it-stuff.ru"; //АдресЭПОтправителя;
	Профиль.ПользовательIMAP 	= "vkusvill@it-stuff.ru"; //АдресЭПОтправителя;
	
	Профиль.Пароль 				= "s539Ti11";
	Профиль.ПарольSMTP 			= "s539Ti11";
	Профиль.ПарольIMAP 			= "s539Ti11";
	Профиль.ПортIMAP 			= 993;
	Профиль.ИспользоватьSSLIMAP = Истина;
	Профиль.АдресСервераIMAP 	= "imap.gmail.com";
	//Профиль.ТолькоЗащищеннаяАутентификацияIMAP = Истина;
	Почта.Подключиться(Профиль, ПротоколИнтернетПочты.IMAP);
	
	
	//МассивЗаголовковПисем 	= Почта.ПолучитьЗаголовки();
	
	ФорматированныйДокумент 	= Новый ФорматированныйДокумент;
	КартинкиФорматДок 			= Новый Структура();
	Попытка
		НужныйЗаголовок 		= "#RVV823_";
		НужныйЗаголовок 		= "Статистика";

		//МассивЗаголовковПисем 	= Почта.ПолучитьЗаголовки(Новый Структура("Тема,Прочитанные", НужныйЗаголовок, Ложь));
		МассивЗаголовковПисем 	= Почта.ПолучитьЗаголовки(Новый Структура("Тема", НужныйЗаголовок));
		Если МассивЗаголовковПисем.Количество() = 0 Тогда
			Почта.Отключиться();
			Возврат ;
		КонецЕсли;
		
	Исключение
		КонецПопытки;
		
	Возврат ;


	
	Возврат;
	
	Сервер = "it-stuff.ru";
	Сервер = "pop.gmail.com";

		
	Почта 						= Новый ИнтернетПочта;
	Профиль 					= Новый ИнтернетПочтовыйПрофиль;
	Профиль.Пользователь 		= "vkusvill@it-stuff.ru";
	Профиль.ПользовательSMTP 	= "vkusvill@it-stuff.ru";
	Профиль.ПользовательIMAP 	= "vkusvill@it-stuff.ru";
	

	
	Профиль.Пароль 				= "s539Ti11";
	Профиль.ПарольIMAP 			= "s539Ti11";
	Профиль.ПарольSMTP 			= "s539Ti11";
	
	
	Профиль.ПортIMAP 			= "993";
	//Профиль.ПортSMTP 			= "25";
	//Профиль.ПортPOP3 			= "110";	
	
	Профиль.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;
	
	Профиль.ИспользоватьSSLIMAP 				= Истина;
	//Профиль.ИспользоватьSSLPOP3					= Истина;
	//Профиль.ИспользоватьSSLSMTP                 = Истина;
	
	//Профиль.ТолькоЗащищеннаяАутентификацияIMAP 	= Истина;
	//Профиль.ТолькоЗащищеннаяАутентификацияPOP3 	= Истина;
	//Профиль.ТолькоЗащищеннаяАутентификацияSMTP 	= Истина;

	
	//Профиль.АдресСервераIMAP 	= "it-stuff.ru";

	
	
	//Профиль.АдресСервераSMTP 	= Сервер;
	Профиль.АдресСервераIMAP 	= Сервер;
	//Профиль.АдресСервераPOP3 	= Сервер;
	
	//Профиль.АдресСервераIMAP 	= "it-stuff.ru";
	
	//Профиль.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;
	
	//Профиль.АдресСервераSMTP = УчетнаяЗапись.SMTPСервер;
	//Профиль.ПортSMTP = УчетнаяЗапись.ПортSMTP;
	//Профиль.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;
	Профиль.Таймаут = 5;
	
	Почта.Подключиться(Профиль, ПротоколИнтернетПочты.IMAP);
	//Почта.Подключиться(Профиль);
	
	
	//Почта.Подключиться(Профиль, ПротоколИнтернетПочты.SMTP);
	 //МассивЗаголовковПисем 	= Почта.ПолучитьЗаголовки();


	 Возврат;
	

	
	
	Профиль.ИспользоватьSSLIMAP = Истина;
	//Профиль.АдресСервераIMAP 	= "imap.gmail.com";
	Профиль.АдресСервераIMAP 	= "10.0.0.30";
	Профиль.АдресСервераPOP3 	= "10.0.0.30"; //УчетнаяЗаписьЭлектроннойПочты.POP3Сервер;
	//Почта.Подключиться(Профиль, ПротоколИнтернетПочты.POP3);
	Почта.Подключиться(Профиль, ПротоколИнтернетПочты.IMAP);

КонецПроцедуры

//----ФИНАЛИЗАЦИЯ 22-10-16--------------------------------
//----БЛОК АВТООБМЕН---------------------------------------------
Процедура АвтообменНажатие(Элемент)
        //Если НЕ ЗначениеЗаполнено(ДатаСреза) Тогда
    //    ДатаСреза = НачалоДня(ДатаСреза);
    //КонецЕсли;
    
    Сообщить ("СТАРТ");
    
    //ПерекинутьЗаказыНажатие(Неопределено);
                                                                              
    Если глАвтообмен Тогда 
        АвтообменОстановить(неопределено);
    Иначе
        АвтообменЗапустить(неопределено);
    КонецЕсли;
КонецПроцедуры
 
Процедура Таймер()
    АвтообменОстановить(неопределено);
    ПолучитьПочтуСФильтрами();
    Режим = РежимДиалогаВопрос.ДаНет;
    Текст = "Продолжить выполнение операции?";
    Ответ = Вопрос(Текст, Режим, 10);
    Если Ответ = КодВозвратаДиалога.Нет Тогда
        Возврат;
    КонецЕсли;
    АвтообменЗапустить(неопределено);
КонецПроцедуры
 
Процедура АвтообменЗапустить(Кнопка)
    //Товары.Очистить();
    //ФлажкиНажатие(неопределено);
    ПодключитьОбработчикОжидания("Таймер", ИнтервалЧтения);
    глАвтообмен = Истина; 
    //Элементыформы.кнАвтообмен.ЦветФонакнопки = WEBцвета.ЗеленоватоЛимонный;
    //Элементыформы.кнАвтообмен.Заголовок = "ВКЛЮЧЕН";
КонецПроцедуры
 
Процедура АвтообменОстановить(Кнопка)
    ОтключитьОбработчикОжидания("Таймер");
    глАвтообмен = Ложь;
    //Элементыформы.кнАвтообмен.ЦветФонакнопки = WEBцвета.красный;
    //Элементыформы.кнАвтообмен.Заголовок = "ОТКЛЮЧЕН";            
КонецПроцедуры