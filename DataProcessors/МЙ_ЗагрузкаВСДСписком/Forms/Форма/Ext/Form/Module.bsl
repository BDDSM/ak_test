
&НаКлиенте
Процедура Загрузить(Команда)
	//ПоолучитьСписокОбластей
	
	Высота = ТД.ВысотаТаблицы;
	
	Список = Новый СписокЗначений;
	
	Для а = 0 по Высота Цикл
		Текст = ТД.Область(а,2).Текст;
		
		Если СтрДлина(Текст) = 36 Тогда
			Список.Добавить(Текст);			
		КонецЕсли;		
	КонецЦикла;	
	
	ЗагрузитьСписокВСД(Список);
	
КонецПроцедуры


&НаСервере
Процедура ЗагрузитьСписокВСД(Список)
	НастройкаAPI = ОбменССистемойВетис.ОсновнаяНастройкаАПИ();
	
 	ТЗ_Результат.Очистить();
	
	Для каждого Стр Из Список Цикл
		Результат = ОбменССистемойВетис.ЗагрузитьВСД(НастройкаAPI,,,Стр.Значение, СтруктурнаяЕдиница);		
		
		Если ЗначениеЗаполнено(Результат) = Истина Тогда
			НСТр = ТЗ_Результат.Добавить();
			НСтр.ВСД = Результат;
		КонецЕсли;
	КонецЦикла;
	
	//++ АК hamz ИП-00020278 01.10.2018
	Если ТЗ_Результат.Количество() > 0 Тогда	
		ОбменССистемойВетис.ОбновитьСоответствияКонтрагентовПоИНН();
		ОбменССистемойВетис.ОбновитьКонтрагентовВСД();
	КонецЕсли;	
	//++ АК hamz ИП-00020278 01.10.2018
КонецПроцедуры

