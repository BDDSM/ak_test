
Функция ПолучитьСтруктуруПараметровОК()
	
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("Статус"					, ЭтаФорма.Статус);
	СтруктураПараметров.Вставить("Причина"					, ЭтаФорма.Причина);
	СтруктураПараметров.Вставить("ПричинаПриостановки"		, ЭтаФорма.ПричинаПриостановки);
	СтруктураПараметров.Вставить("ДатаВывода"				, ЭтаФорма.ДатаВывода);
	СтруктураПараметров.Вставить("ДатаОжидаемогоВозврата"	, ЭтаФорма.ДатаОжидаемогоВозврата);
	СтруктураПараметров.Вставить("ТоварыПоставщиков"		, ЭтаФорма.ТоварыПоставщика.Выгрузить());
	
	Возврат СтруктураПараметров;
	
КонецФункции

&НаКлиенте
Процедура КомандаОК(Команда)

	//
	СтруктураПараметров = ПолучитьСтруктуруПараметровОК();
	
	ЭтаФорма.Закрыть(СтруктураПараметров);
	
КонецПроцедуры


Процедура ЗаполнитьТоварыПоставщиковСервер()
	
	//
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("МассивПоставщиков", ЭтаФорма.Поставщики.ВыгрузитьЗначения());
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ЦеныПоставщиковСрезПоследних.Номенклатура,
	|	ЦеныПоставщиковСрезПоследних.Характеристика,
	|	ЦеныПоставщиковСрезПоследних.Поставщик
	|ИЗ
	|	РегистрСведений.ЦеныПоставщиков.СрезПоследних(, ) КАК ЦеныПоставщиковСрезПоследних
	|ГДЕ
	|	ЦеныПоставщиковСрезПоследних.Поставщик В(&МассивПоставщиков)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ЦеныПоставщиковСрезПоследних.Номенклатура.Наименование,
	|	ЦеныПоставщиковСрезПоследних.Характеристика.Наименование";
	
	//
	ЭтаФорма.ТоварыПоставщика.Загрузить(Запрос.Выполнить().Выгрузить());
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаполнитьТоварыПоставщиков(Команда)
	
	ЗаполнитьТоварыПоставщиковСервер();
	
КонецПроцедуры

&НаКлиенте
Процедура ОтметитьВсеТовары(Команда)

	Для Каждого СтрокаТаблицы Из ЭтаФорма.ТоварыПоставщика Цикл
		СтрокаТаблицы.Отметка = Истина;
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура СнятьПометкиТовары(Команда)

	Для Каждого СтрокаТаблицы Из ЭтаФорма.ТоварыПоставщика Цикл
		СтрокаТаблицы.Отметка = Ложь;
	КонецЦикла;
	
КонецПроцедуры
