
&НаКлиенте
Процедура ОтправитьСообщение(Команда)
	
	Если Вопрос("Желаете отправить?", РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Да Тогда
		
		лкСписокДляОтправки = Новый СписокЗначений;
		Для каждого ТекСтр Из Объект.СписокПолучателей Цикл
			
			лкСписокДляОтправки.Добавить(ТекСтр.АдресТелефон);	
			
		КонецЦикла;
		
		Закрыть(лкСписокДляОтправки);	
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Отмена(Команда)
	
	Закрыть(Неопределено);
	
КонецПроцедуры

//+++АК SHEP 2018.04.17 ИП-00018126.01
&НаКлиенте
Процедура ЗаполнитьСписком(Команда)
	
	ОткрытьФорму("Обработка.ПочтоваяРассылка.Форма.ФормаЗаполненияПоСписку", , Элементы.СписокПолучателей);
	
КонецПроцедуры

//+++АК SHEP 2018.04.17 ИП-00018126.01
&НаКлиенте
Процедура СписокПолучателейОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
Перем ТелефонСтр;
	
	Если ТипЗнч(ВыбранноеЗначение) = Тип("Массив") Тогда
		
		СтандартнаяОбработка = Ложь;
		Для Каждого ТелефонСтр Из ВыбранноеЗначение Цикл
			
			//требуется научить обработку понимать формат, с "7" в самом начале
			Если СтрДлина(ТелефонСтр) = 11 И Лев(ТелефонСтр, 1) = "7" Тогда
				ТелефонСтр = Сред(ТелефонСтр, 2);
			КонецЕсли;
			
			СтрокаТЧ = Объект.СписокПолучателей.Добавить();
			СтрокаТЧ.АдресТелефон = ТелефонСтр;
			
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры
