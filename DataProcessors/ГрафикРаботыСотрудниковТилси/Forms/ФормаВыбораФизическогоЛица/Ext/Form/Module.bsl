
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Список.Параметры.УстановитьЗначениеПараметра("ФизЛицо", Параметры.ТекущийПомощник);
	
	//Установка отбора по доступным "Помощнику ТУ" сотрудникам
	Если ЗначениеЗаполнено(Параметры.ТекущийПомощник) Тогда
		Отбор = Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных")); 
		Отбор.ЛевоеЗначение 	= Новый ПолеКомпоновкиДанных("ФизЛицо.ПомощникТУ"); 
		Отбор.ВидСравнения 		= ВидСравненияКомпоновкиДанных.Равно; 
		Отбор.Использование 	= Истина; 
		Отбор.РежимОтображения 	= РежимОтображенияЭлементаНастройкиКомпоновкиДанных.БыстрыйДоступ;
		Отбор.ПравоеЗначение 	= Параметры.ТекущийПомощник;
	КонецЕсли;

	// Открытие из формы передачи помощнику ТТ
	Если Параметры.Адрес <> "" Тогда
		
		СписокЗначений = Новый СписокЗначений;
		СписокЗначений.ЗагрузитьЗначения(ПолучитьИзВременногоХранилища(Параметры.Адрес).ВыгрузитьКолонку("Значение"));
		
		Отбор = Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных")); 
		Отбор.ЛевоеЗначение 	= Новый ПолеКомпоновкиДанных("ФизЛицо"); 
		Отбор.ВидСравнения 		= ВидСравненияКомпоновкиДанных.ВСписке; 
		Отбор.Использование 	= Истина; 
		Отбор.РежимОтображения 	= РежимОтображенияЭлементаНастройкиКомпоновкиДанных.БыстрыйДоступ;
		Отбор.ПравоеЗначение 	= СписокЗначений;
		
	Иначе
		
		//mind попросил Валера отключить
		//Отбор = Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных")); 
		//Отбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("ЦФО"); 
		//Отбор.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно; 
		//Отбор.Использование = Истина; 
		//Отбор.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.БыстрыйДоступ;
		//Отбор.ПравоеЗначение = Параметры.ЦФО;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

#КонецОбласти

#Область ОбработчикиСобытийЭлементовСписка

&НаКлиенте
Процедура СписокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	ТекДанные = Элементы.Список.ТекущиеДанные;
	Если ТекДанные.Активный Тогда
		Закрыть(ТекДанные.ФизЛицо);
	Иначе
		ПоказатьПредупреждение(, "Запрещено указывать в графики неактивных сотрутников(отсутствует признак «Активный» в карточке физ. лица)!");
	КонецЕсли;

КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Выбрать(Команда)
	
	ТекДанные = Элементы.Список.ТекущиеДанные;
	Если ТекДанные.Активный Тогда
		Закрыть(ТекДанные.ФизЛицо);
	Иначе
		ПоказатьПредупреждение(, "Запрещено указывать в графики неактивных сотрутников(отсутствует признак «Активный» в карточке физ. лица)!");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОтключитьОтбор(Команда)
	
	Элементы.СписокОтключитьОтбор.Доступность = Ложь;
	
	ОчиститьОтборыНаСервере();
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура ОчиститьОтборыНаСервере()
	
	Список.Отбор.Элементы.Очистить();
	
КонецПроцедуры

#КонецОбласти






