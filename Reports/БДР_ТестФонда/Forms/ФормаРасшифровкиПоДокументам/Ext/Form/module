
Процедура ПолеТабличногоДокумента1Выбор(Элемент, Область, СтандартнаяОбработка)
	
	
КонецПроцедуры

Процедура ПолеРасшифровкиОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	
	
КонецПроцедуры

Процедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	
	//???ZEZA
	//Если ТипЗнч(Расшифровка) = Тип("Структура") Тогда	
	//	СтандартнаяОбработка = Ложь;
	//	ФормаОперации = Расшифровка.Документ.ПолучитьФорму();
	//	СтатьяДР = Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(СтатьяДР_Код));
	//	Если Расшифровка.Сумма < 0 Тогда
	//		ФормаОперации.ЭлементыФормы.ТабличноеПолеДвижения.ОтборСтрок.СубконтоКт2.Установить(СтатьяДР);
	//	Иначе
	//		ФормаОперации.ЭлементыФормы.ТабличноеПолеДвижения.ОтборСтрок.СубконтоДт2.Установить(СтатьяДР);
	//	КонецЕсли;
	//	ФормаОперации.Открыть();
	//КонецЕсли;
КонецПроцедуры







//
//
Процедура _ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	
	//
	ТЗ = "ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""01"" КАК Код,
	     |	""Выручка"" КАК ГруппаУр1,
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов) КАК ГруппаУр2,
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов).Код КАК ГруппаУр2_Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК Период,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК МесяцПоРегистратору,
	     |	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ОрганизацияПоРегистратору,
	     |	МЕСЯЦ(Таблица.ПериодМесяц) КАК Месяц,
	     |	ГОД(Таблица.ПериодМесяц) КАК Год,
	     |	Таблица.Субконто1 КАК ТорговыеТочки,
	     |	Таблица.Субконто1.id_TT КАК КодТорговойТочки,
	     |	Таблица.Субконто2 КАК Статья,
	     |	Таблица.Субконто2.Код КАК КодСтатьи,
	     |	Таблица.Субконто3 КАК ЦФО,
	     |	-Таблица.СуммаОборот КАК Сумма,
	     |	-Таблица.СуммаМСФООборот КАК СуммаКорр,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот) КАК СуммаМСФО,
	     |	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент КАК Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""01"",
	     |	""Выручка"",
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.СуммаОборотКт,
	     |	Таблица.СуммаМСФООборотКт,
	     |	Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт,
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные, &УЕК)
	     |				И Субконто2.Код <> ""61010""
	     |				И Субконто2.Код <> ""21002""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	ВЫБОР
	     |		КОГДА ЛОЖЬ
	     |				И Таблица.Субконто2.Родитель.Код = ""207  ""
	     |			ТОГДА ""Налоги""
	     |		ИНАЧЕ Таблица.Субконто2.Родитель
	     |	КОНЕЦ,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель.Код = ""207  ""
	     |			ТОГДА &СтатьиДР_НалогУпр
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель.Код = ""207  ""
	     |			ТОГДА ""20742""
	     |		ИНАЧЕ Таблица.Субконто2.Код
	     |	КОНЕЦ,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные, &УЕК)
	     |				И НЕ Субконто2 В ИЕРАРХИИ
	     |						(ВЫБРАТЬ
	     |							Таблица.Ссылка
	     |						ИЗ
	     |							Справочник.СтатьиДоходовРасходов КАК Таблица
	     |						ГДЕ
	     |							(Таблица.Код = ""6    ""
	     |								ИЛИ Таблица.Код = ""213  ""))
	     |				И Субконто2.Код <> ""21002""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборотДт,
	     |	-Таблица.СуммаМСФООборотДт,
	     |	-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
	     |			&ВидыСубконто90,
	     |			Субконто2.Код <> ""21002""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	ВЫРАЗИТЬ(&СтатьиДР_ГруппаСебестоимость КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(&СтатьиДР_ГруппаСебестоимость КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫРАЗИТЬ(&СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(&СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет.Код = ""96.1"",
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (&СчетПродажи, ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""03"",
	     |	""Постоянные затраты"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные, &УЕК)
	     |				И НЕ Субконто2 В ИЕРАРХИИ
	     |						(ВЫБРАТЬ
	     |							Таблица.Ссылка
	     |						ИЗ
	     |							Справочник.СтатьиДоходовРасходов КАК Таблица
	     |						ГДЕ
	     |							(Таблица.Код = ""6    ""
	     |								ИЛИ Таблица.Код = ""213  ""))
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код + "" (Кт)"",
	     |	Таблица.Субконто3,
	     |	Таблица.СуммаОборотКт,
	     |	Таблица.СуммаМСФООборотКт,
	     |	Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт,
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	ВЫРАЗИТЬ(ВЫРАЗИТЬ(ВЫБОР
	     |				КОГДА Таблица.Субконто2.Код = ""20129""
	     |					ТОГДА СтатьяДР_Выручка.Ссылка
	     |				ИНАЧЕ Таблица.Субконто2
	     |			КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(ВЫРАЗИТЬ(ВЫБОР
	     |				КОГДА Таблица.Субконто2.Код = ""20129""
	     |					ТОГДА СтатьяДР_Выручка.Ссылка
	     |				ИНАЧЕ Таблица.Субконто2
	     |			КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Код = ""20129""
	     |			ТОГДА СтатьяДР_Выручка.Ссылка
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2.Код = ""20129""
	     |				ТОГДА СтатьяДР_Выручка.Ссылка
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Код + "" (Кт)"",
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборотДт,
	     |	-Таблица.СуммаМСФООборотДт,
	     |	-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт,
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	     |				И НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СтатьиДоходовРасходов КАК СтатьяДР_Выручка
	     |		ПО (СтатьяДР_Выручка.Код = ""10105"")
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(Таблица.Субконто2.Родитель КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код + "" (Дт)"",
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборотДт,
	     |	-Таблица.СуммаМСФООборотДт,
	     |	-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2.Код <> ""61010""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = &Счет442,
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ
	     |						(ВЫБРАТЬ
	     |							Таблица.Ссылка
	     |						ИЗ
	     |							Справочник.СтатьиДоходовРасходов КАК Таблица
	     |						ГДЕ
	     |							(Таблица.Код = ""6    ""
	     |								ИЛИ Таблица.Код = ""213  ""))
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2.Код = ""21002""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10"",
	     |	""Инвестиции"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&КП)},
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			(НЕ Субконто2 В ИЕРАРХИИ
	     |						(ВЫБРАТЬ
	     |							Таблица.Ссылка
	     |						ИЗ
	     |							Справочник.СтатьиДоходовРасходов КАК Таблица
	     |						ГДЕ
	     |							(Таблица.Код = ""6    ""
	     |								ИЛИ Таблица.Код = ""213  ""))
	     |				ИЛИ Субконто2.Код = ""61010"")
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10"",
	     |	""Инвестиции"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			Субконто2 В ИЕРАРХИИ
	     |					(ВЫБРАТЬ
	     |						Таблица.Ссылка
	     |					ИЗ
	     |						Справочник.СтатьиДоходовРасходов КАК Таблица
	     |					ГДЕ
	     |						(Таблица.Код = ""6    ""
	     |							ИЛИ Таблица.Код = ""213  ""))
	     |				И НЕ Субконто2.Код = ""61014""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И НЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Основные средства"",
	     |	""121"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""121"",
	     |	""Основные средства"",
	     |	NULL,
	     |	-Таблица.СуммаОборотДт,
	     |	-Таблица.СуммаМСФООборотДт,
	     |	-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции)), , {(Организация).*}, , ) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Выручка"",
	     |	""101"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""101_"",
	     |	""Себестоимость использованной упаковки"",
	     |	NULL,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , {(Организация).*}, КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.МатералыДляВыпуска), ) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Доставка товаров на склад"",
	     |	""102"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""102"",
	     |	""Доставка товаров на склад"",
	     |	NULL,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , Субконто3.Код = ""00000023"" {(Организация).*}, , ) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Налоги"",
	     |	""207"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	Таблица.КорСубконто2.Код,
	     |	Таблица.КорСубконто2,
	     |	NULL,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2 = &СтатьиДР_НалогУпр
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные, &УЕК)
	     |				И НЕ Субконто2 В ИЕРАРХИИ
	     |						(ВЫБРАТЬ
	     |							Таблица.Ссылка
	     |						ИЗ
	     |							Справочник.СтатьиДоходовРасходов КАК Таблица
	     |						ГДЕ
	     |							(Таблица.Код = ""6    ""
	     |								ИЛИ Таблица.Код = ""213  ""))
	     |				И Субконто2.Код <> ""21002""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.НалогиУН)),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Налоги"",
	     |	""207"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	Таблица.ПериодМесяц,
	     |	Таблица.Организация,
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	"""",
	     |	""НДС не принятый к зачету"",
	     |	NULL,
	     |	-Таблица.СуммаКонечныйОстаток,
	     |	-Таблица.СуммаМСФОКонечныйОстаток,
	     |	-(Таблица.СуммаКонечныйОстаток + Таблица.СуммаМСФОКонечныйОстаток),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Авто, , Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНДС), , ) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Убыток прошлых периодов"",
	     |	""103"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""103"",
	     |	""Убыток прошлых периодов"",
	     |	NULL,
	     |	-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт),
	     |	-(Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт),
	     |	-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт + (Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт)),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), , {(Организация).*}, КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов), ) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10.1"",
	     |	""Амортизация ОС"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			Субконто2.Код <> ""61014""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10.1"",
	     |	""Амортизация ОС"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			Субконто2.Код = ""61014""
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ &Проект = НЕОПРЕДЕЛЕНО
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
	     |				ИЛИ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции)),
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ
	     |
	     |ВЫБРАТЬ
	     |	""Проект Избенка"",
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Проект Избенка"",
	     |	""104"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""104"",
	     |	""Проект Избенка"",
	     |	NULL,
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ЛОЖЬ,
	     |	Таблица.Регистратор,
	     |	Таблица.Регистратор.Контрагент
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи)), , Организация.Код = ""000000005"" {(""Проект Избёнка"") КАК Организация}, НЕ КорСчет В (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)), ) КАК Таблица
	     |{ГДЕ
	     |	(""Проект Избёнка"") КАК Организация}";
							  
							  
	//
	ПостроительОтчета = Новый ПостроительЗапроса;
	ПостроительОтчета.Текст = ТЗ;
	ПостроительОтчета.ЗаполнитьНастройки();
	
	//Парметры данных
	СтруктураПараметрыДанных = СтруктураПараметров.СтруктураПараметрыДанных;
	Для Каждого ЭлементСтруктуры Из СтруктураПараметрыДанных Цикл
		
		//
		ПостроительОтчета.Параметры.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);
		
	КонецЦикла;	
	
	//
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ГруппаСебестоимость", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("201"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Корректировки", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20120"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_ВыручкаОптовыхПродаж", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10105"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_СебестоимостьПроданногоТовара", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20110"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_НалогУпр", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20742") );
	
	
	//Отборы
	СтруктураЗначенийРасшифровки = СтруктураПараметров.СтруктураЗначенийРасшифровки;
	Для Каждого ЭлементСтруктуры Из СтруктураЗначенийРасшифровки Цикл
		
		//
		Попытка
			ЭлементОтбора = ПостроительОтчета.Отбор.Добавить(ЭлементСтруктуры.Ключ);
		Исключение
			Продолжить;
		КонецПопытки;	
		
		//
		Если ТипЗнч(ЭлементСтруктуры.Значение) = Тип("СписокЗначений") Тогда
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			
		ИначеЕсли ТипЗнч(ЭлементСтруктуры.Значение) = Тип("Массив") Тогда	
			
			//
			СписокЗначений = Новый СписокЗначений;
			СписокЗначений.ЗагрузитьЗначения(ЭлементСтруктуры.Значение);
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = СписокЗначений;
			
		Иначе	
			
			//
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			ЭлементОтбора.ВидСравнения = ВидСравнения.Равно;
			
		КонецЕсли;	
		
		//
		ЭлементОтбора.Использование = Истина;	
		
	КонецЦикла;	
	
	//
	Макет = ПолучитьМакет("РасшифровкаПоДокументам_Универсальный");
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	
	//
	ОбластьМакета.Параметры.ДатаНач = Формат(ПостроительОтчета.Параметры.НачалоПериода, "ДФ=dd.MM.yy");
	ОбластьМакета.Параметры.ДатаКон = Формат(ПостроительОтчета.Параметры.КонецПериода, "ДФ=dd.MM.yy");
	
	//
	ОбластьМакета.Параметры.ОтборПредставление = ПостроительОтчета.Отбор;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
	//
	ПостроительОтчета.Выполнить();
	
	//
	СуммаИтого = 0;
	
	//
	Выборка = ПостроительОтчета.Результат.Выбрать();
	Пока Выборка.Следующий() Цикл
		
		//
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		
		//
		ОбластьМакета.Параметры.Документ = Выборка.Регистратор;
		ОбластьМакета.Параметры.Контрагент = Выборка.Контрагент;
		
		//
		Попытка
			ОбластьМакета.Параметры.Комментарий = Выборка.Регистратор.Комментарий;
		Исключение
		КонецПопытки;	
		
		//
		Попытка
			Автор = Выборка.Регистратор.Автор;
		Исключение
		КонецПопытки;
		
		//
		Если НЕ ЗначениеЗаполнено(Автор) Тогда
			
			//
			Попытка
				Автор = Выборка.Регистратор.Ответственный;
			Исключение
			КонецПопытки;
			
		КонецЕсли;	
		
		//
		ОбластьМакета.Параметры.Автор = Автор;
		
		//
		ОбластьМакета.Параметры.Сумма = Выборка.Сумма;
		
		//
		СуммаИтого = СуммаИтого + Выборка.Сумма;
		
		//
		ЭлементыФормы.Результат.Вывести(ОбластьМакета);
		
	КонецЦикла;	
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
	ОбластьМакета.Параметры.Сумма = СуммаИтого;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
КонецПроцедуры

//
//
Процедура __ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	
	//
	ТЗ = "ВЫБРАТЬ
	     |	Таблица.Организация КАК Организация,
	     |	""01"" КАК Код,
	     |	""Выручка"" КАК ГруппаУр1,
	     |	Таблица.Субконто2.Родитель КАК ГруппаУр2,
	     |	Таблица.Субконто2.Родитель.Код КАК ГруппаУр2_Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК Период,
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ) КАК МесяцПоРегистратору,
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ОрганизацияПоРегистратору,
	     |	МЕСЯЦ(Таблица.ПериодМесяц) КАК Месяц,
	     |	ГОД(Таблица.ПериодМесяц) КАК Год,
	     |	Таблица.Субконто1 КАК ТорговыеТочки,
	     |	Таблица.Субконто1.id_TT КАК КодТорговойТочки,
	     |	Таблица.Субконто2 КАК Статья,
	     |	Таблица.Субконто2.Код КАК КодСтатьи,
	     |	Таблица.Субконто3 КАК ЦФО,
	     |	Таблица.Регистратор КАК Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)) КАК РегистраторКомментарий,
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	     |				ТОГДА -Таблица.СуммаОборот
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА Таблица.СуммаОборотКт
	     |		КОНЕЦ) КАК Сумма,
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	     |				ТОГДА -Таблица.СуммаМСФООборот
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА Таблица.СуммаМСФООборотКт
	     |		КОНЕЦ) КАК СуммаКорр,
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	     |				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт
	     |		КОНЕЦ) КАК СуммаМСФО,
	     |	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	     |				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*, (""Выручка"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КП,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&УЕК)
	     |				И Субконто2 <> &СтатьиДР_АмортизацияИнвестицийВТТ
	     |				И Субконто2 <> &СтатьиДР_ПодарочныеСертификаты
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Переменные затраты"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель = &СтатьиДР_Группа_НалогНаПрибыль
	     |			ТОГДА &СтатьиДР_НалогУпр
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель = &СтатьиДР_Группа_НалогНаПрибыль
	     |			ТОГДА ""20742""
	     |		ИНАЧЕ Таблица.Субконто2.Код
	     |	КОНЕЦ,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА -Таблица.СуммаОборотДт
	     |			ИНАЧЕ -Таблица.СуммаОборот
	     |		КОНЕЦ),
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА -Таблица.СуммаМСФООборотДт
	     |			ИНАЧЕ -Таблица.СуммаМСФООборот
	     |		КОНЕЦ),
	     |	СУММА(ВЫБОР
	     |			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	     |				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
	     |			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
	     |		КОНЕЦ),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |					И Счет <> &Счет442
	     |				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&УЕК)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_СписаниеИнвестиций)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_Резервы)
	     |				И Субконто2 <> &СтатьиДР_ПодарочныеСертификаты
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Переменные затраты"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
	     |			    КОГДА Субконто2.Родитель = &СтатьиДР_Группа_НалогНаПрибыль
	     |			        ТОГДА &СтатьиДР_НалогУпр
	     |			    ИНАЧЕ Субконто2
	     |			КОНЕЦ) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель = &СтатьиДР_Группа_НалогНаПрибыль
	     |			ТОГДА &СтатьиДР_НалогУпр
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2.Родитель = &СтатьиДР_Группа_НалогНаПрибыль
	     |			ТОГДА ""20742""
	     |		ИНАЧЕ Таблица.Субконто2.Код
	     |	КОНЕЦ,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""02"",
	     |	""Переменные затраты"",
	     |	ВЫРАЗИТЬ(&СтатьиДР_ГруппаСебестоимость КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(&СтатьиДР_ГруппаСебестоимость КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫРАЗИТЬ(&СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(&СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = &Счет961,
	     |			&ВидыСубконто90,
	     |			Субконто2 <> &СтатьиДР_ВыручкаОтПродажиОС
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Переменные затраты"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&СтатьиДР_Корректировки) КАК Статья, (&СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""03"",
	     |	""Постоянные затраты"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			(Субконто2 В ИЕРАРХИИ (&ЗатратыПостоянные)
	     |				ИЛИ Субконто2 В ИЕРАРХИИ (&УЕК))
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_СписаниеИнвестиций)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_Резервы)
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Постоянные затраты"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""03"",
	     |	""Постоянные затраты"",
	     |	ВЫРАЗИТЬ(&СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель,
	     |	ВЫРАЗИТЬ(&СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫРАЗИТЬ(&СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов),
	     |	ВЫРАЗИТЬ(&СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	-Таблица.СуммаОборот,
	     |	-Таблица.СуммаМСФООборот,
	     |	-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	     |	ИСТИНА
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = &Счет961,
	     |			&ВидыСубконто90,
	     |			Субконто2 = &СтатьиДР_ВыручкаОтПродажиОС
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*},
	     |			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВГОРасчетыСПокупателями)
	     |				ИЛИ ИСТИНА,
	     |			) КАК Таблица
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код + "" (Кт)"",
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(Таблица.СуммаОборотКт),
	     |	СУММА(Таблица.СуммаМСФООборотКт),
	     |	СУММА(Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*, (""Прочая деятельность"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто2.Код + "" (Кт)"",
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код + "" (Дт)"",
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборотДт),
	     |	СУММА(-Таблица.СуммаМСФООборотДт),
	     |	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*, (""Прочая деятельность"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто2.Код + "" (Дт)"",
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""05"",
	     |	""Прочая деятельность"",
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |			ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Код + "" (Кт)"",
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборотДт),
	     |	СУММА(-Таблица.СуммаМСФООборотДт),
	     |	СУММА(-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)),
	     |			&ВидыСубконто90,
	     |			&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |				ИЛИ Субконто1.ТипРозничнойТочки = &Проект {(Организация).*, (""Прочая деятельность"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
	     |			    КОГДА Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |			        ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			    ИНАЧЕ Субконто2
	     |			КОНЕЦ).* КАК Статья, (ВЫБОР
	     |			    КОГДА Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |			        ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			    ИНАЧЕ Субконто2
	     |			КОНЕЦ).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫБОР
	     |		КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |			ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |		ИНАЧЕ Таблица.Субконто2
	     |	КОНЕЦ,
	     |	ВЫРАЗИТЬ(ВЫБОР
	     |			КОГДА Таблица.Субконто2 = &СтатьяДР_СебестоимостьОптовыхПродаж
	     |				ТОГДА &СтатьяДР_ВыручкаОптовыхПродаж
	     |			ИНАЧЕ Таблица.Субконто2
	     |		КОНЕЦ КАК Справочник.СтатьиДоходовРасходов).Код + "" (Кт)"",
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КП,
	     |			Авто,
	     |			Счет = &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2 <> &СтатьиДР_АмортизацияИнвестицийВТТ
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Общие расходы"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет = &Счет442,
	     |			&ВидыСубконто44,
	     |			НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_СписаниеИнвестиций)
	     |				И НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_Резервы)
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Общие расходы"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""06"",
	     |	""Общие расходы"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2 = &СтатьиДР_ПодарочныеСертификаты
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Общие расходы"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10"",
	     |	""Инвестиции"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КП,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			(НЕ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_СписаниеИнвестиций, &СтатьиДР_Группа_Резервы)
	     |				ИЛИ Субконто2 = &СтатьиДР_АмортизацияИнвестицийВТТ)
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Инвестиции"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) <= 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10"",
	     |	""Инвестиции"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			(Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_СписаниеИнвестиций)
	     |				ИЛИ Субконто2 В ИЕРАРХИИ (&СтатьиДР_Группа_Резервы))
	     |				И Субконто2 <> &СтатьиДР_ВыбытиеОС
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Инвестиции"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				И КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10.1"",
	     |	""Амортизация ОС"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			Субконто2 <> &СтатьиДР_ВыбытиеОС
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Амортизация ОС"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""10.1"",
	     |	""Амортизация ОС"",
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ИСТИНА
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НачалоПериода,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44),
	     |			&ВидыСубконто44,
	     |			Субконто2 = &СтатьиДР_ВыбытиеОС
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Амортизация ОС"") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
	     |			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
	     |				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
	     |				ИЛИ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции)),
	     |			) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Субконто2.Родитель,
	     |	Таблица.Субконто2.Родитель.Код,
	     |	Таблица.Субконто1,
	     |	Таблица.Субконто1.id_TT,
	     |	Таблица.Субконто2,
	     |	Таблица.Субконто2.Код,
	     |	Таблица.Субконто3,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Основные средства"",
	     |	""121"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""121"",
	     |	""Основные средства"",
	     |	NULL,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборотДт),
	     |	СУММА(-Таблица.СуммаМСФООборотДт),
	     |	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	     |	ЛОЖЬ
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции)), , {(Организация).*, (""Справочная информация"") КАК ГруппаУр1, (""Основные средства"") КАК ГруппаУр2}, , ) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Выручка"",
	     |	""101"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""101_"",
	     |	""Себестоимость использованной упаковки"",
	     |	NULL,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ЛОЖЬ
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , {(Организация).*, (""Справочная информация"") КАК ГруппаУр1, (""Выручка"") КАК ГруппаУр2}, КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.МатералыДляВыпуска), ) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Доставка товаров на склад"",
	     |	""102"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	""102"",
	     |	""Доставка товаров на склад"",
	     |	NULL,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ЛОЖЬ
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(&НачалоПериода, &КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , Субконто3.Код = ""00000023"" {(Организация).*, (""Справочная информация"") КАК ГруппаУр1, (""Доставка товаров на склад"") КАК ГруппаУр2}, , ) КАК Таблица
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))
	     |
	     |ОБЪЕДИНИТЬ ВСЕ
	     |
	     |ВЫБРАТЬ
	     |	Таблица.Организация,
	     |	""12"",
	     |	""Справочная информация"",
	     |	""Налоги"",
	     |	""207"",
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	NULL,
	     |	NULL,
	     |	Таблица.КорСубконто2.Код,
	     |	Таблица.КорСубконто2,
	     |	NULL,
	     |	Таблица.Регистратор,
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000)),
	     |	СУММА(-Таблица.СуммаОборот),
	     |	СУММА(-Таблица.СуммаМСФООборот),
	     |	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	     |	ЛОЖЬ
	     |{ВЫБРАТЬ
	     |	Организация.*,
	     |	Код,
	     |	ГруппаУр1,
	     |	ГруппаУр2.*,
	     |	ГруппаУр2_Код,
	     |	Период,
	     |	МесяцПоРегистратору,
	     |	ОрганизацияПоРегистратору.*,
	     |	Месяц,
	     |	Год,
	     |	ТорговыеТочки.*,
	     |	КодТорговойТочки,
	     |	Статья.*,
	     |	КодСтатьи.*,
	     |	ЦФО.*,
	     |	Регистратор.*,
	     |	РегистраторКомментарий,
	     |	Сумма,
	     |	СуммаКорр,
	     |	СуммаМСФО,
	     |	ПризнакВыручкаВРазрезеМесяца}
	     |ИЗ
	     |	РегистрБухгалтерии.Финансовый.Обороты(
	     |			&НП,
	     |			&КонецПериода,
	     |			Авто,
	     |			Счет В ИЕРАРХИИ (&Счет44)
	     |				И Счет <> &Счет442,
	     |			&ВидыСубконто44,
	     |			Субконто2 = &СтатьиДР_НалогУпр
	     |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
	     |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект) {(Организация).*, (""Справочная информация"") КАК ГруппаУр1, (""Налоги"") КАК ГруппаУр2},
	     |			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.НалогиУН)),
	     |			) КАК Таблица
	     |ГДЕ
	     |	ГОД(Таблица.ПериодМесяц) > 2016
	     |
	     |СГРУППИРОВАТЬ ПО
	     |	Таблица.Организация,
	     |	Таблица.КорСубконто2.Код,
	     |	Таблица.КорСубконто2,
	     |	Таблица.Регистратор,
	     |	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	     |	НАЧАЛОПЕРИОДА(ЕСТЬNULL(Таблица.Регистратор.ДатаВходящегоДокумента, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	     |	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	     |	МЕСЯЦ(Таблица.ПериодМесяц),
	     |	ГОД(Таблица.ПериодМесяц),
	     |	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(1000))";
							  
							  
	//
	ПостроительОтчета = Новый ПостроительЗапроса;
	ПостроительОтчета.Текст = ТЗ;
	ПостроительОтчета.ЗаполнитьНастройки();
	
	//
	ПостроительОтчета.ВыбранныеПоля.Очистить();
	
	
	//Парметры данных
	СтруктураПараметрыДанных = СтруктураПараметров.СтруктураПараметрыДанных;
	Для Каждого ЭлементСтруктуры Из СтруктураПараметрыДанных Цикл
		
		//
		ПостроительОтчета.Параметры.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);
		
	КонецЦикла;	
	
	//
	ПараметрНП = Неопределено;
	Если ПостроительОтчета.Параметры.НачалоПериода > '20170101' Тогда
		ПараметрНП = ПостроительОтчета.Параметры.НачалоПериода;
	Иначе	
		ПараметрНП = '20170101';
	КонецЕсли;	
	
	//
	ПараметрКП = Неопределено;
	Если ПостроительОтчета.Параметры.КонецПериода < '20170101' Тогда
		ПараметрКП = ПостроительОтчета.Параметры.КонецПериода;
	Иначе	
		ПараметрКП = '20161231235959';
	КонецЕсли;
	
	//
	ПостроительОтчета.Параметры.Вставить("НП", ПараметрНП);
	ПостроительОтчета.Параметры.Вставить("КП", ПараметрКП);
	
	//
	ПостроительОтчета.Параметры.Вставить("Счет961", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
	
	//
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ГруппаСебестоимость", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("201"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Корректировки", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20120"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_ВыручкаОптовыхПродаж", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10105"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_СебестоимостьОптовыхПродаж", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20129"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_СебестоимостьПроданногоТовара", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20110"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_НалогУпр", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20742"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ПодарочныеСертификаты", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("21002"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ВыбытиеОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61014"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_АмортизацияИнвестицийВТТ", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_СписаниеИнвестиций", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("6    "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_Резервы", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("213  "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_НалогНаПрибыль", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("207  "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ПеремещениеОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("39131"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ВыручкаОтПродажиОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10110"));
	
	//Отборы
	СтруктураЗначенийРасшифровки = СтруктураПараметров.СтруктураЗначенийРасшифровки;
	Для Каждого ЭлементСтруктуры Из СтруктураЗначенийРасшифровки Цикл
		
		//
		Если Найти(ЭлементСтруктуры.Ключ, "Сумма") > 0 Тогда
			Продолжить;
		КонецЕсли;
		
		//
		Если Найти(ЭлементСтруктуры.Ключ, ".Код") > 0 Тогда
			Продолжить;
		КонецЕсли;	
		
		//
		Попытка
			ЭлементОтбора = ПостроительОтчета.Отбор.Добавить(ЭлементСтруктуры.Ключ);
		Исключение
			Продолжить;
		КонецПопытки;	
		
		//
		Попытка
			ПостроительОтчета.ВыбранныеПоля.Добавить(ЭлементСтруктуры.Ключ);
		Исключение
		КонецПопытки;	
		
		//
		Если ТипЗнч(ЭлементСтруктуры.Значение) = Тип("СписокЗначений") Тогда
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			
		ИначеЕсли ТипЗнч(ЭлементСтруктуры.Значение) = Тип("Массив") Тогда	
			
			//
			СписокЗначений = Новый СписокЗначений;
			СписокЗначений.ЗагрузитьЗначения(ЭлементСтруктуры.Значение);
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = СписокЗначений;
			
		Иначе	
			
			//
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			ЭлементОтбора.ВидСравнения = ВидСравнения.Равно;
			
		КонецЕсли;	
		
		//
		ЭлементОтбора.Использование = Истина;	
		
	КонецЦикла;	
	
	СкопироватьОтборКомпоновщика(ПостроительОтчета.Отбор,СтруктураПараметров.Отбор);
	
	//
	ПостроительОтчета.ВыбранныеПоля.Добавить("Период");
	ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор");
	ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Контрагент", "Контрагент");
	ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Автор", "Автор");
	ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Ответственный", "Ответственный");
	ПостроительОтчета.ВыбранныеПоля.Добавить("РегистраторКомментарий",  "Комментарий");
	
	//
	ИмяРесурса = "Сумма";
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("Сумма") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("Сумма", "Сумма");
		ИмяРесурса = "Сумма";
	КонецЕсли;
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("СуммаКорр") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("СуммаКорр", "Сумма");
		ИмяРесурса = "СуммаКорр";
	КонецЕсли;
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("СуммаМСФО") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("СуммаМСФО", "Сумма");
		ИмяРесурса = "СуммаМСФО";
	КонецЕсли;
		
	//
	Макет = ПолучитьМакет("РасшифровкаПоДокументам_Универсальный");
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	
	//
	ОбластьМакета.Параметры.ДатаНач = Формат(ПостроительОтчета.Параметры.НачалоПериода, "ДФ=dd.MM.yy");
	ОбластьМакета.Параметры.ДатаКон = Формат(ПостроительОтчета.Параметры.КонецПериода, "ДФ=dd.MM.yy");
	
	//
	ОбластьМакета.Параметры.ОтборПредставление = ПостроительОтчета.Отбор;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
	//
	ПостроительОтчета.Выполнить();
	
	//
	СуммаИтого = 0;
	
	//
	Выборка = ПостроительОтчета.Результат.Выбрать();
	Пока Выборка.Следующий() Цикл
		
		//
		ОбработкаПрерыванияПользователя();
		Если НЕ ЗначениеЗаполнено(Выборка[ИмяРесурса]) Тогда
			Продолжить;
		КонецЕсли;	
		
		//
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		ОбластьМакета.Параметры.Заполнить(Выборка);
		
		//
		ОбластьМакета.Параметры.Регистратор = Выборка.Регистратор;
		
		//
		Попытка
			ОбластьМакета.Параметры.Комментарий = Выборка.РегистраторКомментарий;
		Исключение
		КонецПопытки;	
		
		//
		Попытка
			Автор = Выборка.Автор;
		Исключение
		КонецПопытки;
		
		//
		Если НЕ ЗначениеЗаполнено(Автор) Тогда
			
			//
			Попытка
				Автор = Выборка.ОтветственныйПредставление;
			Исключение
			КонецПопытки;
			
		КонецЕсли;	
		
		//
		ОбластьМакета.Параметры.АвторПредставление = Автор;
		
		//
		ОбластьМакета.Параметры.Сумма = Выборка[ИмяРесурса];
		
		//
		СуммаИтого = СуммаИтого + Выборка[ИмяРесурса];
		
		//
		ЭлементыФормы.Результат.Вывести(ОбластьМакета);
		
	КонецЦикла;	
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
	ОбластьМакета.Параметры.Сумма = СуммаИтого;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
КонецПроцедуры

//
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	//
	МассивКонтрагент = Новый Массив;
	МассивАвтор = Новый Массив;
	МассивОтветственный = Новый Массив;
	
	//
	Для Каждого _Документ Из Метаданные.Документы Цикл
		
		//
		_Тип = Тип("ДокументСсылка." + _Документ.Имя);
		
		//
		Если _Документ.Реквизиты.Найти("Контрагент") <> Неопределено Тогда
			МассивКонтрагент.Добавить(_Тип);
		КонецЕсли;	
		
		//
		Если _Документ.Реквизиты.Найти("Автор") <> Неопределено Тогда
			МассивАвтор.Добавить(_Тип);
		КонецЕсли;	
		
		//
		Если _Документ.Реквизиты.Найти("Ответственный") <> Неопределено Тогда
			МассивОтветственный.Добавить(_Тип);	
		КонецЕсли;	
		
	КонецЦикла;	
	
	//
	СтруктураЗначенийРасшифровки = СтруктураПараметров.СтруктураЗначенийРасшифровки;
	
	//
	Режим = "по ДР";
	Если СтруктураЗначенийРасшифровки.Получить("Режим") <> Неопределено Тогда
		Режим = СтруктураЗначенийРасшифровки.Получить("Режим");
	КонецЕсли;	
	                                              
	//
	ТЗ = ПолучитьТекстЗапроса_ОсновнойРежим_ВсеБезИтогов();
	Если Режим = "по ДВ" Тогда
		ТЗ = ПолучитьТекстЗапроса_РежимВходящаяДата_ВсеБезИтогов();
	КонецЕсли;	
	//+++АК sils 31.01.2018 ИП-00017755
	Если Режим <> "по ДВ" Тогда
		ТЗ = СтрЗаменить(ТЗ,
		"ВЫБРАТЬ
		|	""по ДР"" КАК Режим,
		|	ТЗ.Организация,
		|	ТЗ.Код,
		|	ТЗ.ГруппаУр1,
		|	ТЗ.Период,
		|	ТЗ.МесяцПоРегистратору,
		|	ТЗ.ОрганизацияПоРегистратору,
		|	ТЗ.Месяц,
		|	ТЗ.Год,
		|	ТЗ.ТорговыеТочки_ДляСоединения,
		|	ТЗ.Статья_ДляСоединения,
		|	ТЗ.ЦФО,
		|	СУММА(ТЗ.Сумма) КАК Сумма,
		|	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр,
		|	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО,
		|	ТЗ.Регистратор,
		|	ТЗ.РегистраторКомментарий,
		|	ТЗ.ПризнакВыручкаВРазрезеМесяца,
		|	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
		|	ТЗ.ОрганизацияДляГруппировки
		|ИЗ
		|	ТЗ КАК ТЗ",
		
		"ВЫБРАТЬ
		|	""по ДР"" КАК Режим,
		|	ТЗ.Организация,
		|	ТЗ.Код,
		|	ТЗ.ГруппаУр1,
		|	ТЗ.Период,
		|	ТЗ.МесяцПоРегистратору,
		|	ТЗ.ОрганизацияПоРегистратору,
		|	ТЗ.Месяц,
		|	ТЗ.Год,
		|	ТЗ.ТорговыеТочки_ДляСоединения,
		|	ТЗ.Статья_ДляСоединения,
		|	ТЗ.ЦФО,
		|	СУММА(ТЗ.Сумма) КАК Сумма,
		|	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр,
		|	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО,
		|	ТЗ.Регистратор,
		|	ТЗ.РегистраторКомментарий,
		|	ТЗ.ПризнакВыручкаВРазрезеМесяца,
		|	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
		|	ТЗ.ОрганизацияДляГруппировки
		|ПОМЕСТИТЬ ТЗ1
		|ИЗ
		|	ТЗ КАК ТЗ");
		
		ТЗ =ТЗ + ";
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТЗ1.Период,
		|	ТЗ1.Регистратор,
		|	СУММА(ТЗ1.Сумма) КАК Сумма,
		|	СУММА(ТЗ1.СуммаКорр) КАК СуммаКорр,
		|	СУММА(ТЗ1.СуммаМСФО) КАК СуммаМСФО
		|ИЗ
		|	ТЗ КАК ТЗ1
		|
		|СГРУППИРОВАТЬ ПО
		|	ТЗ1.Период,
		|	ТЗ1.Регистратор";
	КонецЕсли;
	//---АК
							  
	//
	ПостроительОтчета = Новый ПостроительЗапроса;
	ПостроительОтчета.Текст = ТЗ;
	ПостроительОтчета.ЗаполнитьНастройки();
	
	//
	ПостроительОтчета.ВыбранныеПоля.Очистить();
	
	
	//Парметры данных
	СтруктураПараметрыДанных = СтруктураПараметров.СтруктураПараметрыДанных;
	Для Каждого ЭлементСтруктуры Из СтруктураПараметрыДанных Цикл
		
		//
		ПостроительОтчета.Параметры.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);
		
	КонецЦикла;	
	
	//
	ПараметрНП = Неопределено;
	Если ПостроительОтчета.Параметры.НачалоПериода > '20170101' Тогда
		ПараметрНП = ПостроительОтчета.Параметры.НачалоПериода;
	Иначе	
		ПараметрНП = '20170101';
	КонецЕсли;	
	
	//
	ПараметрКП = Неопределено;
	Если ПостроительОтчета.Параметры.КонецПериода < '20170101' Тогда
		ПараметрКП = ПостроительОтчета.Параметры.КонецПериода;
	Иначе	
		ПараметрКП = '20161231235959';
	КонецЕсли;
	
	//
	ПостроительОтчета.Параметры.Вставить("НП", ПараметрНП);
	ПостроительОтчета.Параметры.Вставить("КП", ПараметрКП);
	
	//
	ПостроительОтчета.Параметры.Вставить("Счет961", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
	
	//
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ГруппаСебестоимость", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("201"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Корректировки", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20120"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_ВыручкаОптовыхПродаж", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10105"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_СебестоимостьОптовыхПродаж", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20129"));
	ПостроительОтчета.Параметры.Вставить("СтатьяДР_СебестоимостьПроданногоТовара", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20110"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_НалогУпр", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20742"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ПодарочныеСертификаты", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("21002"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ВыбытиеОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61014"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_АмортизацияИнвестицийВТТ", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_СписаниеИнвестиций", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("6    "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_Резервы", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("213  "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_Группа_НалогНаПрибыль", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("207  "));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ПеремещениеОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("39131"));
	ПостроительОтчета.Параметры.Вставить("СтатьиДР_ВыручкаОтПродажиОС", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10110"));
	ПостроительОтчета.Параметры.Вставить("СтатьяТД_ДоставкаТоваров", Справочники.СтатьиТовародвижения.НайтиПоКоду("00000023"));
	ПостроительОтчета.Параметры.Вставить("Организация_ПроектИзбенка", Справочники.Организации.НайтиПоКоду("000000005"));
	
	//
	Счета_44_или_90 = 0;
	Если ПостроительОтчета.Параметры.Свойство("Счета_44_или_90", Счета_44_или_90) Тогда
		//Сообщить(Счета_44_или_90);
		//Когда расшифровываем по Документам, нам нужен всегда 44 счет
		Если Счета_44_или_90 = 1 Тогда
			ПостроительОтчета.Параметры.Вставить("Счета_44_или_90", 0);
		КонецЕсли;	
		
	КонецЕсли;	
	
	
	//Отборы
	Для Каждого ЭлементСтруктуры Из СтруктураЗначенийРасшифровки Цикл
		
		//
		Если Найти(ЭлементСтруктуры.Ключ, "_Отбор") > 0 Тогда
			СкопироватьОтборКомпоновщика(ПостроительОтчета.Отбор, ЭлементСтруктуры.Значение);
			Продолжить;
		КонецЕсли;
		
		//
		Если Найти(ЭлементСтруктуры.Ключ, "Сумма") > 0 Тогда
			Продолжить;
		КонецЕсли;
		
		//
		Если Найти(ЭлементСтруктуры.Ключ, ".Код") > 0 Тогда
			Продолжить;
		КонецЕсли;	
		
		//
		Попытка
			ЭлементОтбора = ПостроительОтчета.Отбор.Добавить(ЭлементСтруктуры.Ключ);
		Исключение
			Продолжить;
		КонецПопытки;	
		
		//
		Попытка
			ПостроительОтчета.ВыбранныеПоля.Добавить(ЭлементСтруктуры.Ключ);
		Исключение	
		КонецПопытки;	
		
		//
		Если ТипЗнч(ЭлементСтруктуры.Значение) = Тип("СписокЗначений") Тогда
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			
		ИначеЕсли ТипЗнч(ЭлементСтруктуры.Значение) = Тип("Массив") Тогда	
			
			//
			СписокЗначений = Новый СписокЗначений;
			СписокЗначений.ЗагрузитьЗначения(ЭлементСтруктуры.Значение);
			
			//
			ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;
			ЭлементОтбора.Значение = СписокЗначений;
			
		Иначе	
			
			//
			ЭлементОтбора.Значение = ЭлементСтруктуры.Значение;
			ЭлементОтбора.ВидСравнения = ВидСравнения.Равно;
			
		КонецЕсли;	
		
		//
		ЭлементОтбора.Использование = Истина;	
		
			
		
	КонецЦикла;	
	
	//
	СкопироватьОтборКомпоновщика(ПостроительОтчета.Отбор, СтруктураПараметров.Отбор);
	
	//
	ЭлементОтбораГруппаУр1 = ПостроительОтчета.Отбор.Найти("ГруппаУр1");
	Если ЭлементОтбораГруппаУр1 <> Неопределено Тогда
		
		//
		Если ЭлементОтбораГруппаУр1.Значение = "Справочная информация" И ЭлементОтбораГруппаУр1.Использование Тогда
			//ЭлементОтбораГруппаУр1.Использование = Ложь;
		Иначе
			
			//выкидываем справочную информацию
			ЭлементОтбора = ПостроительОтчета.Отбор.Добавить("ГруппаУр1");
			ЭлементОтбора.ВидСравнения = ВидСравнения.НеРавно;
			ЭлементОтбора.Значение = "Справочная информация";
			ЭлементОтбора.Использование = Истина;
		
		КонецЕсли;	
		
	Иначе
		
		//выкидываем справочную информацию
		ЭлементОтбора = ПостроительОтчета.Отбор.Добавить("ГруппаУр1");
		ЭлементОтбора.ВидСравнения = ВидСравнения.НеРавно;
		ЭлементОтбора.Значение = "Справочная информация";
		ЭлементОтбора.Использование = Истина;
		
	КонецЕсли;	
	
	//
	ЭлементОтбораГруппаУр2 = ПостроительОтчета.Отбор.Найти("ГруппаУр2");
	Если ЭлементОтбораГруппаУр2 <> Неопределено Тогда
		
		//
		Если ЭлементОтбораГруппаУр2.Значение = "Проект Избенка" И ЭлементОтбораГруппаУр2.Использование Тогда
			
			//
			ЭлементОтбораОрганизация = ПостроительОтчета.Отбор.Найти("Организация");
			Если ЭлементОтбораОрганизация <> Неопределено Тогда
				ЭлементОтбораОрганизация.Использование = Ложь;
			КонецЕсли;	
			
		КонецЕсли;
		
	КонецЕсли;
	
	//
	ПостроительОтчета.ВыбранныеПоля.Очистить(); //???ZEZA
	
	//
	ПостроительОтчета.ВыбранныеПоля.Добавить("Период");
	ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор");
	//ПостроительОтчета.ВыбранныеПоля.Добавить("Статья_ДляСоединения");
	//ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Контрагент", "Контрагент");
	//ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Автор", "Автор");
	//ПостроительОтчета.ВыбранныеПоля.Добавить("Регистратор.Ответственный", "Ответственный");
	//ПостроительОтчета.ВыбранныеПоля.Добавить("РегистраторКомментарий",  "Комментарий");
	
	//
	ИмяРесурса = "Сумма";
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("Сумма") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("Сумма", "Сумма");
		ИмяРесурса = "Сумма";
	КонецЕсли;
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("СуммаКорр") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("СуммаКорр", "Сумма");
		ИмяРесурса = "СуммаКорр";
	КонецЕсли;
	
	//
	Если СтруктураЗначенийРасшифровки.Получить("СуммаМСФО") <> Неопределено Тогда
		ПостроительОтчета.ВыбранныеПоля.Добавить("СуммаМСФО", "Сумма");
		ИмяРесурса = "СуммаМСФО";
	КонецЕсли;
		
	//
	Макет = ПолучитьМакет("РасшифровкаПоДокументам_Универсальный");
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	
	//
	ОбластьМакета.Параметры.ДатаНач = Формат(ПостроительОтчета.Параметры.НачалоПериода, "ДФ=dd.MM.yy");
	ОбластьМакета.Параметры.ДатаКон = Формат(ПостроительОтчета.Параметры.КонецПериода, "ДФ=dd.MM.yy") + ?(ПризнакРежимВходящаяДата, " (по ""Вх. дата"" документа-регистратора)", "");
	
	//
	ОбластьМакета.Параметры.ОтборПредставление = ПостроительОтчета.Отбор;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
	//
	ПостроительОтчета.Выполнить();
	
	//
	СуммаИтого = 0;
	
	//исходный отчет по 44му счету и поэтому расшифровка в шатаном режиме
	Если Счета_44_или_90 = 0 Тогда
	
	
		//
		Выборка = ПостроительОтчета.Результат.Выбрать();
		Пока Выборка.Следующий() Цикл
			
			//
			Если НЕ ЗначениеЗаполнено(Выборка.Регистратор) Тогда
				Продолжить;
			КонецЕсли;	
			
			//
			ОбработкаПрерыванияПользователя();
			Если НЕ ЗначениеЗаполнено(Выборка[ИмяРесурса]) Тогда
				Продолжить;
			КонецЕсли;	
			
			//
			ОбластьМакета = Макет.ПолучитьОбласть("Строка");
			ОбластьМакета.Параметры.Заполнить(Выборка);
			
			//
			Регистратор = Выборка.Регистратор;
			
			//
			Попытка
				ОбластьМакета.Параметры.Комментарий = Регистратор.Комментарий;
			Исключение
			КонецПопытки;	
			
			//
			Если МассивКонтрагент.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
				Контрагент = Регистратор.Контрагент;
			КонецЕсли;
			
			//
			Если МассивОтветственный.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
				Автор = Регистратор.Ответственный;
			КонецЕсли;
			
			//
			Если НЕ ЗначениеЗаполнено(Автор) Тогда
				
				//
				Если МассивАвтор.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
					Автор = Регистратор.Автор;
				КонецЕсли;
				
			КонецЕсли;	
			
			//
			ОбластьМакета.Параметры.Регистратор = Регистратор;
			ОбластьМакета.Параметры.КонтрагентПредставление = Контрагент;
			ОбластьМакета.Параметры.АвторПредставление = Автор;
			
			//
			ОбластьМакета.Параметры.Сумма = Выборка[ИмяРесурса];
			
			//
			СуммаИтого = СуммаИтого + Выборка[ИмяРесурса];
			
			//
			ЭлементыФормы.Результат.Вывести(ОбластьМакета);
			
		КонецЦикла;	
		
	Иначе //исходный отчет строится не по 44, поэтому будем распределять Исходную сумму по базе 44 	
	
		//
		СуммаКРаспределению = 0;
		Попытка
			СуммаКРаспределению = СтруктураЗначенийРасшифровки.Получить(ИмяРесурса);
		Исключение
		КонецПопытки;	
		
		//
		СуммаРаспределено = 0;
		
		//
		ТЗ_Результат = ПостроительОтчета.Результат.Выгрузить();
		
		//
		СуммаБаза = ТЗ_Результат.Итог(ИмяРесурса);
		
		//
		Для Каждого СтрокаТЗ Из ТЗ_Результат Цикл
			
			//
			Если НЕ ЗначениеЗаполнено(СтрокаТЗ.Регистратор) Тогда
				Продолжить;
			КонецЕсли;	
			
			//
			ОбработкаПрерыванияПользователя();
			Если НЕ ЗначениеЗаполнено(СтрокаТЗ[ИмяРесурса]) Тогда
				Продолжить;
			КонецЕсли;	
			
			//
			ОбластьМакета = Макет.ПолучитьОбласть("Строка");
			ОбластьМакета.Параметры.Заполнить(СтрокаТЗ);
			
			//
			Регистратор = СтрокаТЗ.Регистратор;
			
			//
			Попытка
				ОбластьМакета.Параметры.Комментарий = Регистратор.Комментарий;
			Исключение
			КонецПопытки;	
			
			//
			Если МассивКонтрагент.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
				Контрагент = Регистратор.Контрагент;
			КонецЕсли;
			
			//
			Если МассивОтветственный.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
				Автор = Регистратор.Ответственный;
			КонецЕсли;
			
			//
			Если НЕ ЗначениеЗаполнено(Автор) Тогда
				
				//
				Если МассивАвтор.Найти(ТипЗнч(Регистратор)) <> Неопределено Тогда
					Автор = Регистратор.Автор;
				КонецЕсли;
				
			КонецЕсли;	
			
			//
			ОбластьМакета.Параметры.Регистратор = Регистратор;
			ОбластьМакета.Параметры.КонтрагентПредставление = Контрагент;
			ОбластьМакета.Параметры.АвторПредставление = Автор;
			
			//
			_Сумма44 = СтрокаТЗ[ИмяРесурса];
			
			//
			_Сумма = Окр(СуммаКРаспределению * _Сумма44/СуммаБаза, 2);
			СуммаРаспределено = СуммаРаспределено + _Сумма;
			
			//
			Если ТЗ_Результат.Индекс(СтрокаТЗ) = ТЗ_Результат.Количество() - 1 Тогда
				_Сумма = _Сумма + (СуммаКРаспределению - СуммаРаспределено); 
			КонецЕсли;	
			
			//
			ОбластьМакета.Параметры.Сумма = _Сумма;
			
			//
			СуммаИтого = СуммаИтого + _Сумма;
			
			//
			ЭлементыФормы.Результат.Вывести(ОбластьМакета);
			
		КонецЦикла;	
		
	КонецЕсли;	
	
	//
	ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
	ОбластьМакета.Параметры.Сумма = СуммаИтого;
	
	//
	ЭлементыФормы.Результат.Вывести(ОбластьМакета);
	
КонецПроцедуры




Процедура СкопироватьОтборКомпоновщика(ОтборПриемник,ОтборИсточник)
	
	Для каждого Элемент из ОтборИсточник.Элементы Цикл
		
		//
		Если не Элемент.Использование Тогда 
			Продолжить;
		КонецЕсли;
		
		//
		Если ТипЗнч(Элемент) = Тип("ЭлементОтбораКомпоновкиДанных") Тогда
			
			Попытка
				НовыйЭлемент = ОтборПриемник.Добавить(Элемент.ЛевоеЗначение);
				ЗаполнитьОтборПоОтборуКомпоновщика(НовыйЭлемент,Элемент);
			Исключение
			Конецпопытки;	
			
		ИначеЕсли ТипЗнч(Элемент) = Тип("ГруппаЭлементовОтбораКомпоновкиДанных") Тогда
			
			//
			Попытка
			
				//
				НовыйЭлемент = ОтборПриемник.Добавить(Тип("ГруппаЭлементовОтбораКомпоновкиДанных"));
				ЗаполнитьЗначенияСвойств(НовыйЭлемент,Элемент);
				
				//
				СкопироватьОтборКомпоновщика(НовыйЭлемент, Элемент.Элементы);
				
			Исключение
			КонецПопытки;	
			
		КонецЕсли;	
			
	КонецЦикла;	
	
КонецПроцедуры	

Процедура ЗаполнитьОтборПоОтборуКомпоновщика(Отбор, ОтборКомпоновщика) Экспорт
    
    ЗаполнитьЗначенияСвойств(Отбор, ОтборКомпоновщика, "Использование, Представление");
    
    Если ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.Больше Тогда
        Отбор.ВидСравнения = ВидСравнения.Больше;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.БольшеИлиРавно Тогда
        Отбор.ВидСравнения = ВидСравнения.БольшеИлиРавно;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии Тогда
        Отбор.ВидСравнения = ВидСравнения.ВИерархии;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке Тогда
        Отбор.ВидСравнения = ВидСравнения.ВСписке;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии Тогда
        Отбор.ВидСравнения = ВидСравнения.ВСпискеПоИерархии;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.Меньше Тогда
        Отбор.ВидСравнения = ВидСравнения.Меньше;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.МеньшеИлиРавно Тогда
        Отбор.ВидСравнения = ВидСравнения.МеньшеИлиРавно;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВИерархии Тогда
        Отбор.ВидСравнения = ВидСравнения.НеВИерархии;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСписке Тогда
        Отбор.ВидСравнения = ВидСравнения.НеВСписке;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСпискеПоИерархии Тогда
        Отбор.ВидСравнения = ВидСравнения.НеВСпискеПоИерархии;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.НеРавно Тогда
        Отбор.ВидСравнения = ВидСравнения.НеРавно;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.НеСодержит Тогда
        Отбор.ВидСравнения = ВидСравнения.НеСодержит;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно Тогда
        Отбор.ВидСравнения = ВидСравнения.Равно;
    ИначеЕсли ОтборКомпоновщика.ВидСравнения = ВидСравненияКомпоновкиДанных.Содержит Тогда
        Отбор.ВидСравнения = ВидСравнения.Содержит;
    Иначе
        // Не нашли соответствие - не применяем отбор

 
        Отбор.Использование = Ложь;
        Возврат;
    КонецЕсли;
    
    Отбор.Значение = ОтборКомпоновщика.ПравоеЗначение;
    
КонецПроцедуры