<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetUnion">
		<name>Объединение</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Счет</dataPath>
			<field>Счет</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСчет</dataPath>
			<field>КорСчет</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто1</dataPath>
			<field>КорСубконто1</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто2</dataPath>
			<field>КорСубконто2</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто3</dataPath>
			<field>КорСубконто3</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто1</dataPath>
			<field>Субконто1</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто2</dataPath>
			<field>Субконто2</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто3</dataPath>
			<field>Субконто3</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Период</dataPath>
			<field>Период</field>
			<role>
				<dcscom:periodNumber>1</dcscom:periodNumber>
				<dcscom:periodType>Main</dcscom:periodType>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Год</dataPath>
			<field>Год</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧРГ=; ЧГ=</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГруппаУр1</dataPath>
			<field>ГруппаУр1</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Раздел</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
			<orderExpression>
				<dcscom:expression>ГруппаУр1.Код</dcscom:expression>
				<dcscom:orderType>Asc</dcscom:orderType>
				<dcscom:autoOrder>false</dcscom:autoOrder>
			</orderExpression>
			<valueType>
				<v8:Type>xs:string</v8:Type>
				<v8:StringQualifiers>
					<v8:Length>30</v8:Length>
					<v8:AllowedLength>Variable</v8:AllowedLength>
				</v8:StringQualifiers>
			</valueType>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Месяц</dataPath>
			<field>Месяц</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>МесяцПоРегистратору</dataPath>
			<field>МесяцПоРегистратору</field>
			<orderExpression>
				<dcscom:expression>МесяцПоРегистратору</dcscom:expression>
				<dcscom:orderType>Asc</dcscom:orderType>
				<dcscom:autoOrder>false</dcscom:autoOrder>
			</orderExpression>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ДФ=MM.yyyy</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОрганизацияПоРегистратору</dataPath>
			<field>ОрганизацияПоРегистратору</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=0</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаКорр</dataPath>
			<field>СуммаКорр</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма (Корр)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=0</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаМСФО</dataPath>
			<field>СуммаМСФО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма (МСФО)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=0</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦФО</dataPath>
			<field>ЦФО</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручкаВРазрезеМесяца</dataPath>
			<field>ПризнакВыручкаВРазрезеМесяца</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
			<field>ТорговыеТочки_ДляСоединения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Торговые точки для соединения</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья_ДляСоединения</dataPath>
			<field>Статья_ДляСоединения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья для соединения</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГруппаУр2</dataPath>
			<field>ГруппаУр2</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Группа статей</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТорговыеТочки</dataPath>
			<field>ТорговыеТочки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Торговые точки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья</dataPath>
			<field>Статья</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Регистратор</dataPath>
			<field>Регистратор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РегистраторКомментарий</dataPath>
			<field>РегистраторКомментарий</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Регистратор комментарий</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Режим</dataPath>
			<field>Режим</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Режим</v8:content>
				</v8:item>
			</title>
			<valueType>
				<v8:Type>xs:string</v8:Type>
				<v8:StringQualifiers>
					<v8:Length>10</v8:Length>
					<v8:AllowedLength>Variable</v8:AllowedLength>
				</v8:StringQualifiers>
			</valueType>
			<availableValue>
				<value xsi:type="xs:string">по ДР</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>по Дате регистрации</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">по ДВ</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>по Дате входящей</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Признак_ГодДВ_Меньше_ГодаДР</dataPath>
			<field>Признак_ГодДВ_Меньше_ГодаДР</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак "Год ДВ" &lt; "Года ДР"</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОрганизацияДляГруппировки</dataPath>
			<field>ОрганизацияДляГруппировки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация (для группировки)</v8:content>
				</v8:item>
			</title>
			<attributeUseRestriction>
				<field>true</field>
			</attributeUseRestriction>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГруппаУр1.Код</dataPath>
			<field>Код</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код</v8:content>
				</v8:item>
			</title>
			<valueType>
				<v8:Type>xs:string</v8:Type>
				<v8:StringQualifiers>
					<v8:Length>0</v8:Length>
					<v8:AllowedLength>Variable</v8:AllowedLength>
				</v8:StringQualifiers>
			</valueType>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦФО_ТТ_НаКонецПериода</dataPath>
			<field>ЦФО_ТТ_НаКонецПериода</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ЦФО ТТ (на Конец периода)</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Раздел</dataPath>
			<field>Раздел</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Раздел</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма_КА</dataPath>
			<field>Сумма_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма (КА)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаКорр_КА</dataPath>
			<field>СуммаКорр_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма (Корр) (КА)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаМСФО_КА</dataPath>
			<field>СуммаМСФО_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма (МСФО) (КА)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Код</dataPath>
			<field>Код</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_ПроцентМСФО</dataPath>
			<field>_ПроцентМСФО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент МСФО</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_ПроцентКорр</dataPath>
			<field>_ПроцентКорр</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент корр</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_Процент</dataPath>
			<field>_Процент</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВаловаяПрибыль</dataPath>
			<field>ПризнакВаловаяПрибыль</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак валовая прибыль</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручка</dataPath>
			<field>ПризнакВыручка</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак выручка</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручкаВРазрезеМесяца_МСФО</dataPath>
			<field>ПризнакВыручкаВРазрезеМесяца_МСФО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак выручка в разрезе месяца МСФО</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручкаВРазрезеМесяца_КА</dataPath>
			<field>ПризнакВыручкаВРазрезеМесяца_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак выручка в разрезе месяца КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_ПроцентКорр_КА</dataPath>
			<field>_ПроцентКорр_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент корр КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_ПроцентМСФО_КА</dataPath>
			<field>_ПроцентМСФО_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент МСФО КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>_Процент_КА</dataPath>
			<field>_Процент_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Валюта</dataPath>
			<field>Валюта</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВалютаКор</dataPath>
			<field>ВалютаКор</field>
		</field>
		<item xsi:type="DataSetQuery">
			<name>По_ДатеРегистратора</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО</dataPath>
				<field>СуммаМСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр</dataPath>
				<field>СуммаКорр</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручкаВРазрезеМесяца</dataPath>
				<field>ПризнакВыручкаВРазрезеМесяца</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка в разрезе месяца</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Период</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>2</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Режим</dataPath>
				<field>Режим</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Режим</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО</dataPath>
				<field>ЦФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО_ТТ_НаКонецПериода</dataPath>
				<field>ЦФО_ТТ_НаКонецПериода</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО т т на конец периода</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Признак_ГодДВ_Меньше_ГодаДР</dataPath>
				<field>Признак_ГодДВ_Меньше_ГодаДР</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак год д в меньше года ДР</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияПоРегистратору</dataPath>
				<field>ОрганизацияПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма_КА</dataPath>
				<field>Сумма_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр1</dataPath>
				<field>ГруппаУр1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур1</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр2</dataPath>
				<field>ГруппаУр2</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур2</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Регистратор</dataPath>
				<field>Регистратор</field>
				<role>
					<dcscom:periodNumber>1</dcscom:periodNumber>
					<dcscom:periodType>Main</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки</dataPath>
				<field>ТорговыеТочки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>МесяцПоРегистратору</dataPath>
				<field>МесяцПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>3</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
				<field>ТорговыеТочки_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр_КА</dataPath>
				<field>СуммаКорр_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО_КА</dataPath>
				<field>СуммаМСФО_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>4</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РегистраторКомментарий</dataPath>
				<field>РегистраторКомментарий</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Регистратор комментарий</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья</dataPath>
				<field>Статья</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья_ДляСоединения</dataPath>
				<field>Статья_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияДляГруппировки</dataPath>
				<field>ОрганизацияДляГруппировки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация для группировки</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Год</dataPath>
				<field>Год</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Год</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>5</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка,
	Таблица.Код
ПОМЕСТИТЬ ТЗ_Счета01
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции))
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_БезОбщих
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет90)
	И Таблица.Ссылка &lt;&gt; &amp;Счет902
	И Таблица.Ссылка &lt;&gt; &amp;Счет961
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_Общие
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет442
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет902
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета68
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ЛОЖЬ
			ИНАЧЕ ИСТИНА
		КОНЕЦ
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиПостоянныхЗатрат
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;ЗатратыПостоянные, &amp;УЕК)
	И НЕ Таблица.ЭтоГруппа
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиСписаниеИнвестицийИРезервы
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;СтатьиДР_Группа_СписаниеИнвестиций, &amp;СтатьиДР_Группа_Резервы)
	И НЕ Таблица.ЭтоГруппа
	И НЕ &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка
ПОМЕСТИТЬ ТЗ_СчетаОНАОПУ
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Код ПОДОБНО "99%"
	И НЕ &amp;ПризнакМСФО
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Организация КАК Организация,
	"01" КАК Код,
	"Выручка" КАК ГруппаУр1,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК Период,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) КАК МесяцПоРегистратору,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ОрганизацияПоРегистратору,
	МЕСЯЦ(Таблица.ПериодМесяц) КАК Месяц,
	ГОД(Таблица.ПериодМесяц) КАК Год,
	Таблица.Субконто1 КАК ТорговыеТочки_ДляСоединения,
	Таблица.Субконто2 КАК Статья_ДляСоединения,
	Таблица.Субконто3 КАК ЦФО,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	Таблица.Регистратор КАК Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)) КАК РегистраторКомментарий,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборот
		КОНЕЦ) КАК Сумма,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборот
		КОНЕЦ) КАК СуммаКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ) КАК СуммаМСФО,
	ИСТИНА КАК ПризнакЭффективность,
	ИСТИНА КАК ПризнакПрибыль,
	ИСТИНА КАК ПризнакЧистаяПрибыль,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Признак_ГодДВ_Меньше_ГодаДР,
	Таблица.Организация КАК ОрганизацияДляГруппировки,
	Таблица.Счет
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("01") КАК Код, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборотДт
			ИНАЧЕ -Таблица.СуммаОборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборотДт
			ИНАЧЕ -Таблица.СуммаМСФООборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиПостоянныхЗатрат КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_БонусыПокупателям
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_ПодарочныеСертификаты)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА Субконто2.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			        ТОГДА &amp;СтатьиДР_НалогУпр
			    ИНАЧЕ Субконто2
			КОНЕЦ) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	&amp;СтатьиДР_НалогУпр,
	NULL,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборот),
	СУММА(Таблица.СуммаМСФООборот),
	СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаОНАОПУ КАК Таблица),
			,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (&amp;СтатьиДР_НалогУпр) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_НалогУпр КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_Корректировки) КАК Статья, (&amp;СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиПостоянныхЗатрат КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И ЛОЖЬ
				И Субконто2 = &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_ПеремещениеОС) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
				КОГДА &amp;Счета_44_или_90 = 1
					ТОГДА КорСчет &lt;&gt; &amp;Счет442
				ИНАЧЕ ИСТИНА
			КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборотКт),
	СУММА(Таблица.СуммаМСФООборотКт),
	СУММА(Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).* КАК Статья, ((ВЫБОР
			    КОГДА Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица)
				И НЕ КорСчет В
						(ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&amp;КП)},
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_АмортизацияИнвестицийВТТ
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &lt;= 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"01",
	"Выручка",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	-СУММА(Таблица.СуммаОборот),
	-СУММА(Таблица.СуммаМСФООборот),
	-СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_ПодарочныеСертификаты
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("01") КАК Код, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&amp;КП)},
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_БезОбщих.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_АмортизацияИнвестицийВТТ
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ)
				И НЕ ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА КорСчет &lt;&gt; &amp;Счет442
						ИНАЧЕ ИСТИНА
					КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &lt;= 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_БезОбщих.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И НЕ ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА КорСчет &lt;&gt; &amp;Счет442
						ИНАЧЕ ИСТИНА
					КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10",
	"Инвестиции",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10") КАК Код, ("Инвестиции") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10.1") КАК Код, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет = &amp;Счет445
					ИНАЧЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
							ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
							ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
				КОНЕЦ
				И НЕ КорСчет В
						(ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10.1") КАК Код, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета01 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет445
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ИСТИНА
					КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Основные средства",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета01.Ссылка
				ИЗ
					ТЗ_Счета01
				ГДЕ
					ТЗ_Счета01.Код &lt;&gt; "01.9"),
			,
			НЕ &amp;ПризнакМСФО {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Основные средства") КАК ГруппаУр2, ("Основные средства") КАК Статья},
			,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Себестоимость использованной упаковки",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(&amp;НачалоПериода, &amp;КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , НЕ &amp;ПризнакМСФО {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Выручка") КАК ГруппаУр2, ("Себестоимость использованной упаковки") КАК Статья}, КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.МатералыДляВыпуска), ) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Доставка товаров на склад",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары),
			,
			НЕ &amp;ПризнакМСФО
				И Субконто3 = &amp;СтатьяТД_ДоставкаТоваров {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Доставка товаров на склад") КАК ГруппаУр2, ("Доставка товаров на склад") КАК Статья},
			,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	Таблица.КорСубконто2,
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ (&amp;Счет44),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_НалогУпр
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, (КорСубконто2) КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.НалогиУН),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.КорСубконто2,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	Таблица.ПериодМесяц,
	Таблица.Организация,
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"НДС не принятый к зачету",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаКонечныйОстаток),
	СУММА(-Таблица.СуммаМСФОКонечныйОстаток),
	СУММА(-(Таблица.СуммаКонечныйОстаток + Таблица.СуммаМСФОКонечныйОстаток)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.ОстаткиИОбороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			,
			НЕ &amp;ПризнакМСФО
				И ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНДС),
			,
			{(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, ("НДС не принятый к зачету") КАК Статья}) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.ПериодМесяц,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Убыток прошлых периодов",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт)),
	СУММА(-(Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт)),
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт + (Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт))),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			НЕ &amp;ПризнакМСФО
				И ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев),
			,
			{(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Убыток прошлых периодов") КАК ГруппаУр2, ("Убыток прошлых периодов") КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Проект Избенка",
	NULL,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета90.Ссылка
				ИЗ
					ТЗ_Счета90),
			,
			НЕ &amp;ПризнакМСФО
				И Организация = &amp;Организация_ПроектИзбенка {("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Проект Избёнка") КАК Организация},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	"ОПУ_НалогНаПрибыль",
	Таблица.Субконто3,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыТочекДляРаспределения)),
			&amp;ВидыСубконто44,
			НЕ &amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_НалогУпр
				И (КорСубконто2.Код = "000000002"
					ИЛИ КорСубконто2.Код = "000000003")
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, ("ОПУ_НалогНаПрибыль") КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"12",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫБОР
		КОГДА Таблица.Счет.Код = "99.1"
			ТОГДА "ОПУ_ОНА"
		КОГДА Таблица.Счет.Код = "99.2"
			ТОГДА "ОПУ_ОНО"
	КОНЕЦ,
	Таблица.Субконто3,
	ЛОЖЬ,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборот),
	СУММА(Таблица.СуммаМСФООборот),
	СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаОНАОПУ КАК Таблица),
			,
			НЕ &amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("12") КАК Код, ("Справочная информация") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_НалогУпр) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Счет.Код = "99.1"
			ТОГДА "ОПУ_ОНА"
		КОГДА Таблица.Счет.Код = "99.2"
			ТОГДА "ОПУ_ОНО"
	КОНЕЦ,
	Таблица.Организация
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	"по ДР" КАК Режим,
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.Счет КАК Счет,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	СУММА(ТЗ.Сумма) КАК Сумма,
	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр,
	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	0 КАК Сумма_КА,
	0 КАК СуммаКорр_КА,
	0 КАК СуммаМСФО_КА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
{ГДЕ
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"04",
	ТЗ.Счет,
	"Эффективность",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЭффективность = ИСТИНА
{ГДЕ
	("04") КАК Код,
	("Эффективность") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"09",
	ТЗ.Счет,
	"Итого прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыль = ИСТИНА
{ГДЕ
	("09") КАК Код,
	("Итого прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11",
	ТЗ.Счет,
	"Чистая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("11") КАК Код,
	("Чистая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет</query>
		</item>
		<item xsi:type="DataSetQuery">
			<name>По_ДатеВходящей</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО</dataPath>
				<field>ЦФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияПоРегистратору</dataPath>
				<field>ОрганизацияПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручкаВРазрезеМесяца</dataPath>
				<field>ПризнакВыручкаВРазрезеМесяца</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка в разрезе месяца</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр</dataPath>
				<field>СуммаКорр</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр1</dataPath>
				<field>ГруппаУр1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур1</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>30</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр2</dataPath>
				<field>ГруппаУр2</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур2</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Регистратор</dataPath>
				<field>Регистратор</field>
				<role>
					<dcscom:periodNumber>1</dcscom:periodNumber>
					<dcscom:periodType>Main</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Режим</dataPath>
				<field>Режим</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Режим</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки</dataPath>
				<field>ТорговыеТочки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>МесяцПоРегистратору</dataPath>
				<field>МесяцПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц по регистратору</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
				<field>ТорговыеТочки_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Период</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья</dataPath>
				<field>Статья</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья_ДляСоединения</dataPath>
				<field>Статья_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО</dataPath>
				<field>СуммаМСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Год</dataPath>
				<field>Год</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Год</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияДляГруппировки</dataPath>
				<field>ОрганизацияДляГруппировки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация для группировки</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО_ТТ_НаКонецПериода</dataPath>
				<field>ЦФО_ТТ_НаКонецПериода</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО т т на конец периода</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма_КА</dataPath>
				<field>Сумма_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр_КА</dataPath>
				<field>СуммаКорр_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО_КА</dataPath>
				<field>СуммаМСФО_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка,
	Таблица.Код
ПОМЕСТИТЬ ТЗ_Счета01
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции))
{ГДЕ
	("по ДВ") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета44_Без442
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
{ГДЕ
	("по ДВ") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета68
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
{ГДЕ
	("по ДВ") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
{ГДЕ
	("по ДВ") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиПостоянныхЗатрат
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;ЗатратыПостоянные, &amp;УЕК)
	И НЕ Таблица.ЭтоГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиСписаниеИнвестицийИРезервы
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;СтатьиДР_Группа_СписаниеИнвестиций, &amp;СтатьиДР_Группа_Резервы)
	И НЕ Таблица.ЭтоГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ) КАК Период,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ) КАК МесяцПоРегистратору,
	Таблица.Организация КАК Организация,
	"01" КАК Код,
	"Выручка" КАК ГруппаУр1,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ОрганизацияПоРегистратору,
	Таблица.Субконто1 КАК ТорговыеТочки_ДляСоединения,
	Таблица.Субконто2 КАК Статья_ДляСоединения,
	Таблица.Субконто3 КАК ЦФО,
	Таблица.Регистратор КАК Регистратор,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт
		КОНЕЦ) КАК Сумма,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаМСФО,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	ИСТИНА КАК ПризнакЭффективность,
	ИСТИНА КАК ПризнакПрибыль,
	ИСТИНА КАК ПризнакЧистаяПрибыль,
	Таблица.Организация КАК ОрганизацияДляГруппировки
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
			&amp;ВидыСубконто90,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"02",
	"Переменные затраты",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&amp;КП)},
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица),
			&amp;ВидыСубконто44,
			НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиПостоянныхЗатрат КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_АмортизацияИнвестицийВТТ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_ПодарочныеСертификаты)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &lt;= 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"02",
	"Переменные затраты",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборотДт
			ИНАЧЕ -Таблица.СуммаОборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборотДт
			ИНАЧЕ -Таблица.СуммаМСФООборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
			&amp;ВидыСубконто44,
			НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиПостоянныхЗатрат КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_ПодарочныеСертификаты)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА Субконто2.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			        ТОГДА &amp;СтатьиДР_НалогУпр
			    ИНАЧЕ Субконто2
			КОНЕЦ) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"02",
	"Переменные затраты",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			Субконто2 &lt;&gt; &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_Корректировки) КАК Статья, (&amp;СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица),
			&amp;ВидыСубконто44,
			Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиПостоянныхЗатрат КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			Субконто2 = &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_ПеремещениеОС) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			,
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(Таблица.СуммаОборотКт),
	СУММА(Таблица.СуммаМСФООборотКт),
	СУММА(Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).* КАК Статья, ((ВЫБОР
			    КОГДА Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"06",
	"Общие расходы",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&amp;КП)},
			Авто,
			Счет = &amp;Счет442,
			&amp;ВидыСубконто44,
			Субконто2 &lt;&gt; &amp;СтатьиДР_АмортизацияИнвестицийВТТ
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &lt;= 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"06",
	"Общие расходы",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет = &amp;Счет442,
			&amp;ВидыСубконто44,
			НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"06",
	"Общие расходы",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица),
			&amp;ВидыСубконто44,
			Субконто2 = &amp;СтатьиДР_ПодарочныеСертификаты
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"10",
	"Инвестиции",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(2017, 1, 1), СЕКУНДА, -1) {(&amp;КП)},
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет442),
			&amp;ВидыСубконто44,
			(НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				ИЛИ Субконто2 = &amp;СтатьиДР_АмортизацияИнвестицийВТТ)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Инвестиции") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &lt;= 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"10",
	"Инвестиции",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет442),
			&amp;ВидыСубконто44,
			Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Инвестиции") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет442),
			&amp;ВидыСубконто44,
			Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
				ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет442),
			&amp;ВидыСубконто44,
			Субконто2 = &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета01 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	"Основные средства",
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета01.Ссылка
				ИЗ
					ТЗ_Счета01
				ГДЕ
					ТЗ_Счета01.Код &lt;&gt; "01.9"),
			,
			{(Организация).*, ("Справочная информация") КАК ГруппаУр1, ("Основные средства") КАК ГруппаУр2, ("Основные средства") КАК Статья},
			,
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	"Себестоимость использованной упаковки",
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары),
			,
			{(Организация).*, ("Справочная информация") КАК ГруппаУр1, ("Выручка") КАК ГруппаУр2, ("Себестоимость использованной упаковки") КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.МатералыДляВыпуска),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	"Доставка товаров на склад",
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары),
			,
			Субконто3 = &amp;СтатьяТД_ДоставкаТоваров {(Организация).*, ("Справочная информация") КАК ГруппаУр1, ("Доставка товаров на склад") КАК ГруппаУр2, ("Доставка товаров на склад") КАК Статья},
			,
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	Таблица.КорСубконто2,
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета44_Без442 КАК Таблица),
			&amp;ВидыСубконто44,
			Субконто2 = &amp;СтатьиДР_НалогУпр
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, (КорСубконто2) КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.НалогиУН),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
	И ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.КорСубконто2,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	Таблица.Организация,
	NULL,
	"НДС не принятый к зачету",
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаКонечныйОстаток),
	СУММА(-Таблица.СуммаМСФОКонечныйОстаток),
	СУММА(-(Таблица.СуммаКонечныйОстаток + Таблица.СуммаМСФОКонечныйОстаток)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.ОстаткиИОбороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНДС),
			,
			{(Организация).*, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, ("НДС не принятый к зачету") КАК Статья}) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	"Убыток прошлых периодов",
	NULL,
	Таблица.Регистратор,
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт)),
	СУММА(-(Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт)),
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт + (Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт))),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев),
			,
			{(Организация).*, ("Справочная информация") КАК ГруппаУр1, ("Убыток прошлых периодов") КАК ГруппаУр2, ("Убыток прошлых периодов") КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	"12",
	"Справочная информация",
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	NULL,
	"Проект Избенка",
	NULL,
	Таблица.Регистратор,
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	ЛОЖЬ,
	Таблица.Организация
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			КОНЕЦПЕРИОДА(&amp;КонецПериода, ГОД),
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета90.Ссылка
				ИЗ
					ТЗ_Счета90),
			,
			Организация = &amp;Организация_ПроектИзбенка {("Проект Избёнка") КАК Организация},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК Период,
	(ГОД(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Год,
	(МЕСЯЦ(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)))) КАК Месяц,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА Таблица.ПериодМесяц
					ИНАЧЕ ЕСТЬNULL(ВЫБОР
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
								КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
									ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
							КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
				КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	Таблица.Регистратор КАК Регистратор}

СГРУППИРОВАТЬ ПО
	Таблица.Регистратор,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ),
	Таблица.Организация,
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)) = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Таблица.ПериодМесяц
				ИНАЧЕ ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1))
			КОНЕЦ, ДАТАВРЕМЯ(1, 1, 1)), МЕСЯЦ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	"по ДВ" КАК Режим,
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период) КАК Месяц,
	ГОД(ТЗ.Период) КАК Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	СУММА(ТЗ.Сумма) КАК Сумма,
	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр,
	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО,
	ТЗ.Регистратор,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.ОрганизацияДляГруппировки,
	0 КАК Сумма_КА,
	0 КАК СуммаКорр_КА,
	0 КАК СуммаМСФО_КА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
{ГДЕ
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	ТЗ.Регистратор,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.ОрганизацияДляГруппировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДВ",
	ТЗ.Организация,
	"04",
	"Эффективность",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ИСТИНА,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЭффективность = ИСТИНА
{ГДЕ
	("04") КАК Код,
	("Эффективность") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.ОрганизацияДляГруппировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДВ",
	ТЗ.Организация,
	"09",
	"Итого прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ИСТИНА,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыль = ИСТИНА
{ГДЕ
	("09") КАК Код,
	("Итого прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.ОрганизацияДляГруппировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДВ",
	ТЗ.Организация,
	"19",
	"Чистая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ИСТИНА,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("11") КАК Код,
	("Чистая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.ОрганизацияДляГруппировки</query>
		</item>
		<item xsi:type="DataSetQuery">
			<name>По_ДатеРегистратора_КА</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>МесяцПоРегистратору</dataPath>
				<field>МесяцПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>3</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияПоРегистратору</dataPath>
				<field>ОрганизацияПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация по регистратору</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>0</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО</dataPath>
				<field>ЦФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
				<field>ТорговыеТочки_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Год</dataPath>
				<field>Год</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Год</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>5</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>4</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр1</dataPath>
				<field>ГруппаУр1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур1</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>30</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья_ДляСоединения</dataPath>
				<field>Статья_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Период</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>2</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр2</dataPath>
				<field>ГруппаУр2</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур2</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки</dataPath>
				<field>ТорговыеТочки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья</dataPath>
				<field>Статья</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Регистратор</dataPath>
				<field>Регистратор</field>
				<role>
					<dcscom:periodNumber>1</dcscom:periodNumber>
					<dcscom:periodType>Main</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РегистраторКомментарий</dataPath>
				<field>РегистраторКомментарий</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Регистратор комментарий</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Режим</dataPath>
				<field>Режим</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Режим</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Признак_ГодДВ_Меньше_ГодаДР</dataPath>
				<field>Признак_ГодДВ_Меньше_ГодаДР</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак год д в меньше года ДР</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияДляГруппировки</dataPath>
				<field>ОрганизацияДляГруппировки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация для группировки</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО_ТТ_НаКонецПериода</dataPath>
				<field>ЦФО_ТТ_НаКонецПериода</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО т т на конец периода</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Раздел</dataPath>
				<field>Раздел</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Раздел</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма_КА</dataPath>
				<field>Сумма_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр_КА</dataPath>
				<field>СуммаКорр_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО_КА</dataPath>
				<field>СуммаМСФО_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручка</dataPath>
				<field>ПризнакВыручка</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручкаВРазрезеМесяца_КА</dataPath>
				<field>ПризнакВыручкаВРазрезеМесяца_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка в разрезе месяца КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_ПроцентКорр_КА</dataPath>
				<field>_ПроцентКорр_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент корр КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_ПроцентМСФО_КА</dataPath>
				<field>_ПроцентМСФО_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент МСФО КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_Процент_КА</dataPath>
				<field>_Процент_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручкаВРазрезеМесяца_МСФО</dataPath>
				<field>ПризнакВыручкаВРазрезеМесяца_МСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка в разрезе месяца МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка,
	Таблица.Код
ПОМЕСТИТЬ ТЗ_Счета01
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции))
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_БезОбщих
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И ЛОЖЬ
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет90)
	И Таблица.Ссылка &lt;&gt; &amp;Счет902
	И Таблица.Ссылка &lt;&gt; &amp;Счет961
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И (ВЫБОР
				КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
					ТОГДА ИСТИНА
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ
			ИЛИ ИСТИНА)
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_Общие
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет442
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И ЛОЖЬ
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет902
	И (ВЫБОР
				КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
					ТОГДА ИСТИНА
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ
			ИЛИ ИСТИНА)
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета68
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиПостоянныхЗатрат
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;ЗатратыПостоянные, &amp;УЕК)
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиСписаниеИнвестицийИРезервы
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;СтатьиДР_Группа_СписаниеИнвестиций, &amp;СтатьиДР_Группа_Резервы)
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиИнвестиционные
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;СтатьиДР_Группа_СписаниеИнвестиций)
	И Таблица.Ссылка &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Организация КАК Организация,
	"01" КАК Код,
	"Выручка" КАК ГруппаУр1,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК Период,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) КАК МесяцПоРегистратору,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ОрганизацияПоРегистратору,
	МЕСЯЦ(Таблица.ПериодМесяц) КАК Месяц,
	ГОД(Таблица.ПериодМесяц) КАК Год,
	Таблица.Субконто1 КАК ТорговыеТочки_ДляСоединения,
	Таблица.Субконто2 КАК Статья_ДляСоединения,
	Таблица.Субконто3 КАК ЦФО,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	Таблица.Регистратор КАК Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)) КАК РегистраторКомментарий,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт
		КОНЕЦ) КАК Сумма,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаМСФО,
	ИСТИНА КАК ПризнакЭффективность,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Признак_ГодДВ_Меньше_ГодаДР,
	Таблица.Организация КАК ОрганизацияДляГруппировки,
	Таблица.Счет,
	ИСТИНА КАК ПризнакВаловаяПрибыль,
	ИСТИНА КАК ПризнакВыручка,
	ИСТИНА КАК ПризнакПрибыль,
	ЛОЖЬ КАК ПризнакНалогНаПрибыль,
	ЛОЖЬ КАК ПризнакОсновныеСредства,
	ИСТИНА КАК ПризнакПрибыльДоНалогообложения,
	ИСТИНА КАК ПризнакЧистаяПрибыль,
	ИСТИНА КАК ПризнакEBITDA
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыручкаОтПродажиОС
				И Субконто2 &lt;&gt; &amp;СтатьиДР_СебестоимостьОптовыхПродаж
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ПроцентыПолученные
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("01") КАК Код, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(ВЫБОР
			КОГДА ЛОЖЬ
					И Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборотДт
			ИНАЧЕ -Таблица.СуммаОборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА ЛОЖЬ
					И Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборотДт
			ИНАЧЕ -Таблица.СуммаМСФООборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА ЛОЖЬ
					И Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиПостоянныхЗатрат КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА Субконто2.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			        ТОГДА &amp;СтатьиДР_НалогУпр
			    ИНАЧЕ Субконто2
			КОНЕЦ) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_Корректировки) КАК Статья, (&amp;СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 = &amp;СтатьиДР_СебестоимостьОптовыхПродаж
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_Корректировки) КАК Статья, (&amp;СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиПостоянныхЗатрат КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2 В (&amp;СтатьиДР_НалогУпр, &amp;СтатьиДР_ПодарочныеСертификаты, &amp;СтатьиДР_ПодаркиПокупателям)
			ТОГДА "02"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала, &amp;СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала, &amp;СтатьяДР_ЗП_УправлениеРозницей, &amp;СтатьяДР_НалогиФОТ_УправениеРозницей)
			ТОГДА "03"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_ЗарплатаОфис, &amp;СтатьяДР_НаНалогиФОТ_ЗарплатаОфис, &amp;СтатьяДР_ЗП_УправлениеРасчетаЗаказов, &amp;СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов, &amp;СтатьяДР_ЗП_УЕК, &amp;СтатьяДР_НалогиФОТ_УЕК, &amp;СтатьяДР_НалогиФОТ_УправлениеКачеством)
			ТОГДА "06"
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 В (&amp;СтатьиДР_НалогУпр, &amp;СтатьиДР_ПодарочныеСертификаты, &amp;СтатьиДР_ПодаркиПокупателям)
			ТОГДА "Переменные затраты"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала, &amp;СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала, &amp;СтатьяДР_ЗП_УправлениеРозницей, &amp;СтатьяДР_НалогиФОТ_УправениеРозницей)
			ТОГДА "Постоянные затраты"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_ЗарплатаОфис, &amp;СтатьяДР_НаНалогиФОТ_ЗарплатаОфис, &amp;СтатьяДР_ЗП_УправлениеРасчетаЗаказов, &amp;СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов, &amp;СтатьяДР_ЗП_УЕК, &amp;СтатьяДР_НалогиФОТ_УЕК, &amp;СтатьяДР_НалогиФОТ_УправлениеКачеством)
			ТОГДА "Общие расходы"
		ИНАЧЕ ""
	КОНЕЦ,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ВЫБОР
		КОГДА Таблица.Субконто2 В (&amp;СтатьиДР_НалогУпр, &amp;СтатьиДР_ПодарочныеСертификаты, &amp;СтатьиДР_ПодаркиПокупателям)
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала, &amp;СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала, &amp;СтатьяДР_ЗП_УправлениеРозницей, &amp;СтатьяДР_НалогиФОТ_УправениеРозницей)
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_ЗарплатаОфис, &amp;СтатьяДР_НаНалогиФОТ_ЗарплатаОфис, &amp;СтатьяДР_ЗП_УправлениеРасчетаЗаказов, &amp;СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов, &amp;СтатьяДР_ЗП_УЕК, &amp;СтатьяДР_НалогиФОТ_УЕК, &amp;СтатьяДР_НалогиФОТ_УправлениеКачеством)
			ТОГДА ЛОЖЬ
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ПланСчетов.Финансовый КАК Таблица
				ГДЕ
					Таблица.Код = "X90"),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 В (&amp;СтатьиДР_НалогУпр, &amp;СтатьиДР_ПодарочныеСертификаты, &amp;СтатьиДР_ПодаркиПокупателям)
			ТОГДА "02"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала, &amp;СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала, &amp;СтатьяДР_ЗП_УправлениеРозницей, &amp;СтатьяДР_НалогиФОТ_УправениеРозницей)
			ТОГДА "03"
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_ЗарплатаОфис, &amp;СтатьяДР_НаНалогиФОТ_ЗарплатаОфис, &amp;СтатьяДР_ЗП_УправлениеРасчетаЗаказов, &amp;СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов, &amp;СтатьяДР_ЗП_УЕК, &amp;СтатьяДР_НалогиФОТ_УЕК, &amp;СтатьяДР_НалогиФОТ_УправлениеКачеством)
			ТОГДА "06"
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 В (&amp;СтатьиДР_НалогУпр, &amp;СтатьиДР_ПодарочныеСертификаты, &amp;СтатьиДР_ПодаркиПокупателям)
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала, &amp;СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала, &amp;СтатьяДР_ЗП_УправлениеРозницей, &amp;СтатьяДР_НалогиФОТ_УправениеРозницей)
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2 В (&amp;СтатьяДР_ЗарплатаОфис, &amp;СтатьяДР_НаНалогиФОТ_ЗарплатаОфис, &amp;СтатьяДР_ЗП_УправлениеРасчетаЗаказов, &amp;СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов, &amp;СтатьяДР_ЗП_УЕК, &amp;СтатьяДР_НалогиФОТ_УЕК, &amp;СтатьяДР_НалогиФОТ_УправлениеКачеством)
			ТОГДА ЛОЖЬ
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_НДС
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_ВыручкаОтПродажиОС КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 = &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_ПеремещениеОС) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
				КОГДА &amp;Счета_44_или_90 = 1
					ТОГДА КорСчет &lt;&gt; &amp;Счет442
				ИНАЧЕ ИСТИНА
			КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_ПеремещениеОС) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
				КОГДА &amp;Счета_44_или_90 = 1
					ТОГДА КорСчет &lt;&gt; &amp;Счет442
				ИНАЧЕ ИСТИНА
			КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборотКт),
	СУММА(Таблица.СуммаМСФООборотКт),
	СУММА(Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 &lt;&gt; &amp;СтатьиДР_СебестоимостьОптовыхПродаж
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ПроцентыПолученные
				И НЕ Субконто2 В ИЕРАРХИИ (&amp;СтатьиДР_ГруппаВыручкаОтПрочейДеятельности)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				И ЛОЖЬ
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И Субконто2 &lt;&gt; &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ПроцентыПолученные
				И НЕ Субконто2 В ИЕРАРХИИ (&amp;СтатьиДР_ГруппаВыручкаОтПрочейДеятельности)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (ВЫБОР
			    КОГДА ЛОЖЬ
			            И Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).* КАК Статья, ((ВЫБОР
			    КОГДА ЛОЖЬ
			            И Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			        ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			    ИНАЧЕ Субконто2
			КОНЕЦ).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица)
				И НЕ КорСчет В
						(ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_БезОбщих.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И НЕ ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА КорСчет &lt;&gt; &amp;Счет442
						ИНАЧЕ ИСТИНА
					КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_НалогУпр
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
			ТОГДА ЛОЖЬ
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.КА",
	"Основные средства",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ЕСТЬNULL(ПринятыеКУчетуОС.СтатьяДР.Ссылка, ЕСТЬNULL(ПринятыеКУчетуОС_01.СтатьяДР.Ссылка, &amp;СтатьяДР_ОС)),
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	ЛОЖЬ,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета01.Ссылка
				ИЗ
					ТЗ_Счета01
				ГДЕ
					ТЗ_Счета01.Код &lt;&gt; "01.9"),
			,
			{(Организация).*, ("10.КА") КАК Код, ("Основные средства") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			&amp;ПризнакВыводитьСуммыКА
				И НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода))
				И НЕ КорСчет В ИЕРАРХИИ
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ПланСчетов.Финансовый КАК Таблица
						ГДЕ
							Таблица.Код = "02"),
			) КАК Таблица
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СостояниеОС.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода_Заглушка)}, ) КАК ТаблицаСостояниеОС
		ПО Таблица.Субконто1 = ТаблицаСостояниеОС.ОсновноеСредство
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПринятыеКУчетуОС.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода_Заглушка)}, ) КАК ПринятыеКУчетуОС
		ПО Таблица.Организация = ПринятыеКУчетуОС.Организация
			И Таблица.Субконто1 = ПринятыеКУчетуОС.ОсновноеСредство
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			МАКСИМУМ(Таблица.СтатьяДР) КАК СтатьяДР,
			Таблица.Организация КАК Организация,
			Таблица.ОсновноеСредство.Номенклатура КАК Номенклатура
		ИЗ
			РегистрСведений.ПринятыеКУчетуОС.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода_Заглушка)}, ) КАК Таблица
		
		СГРУППИРОВАТЬ ПО
			Таблица.Организация,
			Таблица.ОсновноеСредство.Номенклатура) КАК ПринятыеКУчетуОС_01
		ПО Таблица.Организация = ПринятыеКУчетуОС_01.Организация
			И Таблица.Субконто1.Номенклатура = ПринятыеКУчетуОС_01.Номенклатура
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	ЕСТЬNULL(ПринятыеКУчетуОС.СтатьяДР.Ссылка, ЕСТЬNULL(ПринятыеКУчетуОС_01.СтатьяДР.Ссылка, &amp;СтатьяДР_ОС)),
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.КА",
	"Основные средства",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	ИСТИНА,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	ИСТИНА,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ
				(ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи)
			
				ОБЪЕДИНИТЬ
			
				ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ПланСчетов.Финансовый КАК Таблица
				ГДЕ
					Таблица.Код = "X90"),
			&amp;ВидыСубконто44,
			&amp;ПризнакВыводитьСуммыКА
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиИнвестиционные КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10.КА") КАК Код, ("Основные средства") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет.Код = "44.5"
				И НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев), ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода))
				И НЕ КорСчет В ИЕРАРХИИ
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ПланСчетов.Финансовый КАК Таблица
						ГДЕ
							Таблица.Код = "02"),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	"по ДР" КАК Режим,
	"УУ.ВсеБезИнвестиций" КАК Раздел,
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.Счет КАК Счет,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма) КАК Сумма_КА,
	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр_КА,
	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО_КА,
	NULL КАК _Процент_КА,
	NULL КАК _ПроцентКорр_КА,
	NULL КАК _ПроцентМСФО_КА,
	ТЗ.ПризнакВыручка,
	ЛОЖЬ КАК ПризнакВыручкаВРазрезеМесяца_МСФО,
	ТЗ.ПризнакВыручкаВРазрезеМесяца КАК ПризнакВыручкаВРазрезеМесяца_КА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
{ГДЕ
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВыручка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"04",
	ТЗ.Счет,
	"Эффективность",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЭффективность = ИСТИНА
{ГДЕ
	("04") КАК Код,
	("Эффективность") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"09",
	ТЗ.Счет,
	"Итого прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыль = ИСТИНА
{ГДЕ
	("09") КАК Код,
	("Итого прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"11.3",
	ТЗ.Счет,
	"Чистая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("11.3") КАК Код,
	("Чистая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"11.0",
	ТЗ.Счет,
	"Валовая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
{ГДЕ
	("11.0") КАК Код,
	("Валовая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"11.1",
	ТЗ.Счет,
	"Прибыль до налогообложения",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыльДоНалогообложения = ИСТИНА
{ГДЕ
	("11.1") КАК Код,
	("Прибыль до налогообложения") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"11.2",
	ТЗ.Счет,
	"Налог на прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакНалогНаПрибыль = ИСТИНА
{ГДЕ
	("11.2") КАК Код,
	("Налог на прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"12",
	ТЗ.Счет,
	"gross margin",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
{ГДЕ
	("12") КАК Код,
	("gross margin") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_ЧистаяПрибыль",
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_НалогНаПрибыль",
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	-СУММА(ТЗ.Сумма),
	-СУММА(ТЗ.СуммаКорр),
	-СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакНалогНаПрибыль = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_ОсновныеСредства",
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакОсновныеСредства = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	ТЗ.Статья_ДляСоединения,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	-СУММА(ТЗ.Сумма),
	-СУММА(ТЗ.СуммаКорр),
	-СУММА(ТЗ.СуммаМСФО),
	NULL,
	NULL,
	NULL,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ПроцентыУплаченные
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль,
	ТЗ.Статья_ДляСоединения

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	"УУ.ВсеБезИнвестиций",
	ТЗ.Организация,
	"20",
	ТЗ.Счет,
	"margin",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	NULL,
	ЛОЖЬ,
	ИСТИНА
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	(ТЗ.ПризнакEBITDA = ИСТИНА
			ИЛИ ЕСТЬNULL(ТЗ.ПризнакВыручка, ЛОЖЬ) = ИСТИНА)
{ГДЕ
	("20") КАК Код,
	("margin") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет</query>
		</item>
		<item xsi:type="DataSetObject">
			<name>По_ДаннымОПУ_Прибыль</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Режим</dataPath>
				<field>Режим</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Режим</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>0</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр1</dataPath>
				<field>ГруппаУр1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур1</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>0</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>0</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Год</dataPath>
				<field>Год</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Год</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:decimal</v8:Type>
					<v8:NumberQualifiers>
						<v8:Digits>0</v8:Digits>
						<v8:FractionDigits>0</v8:FractionDigits>
						<v8:AllowedSign>Any</v8:AllowedSign>
					</v8:NumberQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:decimal</v8:Type>
					<v8:NumberQualifiers>
						<v8:Digits>0</v8:Digits>
						<v8:FractionDigits>0</v8:FractionDigits>
						<v8:AllowedSign>Any</v8:AllowedSign>
					</v8:NumberQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>СуммаМСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:decimal</v8:Type>
					<v8:NumberQualifiers>
						<v8:Digits>0</v8:Digits>
						<v8:FractionDigits>0</v8:FractionDigits>
						<v8:AllowedSign>Any</v8:AllowedSign>
					</v8:NumberQualifiers>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Субконто1</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Субконто2</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Субконто3</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type xmlns:d6p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d6p1:CatalogRef.Организации</v8:Type>
				</valueType>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<objectName>По_ДаннымОПУ_Прибыль</objectName>
		</item>
		<item xsi:type="DataSetQuery">
			<name>По_ДатеРегистратора_МСФО</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО</dataPath>
				<field>СуммаМСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр</dataPath>
				<field>СуммаКорр</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Период</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>2</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Режим</dataPath>
				<field>Режим</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Режим</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО</dataPath>
				<field>ЦФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦФО_ТТ_НаКонецПериода</dataPath>
				<field>ЦФО_ТТ_НаКонецПериода</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЦФО т т на конец периода</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Признак_ГодДВ_Меньше_ГодаДР</dataPath>
				<field>Признак_ГодДВ_Меньше_ГодаДР</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак год д в меньше года ДР</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияПоРегистратору</dataPath>
				<field>ОрганизацияПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма_КА</dataPath>
				<field>Сумма_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр1</dataPath>
				<field>ГруппаУр1</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур1</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ГруппаУр2</dataPath>
				<field>ГруппаУр2</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Группа ур2</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Регистратор</dataPath>
				<field>Регистратор</field>
				<role>
					<dcscom:periodNumber>1</dcscom:periodNumber>
					<dcscom:periodType>Main</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки</dataPath>
				<field>ТорговыеТочки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>МесяцПоРегистратору</dataPath>
				<field>МесяцПоРегистратору</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц по регистратору</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>3</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
				<field>ТорговыеТочки_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Торговые точки для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаКорр_КА</dataPath>
				<field>СуммаКорр_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма корр КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаМСФО_КА</dataPath>
				<field>СуммаМСФО_КА</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сумма МСФО КА</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Месяц</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>4</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РегистраторКомментарий</dataPath>
				<field>РегистраторКомментарий</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Регистратор комментарий</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья</dataPath>
				<field>Статья</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья_ДляСоединения</dataPath>
				<field>Статья_ДляСоединения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Статья для соединения</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
					<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ОрганизацияДляГруппировки</dataPath>
				<field>ОрганизацияДляГруппировки</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Организация для группировки</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:dimension>true</dcscom:dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Год</dataPath>
				<field>Год</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Год</v8:content>
					</v8:item>
				</title>
				<role>
					<dcscom:periodNumber>5</dcscom:periodNumber>
					<dcscom:periodType>Additional</dcscom:periodType>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_ПроцентМСФО</dataPath>
				<field>_ПроцентМСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_ПроцентКорр</dataPath>
				<field>_ПроцентКорр</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент корр</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>_Процент</dataPath>
				<field>_Процент</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Процент</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВаловаяПрибыль</dataPath>
				<field>ПризнакВаловаяПрибыль</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак валовая прибыль</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПризнакВыручкаВРазрезеМесяца_МСФО</dataPath>
				<field>ПризнакВыручкаВРазрезеМесяца_МСФО</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Признак выручка в разрезе месяца МСФО</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка,
	Таблица.Код
ПОМЕСТИТЬ ТЗ_Счета01
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Инвестиции))
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_БезОбщих
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет90)
	И Таблица.Ссылка &lt;&gt; &amp;Счет902
	И Таблица.Ссылка &lt;&gt; &amp;Счет961
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_Общие
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет442
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка = &amp;Счет902
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета68
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ЛОЖЬ
			ИНАЧЕ ИСТИНА
		КОНЕЦ
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиПостоянныхЗатрат
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;ЗатратыПостоянные, &amp;УЕК)
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиСписаниеИнвестицийИРезервы
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (&amp;СтатьиДР_Группа_СписаниеИнвестиций, &amp;СтатьиДР_Группа_Резервы)
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакМСФО
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка
ПОМЕСТИТЬ ТЗ_СчетаОНАОПУ
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Код ПОДОБНО "99%"
	И &amp;ПризнакМСФО
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Организация КАК Организация,
	"01" КАК Код,
	"Выручка" КАК ГруппаУр1,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ) КАК Период,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) КАК МесяцПоРегистратору,
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ОрганизацияПоРегистратору,
	МЕСЯЦ(Таблица.ПериодМесяц) КАК Месяц,
	ГОД(Таблица.ПериодМесяц) КАК Год,
	Таблица.Субконто1 КАК ТорговыеТочки_ДляСоединения,
	Таблица.Субконто2 КАК Статья_ДляСоединения,
	Таблица.Субконто3 КАК ЦФО,
	Таблица.Регистратор КАК Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)) КАК РегистраторКомментарий,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборот
		КОНЕЦ) КАК Сумма,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборот
		КОНЕЦ) КАК СуммаКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ) КАК СуммаМСФО,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Признак_ГодДВ_Меньше_ГодаДР,
	Таблица.Организация КАК ОрганизацияДляГруппировки,
	Таблица.Счет,
	ЛОЖЬ КАК ПризнакНалогНаПрибыль,
	ИСТИНА КАК ПризнакЭффективность,
	ИСТИНА КАК ПризнакПрибыль,
	ИСТИНА КАК ПризнакПрибыльДоНалогообложения,
	ИСТИНА КАК ПризнакВыручка,
	ИСТИНА КАК ПризнакЧистаяПрибыль,
	ЛОЖЬ КАК ПризнакАмортизацияОС,
	ИСТИНА КАК ПризнакВаловаяПрибыль,
	ЛОЖЬ КАК ПризнакСебестоимость,
	ИСТИНА КАК ПризнакEBITDA
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("01") КАК Код, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"01",
	"Выручка",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	-СУММА(Таблица.СуммаОборот),
	-СУММА(Таблица.СуммаМСФООборот),
	-СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_ПодарочныеСертификаты
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("01") КАК Код, ("Выручка") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборотДт
			ИНАЧЕ -Таблица.СуммаОборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборотДт
			ИНАЧЕ -Таблица.СуммаМСФООборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиПостоянныхЗатрат КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_БонусыПокупателям
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;СтатьиДР_ПодарочныеСертификаты)
				И Субконто2 &lt;&gt; &amp;СтатьиДР_НалогУпр
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам))
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборотДт
			ИНАЧЕ -Таблица.СуммаОборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборотДт
			ИНАЧЕ -Таблица.СуммаМСФООборот
		КОНЕЦ),
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)
			ИНАЧЕ -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыТочекДляРаспределения)),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_НалогУпр
				И (КорСубконто2.Код &lt;&gt; "000000002"
					И КорСубконто2.Код &lt;&gt; "000000003")
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	&amp;СтатьиДР_НалогУпр,
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборот),
	СУММА(Таблица.СуммаМСФООборот),
	СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаОНАОПУ КАК Таблица),
			,
			&amp;ПризнакМСФО
				И ЛОЖЬ
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (&amp;СтатьиДР_НалогУпр) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_НалогУпр КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"02",
	"Переменные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_Корректировки КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("02") КАК Код, ("Переменные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_Корректировки) КАК Статья, (&amp;СтатьиДР_ГруппаСебестоимость) КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.Код = "31020"
				ИЛИ Таблица.Субконто2.Код = "31021"
				ИЛИ Таблица.Субконто2.Код = "31022"
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиПостоянныхЗатрат КАК Таблица)
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет &lt;&gt; &amp;Счет442
					ИНАЧЕ ИСТИНА
				КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.Код = "31020"
				ИЛИ Таблица.Субконто2.Код = "31021"
				ИЛИ Таблица.Субконто2.Код = "31022"
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"03",
	"Постоянные затраты",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов),
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.Код = "31020"
				ИЛИ Таблица.Субконто2.Код = "31021"
				ИЛИ Таблица.Субконто2.Код = "31022"
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = &amp;Счет961,
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И ЛОЖЬ
				И Субконто2 = &amp;СтатьиДР_ВыручкаОтПродажиОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("03") КАК Код, ("Постоянные затраты") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_ПеремещениеОС) КАК Статья, (ВЫРАЗИТЬ(&amp;СтатьиДР_ПеремещениеОС КАК Справочник.СтатьиДоходовРасходов).Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
				КОГДА &amp;Счета_44_или_90 = 1
					ТОГДА КорСчет &lt;&gt; &amp;Счет442
				ИНАЧЕ ИСТИНА
			КОНЕЦ,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.Код = "31020"
				ИЛИ Таблица.Субконто2.Код = "31021"
				ИЛИ Таблица.Субконто2.Код = "31022"
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборотКт),
	СУММА(Таблица.СуммаМСФООборотКт),
	СУММА(Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА "02"
		ИНАЧЕ "05"
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА "Переменные затраты"
		ИНАЧЕ "Прочая деятельность"
	КОНЕЦ,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА "02"
		ИНАЧЕ "05"
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА "Переменные затраты"
		ИНАЧЕ "Прочая деятельность"
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"05",
	"Прочая деятельность",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакМСФО
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("05") КАК Код, ("Прочая деятельность") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета68 КАК Таблица)
				И НЕ КорСчет В
						(ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"06",
	"Общие расходы",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ИСТИНА,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ИСТИНА
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_СчетаЗатрат_БезОбщих.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("06") КАК Код, ("Общие расходы") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_Счета90 КАК Таблица
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ЛОЖЬ
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							&amp;Счет445
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ЛОЖЬ
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ)
				И НЕ ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА КорСчет &lt;&gt; &amp;Счет442
						ИНАЧЕ ИСТИНА
					КОНЕЦ,
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10",
	"Инвестиции",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_СтатьиСписаниеИнвестицийИРезервы КАК Таблица)
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10") КАК Код, ("Инвестиции") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2 = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ Таблица.Субконто2 = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	NULL,
	ИСТИНА,
	ИСТИНА,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ЛОЖЬ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10.1") КАК Код, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			ВЫБОР
					КОГДА &amp;Счета_44_или_90 = 1
						ТОГДА КорСчет = &amp;Счет445
					ИНАЧЕ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
							ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
							ИЛИ КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
				КОНЕЦ
				И НЕ КорСчет В
						(ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ
			
						ОБЪЕДИНИТЬ ВСЕ
			
						ВЫБРАТЬ
							ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
						ГДЕ
							ВЫБОР
								КОГДА &amp;Счета_44_или_90 = 1
									ТОГДА ИСТИНА
								ИНАЧЕ ИСТИНА
							КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"10.1",
	"Амортизация ОС",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ИСТИНА,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	ИСТИНА,
	NULL,
	ИСТИНА,
	ЛОЖЬ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ЛОЖЬ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ТЗ_СчетаЗатрат_Общие.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_Общие),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_ВыбытиеОС
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("10.1") КАК Код, ("Амортизация ОС") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (Субконто2).* КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_Счета01 КАК Таблица
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ЛОЖЬ
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					&amp;Счет445
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ИСТИНА
					КОНЕЦ
			
				ОБЪЕДИНИТЬ ВСЕ
			
				ВЫБРАТЬ
					ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
				ГДЕ
					ВЫБОР
						КОГДА &amp;Счета_44_или_90 = 1
							ТОГДА ИСТИНА
						ИНАЧЕ ИСТИНА
					КОНЕЦ),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто2,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		КОГДА Таблица.Субконто2.Родитель = &amp;СтатьиДР_ГруппаСебестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Основные средства",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборотДт),
	СУММА(-Таблица.СуммаМСФООборотДт),
	СУММА(-(Таблица.СуммаОборотДт + Таблица.СуммаМСФООборотДт)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета01.Ссылка
				ИЗ
					ТЗ_Счета01
				ГДЕ
					ТЗ_Счета01.Код &lt;&gt; "01.9"),
			,
			&amp;ПризнакМСФО {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Основные средства") КАК ГруппаУр2, ("Основные средства") КАК Статья},
			,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Себестоимость использованной упаковки",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(&amp;НачалоПериода, &amp;КонецПериода, Авто, Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары), , &amp;ПризнакМСФО {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Выручка") КАК ГруппаУр2, ("Себестоимость использованной упаковки") КАК Статья}, КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.МатералыДляВыпуска), ) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Доставка товаров на склад",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Товары),
			,
			&amp;ПризнакМСФО
				И Субконто3 = &amp;СтатьяТД_ДоставкаТоваров {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Доставка товаров на склад") КАК ГруппаУр2, ("Доставка товаров на склад") КАК Статья},
			,
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	Таблица.КорСубконто2,
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ (&amp;Счет44),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_НалогУпр
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, (КорСубконто2) КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.НалогиУН),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.КорСубконто2,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	Таблица.ПериодМесяц,
	Таблица.Организация,
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"НДС не принятый к зачету",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаКонечныйОстаток),
	СУММА(-Таблица.СуммаМСФОКонечныйОстаток),
	СУММА(-(Таблица.СуммаКонечныйОстаток + Таблица.СуммаМСФОКонечныйОстаток)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.ОстаткиИОбороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНДС),
			,
			&amp;ПризнакМСФО {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, (&amp;СтатьиДР_Группа_НалогНаПрибыль) КАК ГруппаУр2, ("НДС не принятый к зачету") КАК Статья}) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.ПериодМесяц,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Убыток прошлых периодов",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт)),
	СУММА(-(Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт)),
	СУММА(-(Таблица.СуммаОборотДт - Таблица.СуммаОборотКт + (Таблица.СуммаМСФООборотДт - Таблица.СуммаМСФООборотКт))),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			ИСТИНА
				И Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев),
			,
			&amp;ПризнакМСФО {(Организация).*, ("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Убыток прошлых периодов") КАК ГруппаУр2, ("Убыток прошлых периодов") КАК Статья},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыПрошлыхПериодов),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"99",
	"Справочная информация",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	NULL,
	"Проект Избенка",
	NULL,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	NULL,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ЛОЖЬ,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					ТЗ_Счета90.Ссылка
				ИЗ
					ТЗ_Счета90),
			,
			&amp;ПризнакМСФО
				И Организация = &amp;Организация_ПроектИзбенка {("99") КАК Код, ("Справочная информация") КАК ГруппаУр1, ("Проект Избёнка") КАК Организация},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	Таблица.Организация

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"11.2",
	"Налог на прибыль",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	"ОПУ_НалогНаПрибыль",
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(-Таблица.СуммаОборот),
	СУММА(-Таблица.СуммаМСФООборот),
	СУММА(-(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ЛОЖЬ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ЗатратыТочекДляРаспределения)),
			&amp;ВидыСубконто44,
			&amp;ПризнакМСФО
				И Субконто2 = &amp;СтатьиДР_НалогУпр
				И (КорСубконто2.Код = "000000002"
					ИЛИ КорСубконто2.Код = "000000003")
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*, ("11.2") КАК Код, ("Налог на прибыль") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, ("ОПУ_НалогНаПрибыль") КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.РасчетыПоНалогам)),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	"11.2",
	"Налог на прибыль",
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Субконто1,
	ВЫБОР
		КОГДА Таблица.Счет.Код = "99.1"
			ТОГДА "ОПУ_ОНА"
		КОГДА Таблица.Счет.Код = "99.2"
			ТОГДА "ОПУ_ОНО"
	КОНЕЦ,
	Таблица.Субконто3,
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	СУММА(Таблица.СуммаОборот),
	СУММА(Таблица.СуммаМСФООборот),
	СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот),
	ЛОЖЬ,
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	Таблица.Счет,
	ИСТИНА,
	ЛОЖЬ,
	ЛОЖЬ,
	NULL,
	NULL,
	ИСТИНА,
	NULL,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ЛОЖЬ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			ДАТАВРЕМЯ(2017, 1, 1) {(&amp;НП)},
			&amp;КонецПериода,
			Авто,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаОНАОПУ КАК Таблица),
			,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*, ("11.2") КАК Код, ("Налог на прибыль") КАК ГруппаУр1, (Субконто1).* КАК ТорговыеТочки, (&amp;СтатьиДР_НалогУпр) КАК Статья, (Субконто2.Родитель).* КАК ГруппаУр2, (Субконто3).* КАК ЦФО},
			КорСчет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица
ГДЕ
	ГОД(Таблица.ПериодМесяц) &gt; 2016
{ГДЕ
	(НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ)) КАК Период,
	(НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
					КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
						ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
				КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ)) КАК МесяцПоРегистратору,
	(ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))) КАК ОрганизацияПоРегистратору,
	(МЕСЯЦ(Таблица.ПериодМесяц)) КАК Месяц,
	(ГОД(Таблица.ПериодМесяц)) КАК Год,
	Таблица.Регистратор КАК Регистратор,
	(ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
							КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
								ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
						КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Признак_ГодДВ_Меньше_ГодаДР}

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	Таблица.Субконто1,
	Таблица.Субконто3,
	НАЧАЛОПЕРИОДА(Таблица.ПериодМесяц, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
				КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
					ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
			КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ),
	ЕСТЬNULL(Таблица.Регистратор.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)),
	МЕСЯЦ(Таблица.ПериодМесяц),
	ГОД(Таблица.ПериодМесяц),
	Таблица.Регистратор,
	ВЫРАЗИТЬ(Таблица.Регистратор.Комментарий КАК СТРОКА(150)),
	ВЫБОР
		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(ВЫБОР
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеТоваровУслуг).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.КорректировкаПоступления
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.КорректировкаПоступления).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеДопРасходов
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеДопРасходов).ДатаВходящегоДокумента
						КОГДА Таблица.Регистратор ССЫЛКА Документ.ПоступлениеОС
							ТОГДА ВЫРАЗИТЬ(Таблица.Регистратор КАК Документ.ПоступлениеОС).ДатаВходящегоДокумента
					КОНЕЦ, Таблица.ПериодМесяц), МЕСЯЦ) &lt; НАЧАЛОПЕРИОДА(Таблица.ПериодГод, ГОД)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Счет,
	ВЫБОР
		КОГДА Таблица.Счет.Код = "99.1"
			ТОГДА "ОПУ_ОНА"
		КОГДА Таблица.Счет.Код = "99.2"
			ТОГДА "ОПУ_ОНО"
	КОНЕЦ,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	Таблица.Организация,
	ВЫБОР
		КОГДА Таблица.Субконто2.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	"по ДР" КАК Режим,
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.Счет КАК Счет,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	СУММА(ТЗ.Сумма) КАК Сумма,
	СУММА(ТЗ.СуммаКорр) КАК СуммаКорр,
	СУММА(ТЗ.СуммаМСФО) КАК СуммаМСФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ПризнакВыручкаВРазрезеМесяца КАК ПризнакВыручкаВРазрезеМесяца_МСФО,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	0 КАК Сумма_КА,
	0 КАК СуммаКорр_КА,
	0 КАК СуммаМСФО_КА,
	NULL КАК _Процент,
	NULL КАК _ПроцентКорр,
	NULL КАК _ПроцентМСФО,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
{ГДЕ
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Код,
	ТЗ.ГруппаУр1,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Месяц,
	ТЗ.Год,
	ТЗ.ТорговыеТочки_ДляСоединения,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ЦФО,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Признак_ГодДВ_Меньше_ГодаДР,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"04",
	ТЗ.Счет,
	"Эффективность",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЭффективность = ИСТИНА
{ГДЕ
	("04") КАК Код,
	("Эффективность") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"09",
	ТЗ.Счет,
	"Итого прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыль = ИСТИНА
{ГДЕ
	("09") КАК Код,
	("Итого прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11.2",
	ТЗ.Счет,
	"Налог на прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакНалогНаПрибыль = ИСТИНА
	И ЛОЖЬ
{ГДЕ
	("11.2") КАК Код,
	("Налог на прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11.0",
	ТЗ.Счет,
	"Валовая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
{ГДЕ
	("11.0") КАК Код,
	("Валовая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11.1",
	ТЗ.Счет,
	"Прибыль до налогообложения",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакПрибыльДоНалогообложения = ИСТИНА
{ГДЕ
	("11.1") КАК Код,
	("Прибыль до налогообложения") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11.3",
	ТЗ.Счет,
	"Чистая прибыль",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("11.3") КАК Код,
	("Чистая прибыль") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"11.X",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакEBITDA = ИСТИНА
	И ЛОЖЬ
{ГДЕ
	("11.X") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_ЧистаяПрибыль",
	NULL,
	СУММА(ТЗ.Сумма),
	СУММА(ТЗ.СуммаКорр),
	СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_АмортизацияОС",
	NULL,
	-СУММА(ТЗ.Сумма),
	-СУММА(ТЗ.СуммаКорр),
	-СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакАмортизацияОС = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	"EBITDA_НалогНаПрибыль",
	NULL,
	-СУММА(ТЗ.Сумма),
	-СУММА(ТЗ.СуммаКорр),
	-СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	ТЗ.ПризнакНалогНаПрибыль = ИСТИНА
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"13",
	ТЗ.Счет,
	"EBITDA",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	ТЗ.Статья_ДляСоединения,
	NULL,
	-СУММА(ТЗ.Сумма),
	-СУММА(ТЗ.СуммаКорр),
	-СУММА(ТЗ.СуммаМСФО),
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	NULL,
	NULL,
	NULL,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	(ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_РасходыНаДисконтирование
			ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ПроцентыУплаченные
			ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ПроцентыПолученные
			ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ИЛИ ТЗ.Статья_ДляСоединения.Код = "31020"
			ИЛИ ТЗ.Статья_ДляСоединения.Код = "31021"
			ИЛИ ТЗ.Статья_ДляСоединения.Код = "31022")
{ГДЕ
	("13") КАК Код,
	("EBITDA") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ВЫБОР
		КОГДА ТЗ.ПризнакЧистаяПрибыль = ИСТИНА
			ТОГДА "EBITDA_ЧистаяПрибыль"
		КОГДА ТЗ.ПризнакАмортизацияОС = ИСТИНА
			ТОГДА "EBITDA_АмортизацияОС"
		КОГДА ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_РасходыНаДисконтирование
				ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ПроцентыУплаченные
				ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ПроцентыПолученные
				ИЛИ ТЗ.Статья_ДляСоединения = &amp;СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов
			ТОГДА ТЗ.Статья_ДляСоединения
		ИНАЧЕ NULL
	КОНЕЦ,
	ТЗ.Статья_ДляСоединения,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"12",
	ТЗ.Счет,
	"gross margin",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВаловаяПрибыль = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	(ТЗ.ПризнакВыручка = ИСТИНА
			ИЛИ ТЗ.ПризнакВаловаяПрибыль = ИСТИНА)
{ГДЕ
	("12") КАК Код,
	("gross margin") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"по ДР",
	ТЗ.Организация,
	"20",
	ТЗ.Счет,
	"margin",
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	МЕСЯЦ(ТЗ.Период),
	ГОД(ТЗ.Период),
	NULL,
	NULL,
	NULL,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ИСТИНА,
	NULL,
	ТЗ.ОрганизацияДляГруппировки,
	0,
	0,
	0,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.Сумма
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаКорр
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	100 * ВЫБОР
		КОГДА СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакEBITDA = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ) / СУММА(ВЫБОР
					КОГДА ТЗ.ПризнакВыручка = ИСТИНА
						ТОГДА ТЗ.СуммаМСФО
					ИНАЧЕ 0
				КОНЕЦ)
	КОНЕЦ,
	ТЗ.ПризнакВаловаяПрибыль
ИЗ
	ТЗ КАК ТЗ
		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦФОСтруктурныхЕдиниц.СрезПоследних(&amp;КонецПериода {(&amp;КонецПериода)}, ) КАК Таблица_ЦФО
		ПО ТЗ.ТорговыеТочки_ДляСоединения = Таблица_ЦФО.СтруктурнаяЕдиница}
ГДЕ
	(ТЗ.ПризнакВыручка = ИСТИНА
			ИЛИ ТЗ.ПризнакEBITDA = ИСТИНА)
{ГДЕ
	("20") КАК Код,
	("margin") КАК ГруппаУр1,
	Таблица_ЦФО.ЦФО.* КАК ЦФО_ТТ_НаКонецПериода}

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.Период,
	ТЗ.МесяцПоРегистратору,
	ТЗ.ОрганизацияПоРегистратору,
	ТЗ.Регистратор,
	ТЗ.РегистраторКомментарий,
	ТЗ.ОрганизацияДляГруппировки,
	ТЗ.Счет,
	ТЗ.ПризнакВаловаяПрибыль</query>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>СоответствиеСтатей</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтатьяБУ</dataPath>
			<field>СтатьяБУ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтатьяУУ</dataPath>
			<field>СтатьяУУ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Счет_</dataPath>
			<field>Счет_</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Счет</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Таблица.Счет КАК Счет_,
	Таблица.Статья КАК СтатьяУУ,
	Таблица.СтатьяБУ
ИЗ
	РегистрСведений.СоответствиеСтатейДРСтатьямБУ КАК Таблица
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таблица.Счет КАК Счет,
			Таблица.Статья КАК Статья,
			МАКСИМУМ(Таблица.Основное) КАК Основное
		ИЗ
			РегистрСведений.СоответствиеСтатейДРСтатьямБУ КАК Таблица
		
		СГРУППИРОВАТЬ ПО
			Таблица.Счет,
			Таблица.Статья) КАК ТаблицаОсновные
		ПО Таблица.Счет = ТаблицаОсновные.Счет
			И Таблица.Статья = ТаблицаОсновные.Статья
			И Таблица.Основное = ТаблицаОсновные.Основное</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>ВыручкаВРазрезеМесяца_МСФО</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Счет</dataPath>
			<field>Счет</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСчет</dataPath>
			<field>КорСчет</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто1</dataPath>
			<field>КорСубконто1</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто2</dataPath>
			<field>КорСубконто2</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто3</dataPath>
			<field>КорСубконто3</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто1</dataPath>
			<field>Субконто1</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто2</dataPath>
			<field>Субконто2</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто3</dataPath>
			<field>Субконто3</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Период</dataPath>
			<field>Период</field>
			<role>
				<dcscom:periodNumber>1</dcscom:periodNumber>
				<dcscom:periodType>Main</dcscom:periodType>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Режим</dataPath>
			<field>Режим</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Режим</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручки</dataPath>
			<field>СуммаВыручки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручкиКорр</dataPath>
			<field>СуммаВыручкиКорр</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки корр</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручкиМСФО</dataPath>
			<field>СуммаВыручкиМСФО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки МСФО</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручкаВРазрезеМесяца_МСФО</dataPath>
			<field>ПризнакВыручкаВРазрезеМесяца_МСФО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак выручка в разрезе месяца МСФО</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВалютаКор</dataPath>
			<field>ВалютаКор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Валюта</dataPath>
			<field>Валюта</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_БезОбщих
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет90)
	И Таблица.Ссылка &lt;&gt; &amp;Счет902
	И Таблица.Ссылка &lt;&gt; &amp;Счет961
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Организация КАК Организация,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ) КАК Период,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаОборот
		КОНЕЦ) КАК СуммаВыручки,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -Таблица.СуммаМСФООборот
		КОНЕЦ) КАК СуммаВыручкиКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
		КОНЕЦ) КАК СуммаВыручкиМСФО
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Месяц,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты),
			&amp;ВидыСубконто90,
			&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
				ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект {(Организация).*},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Организация,
	ИСТИНА,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ),
	-СУММА(Таблица.СуммаОборот),
	-СУММА(Таблица.СуммаМСФООборот),
	-СУММА(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Месяц,
			Счет В
				(ВЫБРАТЬ
					Таблица.Ссылка
				ИЗ
					ТЗ_СчетаЗатрат_БезОбщих КАК Таблица),
			&amp;ВидыСубконто90,
			Субконто2 = &amp;СтатьиДР_ПодарочныеСертификаты
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*},
			НЕ КорСчет В
					(ВЫБРАТЬ
						Таблица.Ссылка
					ИЗ
						ТЗ_Счета90 КАК Таблица
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредств)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствДо100000)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.АмортизацияОсновныхСредствУчетНМА)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ЛОЖЬ
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						&amp;Счет445
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ
			
					ОБЪЕДИНИТЬ ВСЕ
			
					ВЫБРАТЬ
						ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода)
					ГДЕ
						ВЫБОР
							КОГДА &amp;Счета_44_или_90 = 1
								ТОГДА ИСТИНА
							ИНАЧЕ ИСТИНА
						КОНЕЦ),
			) КАК Таблица

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТЗ.Организация,
	ТЗ.ПризнакВыручкаВРазрезеМесяца КАК ПризнакВыручкаВРазрезеМесяца_МСФО,
	ТЗ.Период,
	СУММА(ТЗ.СуммаВыручки) КАК СуммаВыручки,
	СУММА(ТЗ.СуммаВыручкиКорр) КАК СуммаВыручкиКорр,
	СУММА(ТЗ.СуммаВыручкиМСФО) КАК СуммаВыручкиМСФО
ИЗ
	ТЗ КАК ТЗ

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Период</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>Субконто1_ТорговыеТочки</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТорговыеТочки</dataPath>
			<field>ТорговыеТочки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Торговые точки</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:ignoreNullValues>true</dcscom:ignoreNullValues>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТорговойТочки</dataPath>
			<field>КодТорговойТочки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код торговой точки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТорговыеТочки_ДляСоединения</dataPath>
			<field>ТорговыеТочки_ДляСоединения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Торговые точки для соединения</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Таблица.Ссылка КАК ТорговыеТочки_ДляСоединения,
	Таблица.Ссылка КАК ТорговыеТочки,
	Таблица.Представление КАК ТорговыеТочкиПредставление,
	Таблица.id_TT КАК КодТорговойТочки
ИЗ
	Справочник.СтруктурныеЕдиницы КАК Таблица
ГДЕ
	Таблица.ТипСтруктурнойЕдиницы = ЗНАЧЕНИЕ(Перечисление.ТипыСтруктурныхЕдиниц.Розница)

</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>Субконто2_СтатьиДР</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГруппаУр2.Код</dataPath>
			<field>ГруппаУр2_Код</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Группа статей.Код</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГруппаУр2</dataPath>
			<field>ГруппаУр2</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Группа статей</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья</dataPath>
			<field>Статья</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья.Код</dataPath>
			<field>КодСтатьи</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статья_ДляСоединения</dataPath>
			<field>Статья_ДляСоединения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья для соединения</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Раздел</dataPath>
			<field>Раздел</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Раздел</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтатьяПредставление</dataPath>
			<field>СтатьяПредставление</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Статья представление</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Статья_ДляСоединения,
	&amp;Раздел КАК Раздел,
	ВЫБОР
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
			ТОГДА Таблица.Ссылка
		КОГДА &amp;Раздел = "УУ.Инвестиции"
			ТОГДА Таблица.Ссылка
		КОГДА Таблица.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			ТОГДА &amp;СтатьиДР_НалогУпр
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА &amp;СтатьяДР_СебестоимостьОптовыхПродаж
		КОГДА &amp;ПризнакМСФО = ЛОЖЬ
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
		ИНАЧЕ Таблица.Ссылка
	КОНЕЦ КАК Статья,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
				ТОГДА Таблица.Ссылка
			КОГДА &amp;Раздел = "УУ.Инвестиции"
				ТОГДА Таблица.Ссылка
			КОГДА &amp;ПризнакМСФО = ИСТИНА
					И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				ТОГДА &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			КОГДА &amp;ПризнакМСФО = ЛОЖЬ
					И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
			ИНАЧЕ Таблица.Ссылка
		КОНЕЦ) КАК СтатьяПредставление,
	(ВЫБОР
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
			ТОГДА Таблица.Ссылка
		КОГДА &amp;Раздел = "УУ.Инвестиции"
			ТОГДА Таблица.Ссылка
		КОГДА Таблица.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			ТОГДА &amp;СтатьиДР_НалогУпр
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА &amp;СтатьяДР_СебестоимостьОптовыхПродаж
		КОГДА &amp;ПризнакМСФО = ЛОЖЬ
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА &amp;СтатьяДР_ВыручкаОптовыхПродаж
		ИНАЧЕ Таблица.Ссылка
	КОНЕЦ).Код КАК КодСтатьи,
	ВЫБОР
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
				И Таблица.Ссылка = &amp;СтатьиДР_ВыручкаОтПродажиОС
			ТОГДА &amp;СтатьиДР_ГруппаОборудованиеДляТТ
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
			ТОГДА Таблица.Родитель
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_СебестоимостьОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА &amp;СтатьиДР_ГруппаСебестоимость
		КОГДА &amp;ПризнакМСФО = ЛОЖЬ
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_ВыручкаОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель
		ИНАЧЕ Таблица.Родитель
	КОНЕЦ КАК ГруппаУр2,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
					И Таблица.Ссылка = &amp;СтатьиДР_ВыручкаОтПродажиОС
				ТОГДА &amp;СтатьиДР_ГруппаОборудованиеДляТТ
			КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
				ТОГДА Таблица.Родитель
			КОГДА &amp;ПризнакМСФО = ИСТИНА
					И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_СебестоимостьОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель
			КОГДА &amp;ПризнакМСФО = ИСТИНА
					И Таблица.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
				ТОГДА &amp;СтатьиДР_ГруппаСебестоимость
			КОГДА &amp;ПризнакМСФО = ЛОЖЬ
					И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
				ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_ВыручкаОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель
			ИНАЧЕ Таблица.Родитель
		КОНЕЦ) КАК ГруппаУр2Представление,
	ВЫБОР
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
				И Таблица.Ссылка = &amp;СтатьиДР_ВыручкаОтПродажиОС
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьиДР_ГруппаОборудованиеДляТТ КАК Справочник.СтатьиДоходовРасходов).Код
		КОГДА &amp;Раздел = "УУ.ВсеБезИнвестиций"
			ТОГДА Таблица.Родитель.Код
		КОГДА Таблица.Родитель = &amp;СтатьиДР_Группа_НалогНаПрибыль
			ТОГДА "20742"
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_СебестоимостьОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель.Код
		КОГДА &amp;ПризнакМСФО = ИСТИНА
				И Таблица.ВидДоходаРасхода = &amp;ВидДоходаРасхода_Себестоимость
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьиДР_ГруппаСебестоимость КАК Справочник.СтатьиДоходовРасходов).Код
		КОГДА &amp;ПризнакМСФО = ЛОЖЬ
				И Таблица.Ссылка = &amp;СтатьяДР_СебестоимостьОптовыхПродаж
			ТОГДА ВЫРАЗИТЬ(&amp;СтатьяДР_ВыручкаОптовыхПродаж КАК Справочник.СтатьиДоходовРасходов).Родитель.Код
		ИНАЧЕ Таблица.Родитель.Код
	КОНЕЦ КАК ГруппаУр2_Код
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	НЕ Таблица.ЭтоГруппа

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Справочник.СтатьиДоходовРасходов.ПустаяСсылка),
	&amp;Раздел,
	"",
	"",
	"",
	"",
	"",
	""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Ссылка,
	&amp;Раздел,
	Таблица.Ссылка,
	ПРЕДСТАВЛЕНИЕ(Таблица.Ссылка),
	Таблица.Код,
	&amp;СтатьиДР_Группа_НалогНаПрибыль,
	ПРЕДСТАВЛЕНИЕ(&amp;СтатьиДР_Группа_НалогНаПрибыль),
	ВЫРАЗИТЬ(&amp;СтатьиДР_Группа_НалогНаПрибыль КАК Справочник.СтатьиДоходовРасходов).Код
ИЗ
	Справочник.ВидыНалогов КАК Таблица

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Основные средства",
	&amp;Раздел,
	"Основные средства",
	"Основные средства",
	"121",
	"Основные средства",
	"Основные средства",
	"121"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Себестоимость использованной упаковки",
	&amp;Раздел,
	"Себестоимость использованной упаковки",
	"Себестоимость использованной упаковки",
	"101",
	"Выручка",
	"Выручка",
	"101"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Доставка товаров на склад",
	&amp;Раздел,
	"Доставка товаров на склад",
	"Доставка товаров на склад",
	"102",
	"Доставка товаров на склад",
	"Доставка товаров на склад",
	"102"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"НДС не принятый к зачету",
	&amp;Раздел,
	"НДС не принятый к зачету",
	"НДС не принятый к зачету",
	"",
	&amp;СтатьиДР_Группа_НалогНаПрибыль,
	ПРЕДСТАВЛЕНИЕ(&amp;СтатьиДР_Группа_НалогНаПрибыль),
	ВЫРАЗИТЬ(&amp;СтатьиДР_Группа_НалогНаПрибыль КАК Справочник.СтатьиДоходовРасходов).Код

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Убыток прошлых периодов",
	&amp;Раздел,
	"Убыток прошлых периодов",
	"Убыток прошлых периодов",
	"103",
	"Убыток прошлых периодов",
	"Убыток прошлых периодов",
	"103"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"Проект Избенка",
	&amp;Раздел,
	"Проект Избенка",
	"Проект Избенка",
	"104",
	"Проект Избенка",
	"Проект Избенка",
	"104"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"ОПУ_НалогНаПрибыль",
	&amp;Раздел,
	"Налог на прибыль",
	"Налог на прибыль",
	"НП",
	"Налог на прибыль (ОПУ)",
	"Налог на прибыль (ОПУ)",
	"207.ОПУ"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"ОПУ_ОНА",
	&amp;Раздел,
	"ОНА",
	"ОНА",
	"ОНА",
	"Налог на прибыль (ОПУ)",
	"Налог на прибыль (ОПУ)",
	"207.ОПУ"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"ОПУ_ОНО",
	&amp;Раздел,
	"ОНО",
	"ОНО",
	"ОНО",
	"Налог на прибыль (ОПУ)",
	"Налог на прибыль (ОПУ)",
	"207.ОПУ"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"EBITDA_ЧистаяПрибыль",
	&amp;Раздел,
	"Чистая прибыль",
	"ЧП",
	"ЧП",
	"EBITDA",
	"EBITDA",
	"13.XXX"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"EBITDA_АмортизацияОС",
	&amp;Раздел,
	"Амортизация ОС",
	"Амортизация ОС",
	"АОС",
	"EBITDA",
	"EBITDA",
	"13.XXX"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"EBITDA_ОсновныеСредства",
	&amp;Раздел,
	"Основные средства",
	"Основные средства",
	"10.КА",
	"EBITDA",
	"EBITDA",
	"13.XXX"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"EBITDA_НалогНаПрибыль",
	&amp;Раздел,
	"Налог на прибыль",
	"НП",
	"НП",
	"EBITDA",
	"EBITDA",
	"13.XXX"</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>ВыручкаВРазрезеМесяца_КА</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Счет</dataPath>
			<field>Счет</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСчет</dataPath>
			<field>КорСчет</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто1</dataPath>
			<field>КорСубконто1</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто2</dataPath>
			<field>КорСубконто2</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КорСубконто3</dataPath>
			<field>КорСубконто3</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто1</dataPath>
			<field>Субконто1</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто2</dataPath>
			<field>Субконто2</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Субконто3</dataPath>
			<field>Субконто3</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Период</dataPath>
			<field>Период</field>
			<role>
				<dcscom:periodNumber>1</dcscom:periodNumber>
				<dcscom:periodType>Main</dcscom:periodType>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Режим</dataPath>
			<field>Режим</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Режим</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПризнакВыручкаВРазрезеМесяца_КА</dataPath>
			<field>ПризнакВыручкаВРазрезеМесяца_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Признак выручка в разрезе месяца КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручкиКорр_КА</dataPath>
			<field>СуммаВыручкиКорр_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки корр КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручкиМСФО_КА</dataPath>
			<field>СуммаВыручкиМСФО_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки МСФО КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаВыручки_КА</dataPath>
			<field>СуммаВыручки_КА</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма выручки КА</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВалютаКор</dataPath>
			<field>ВалютаКор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Валюта</dataPath>
			<field>Валюта</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СчетаЗатрат_БезОбщих
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет44)
	И Таблица.Ссылка &lt;&gt; &amp;Счет442
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 0
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
{ГДЕ
	("по ДР") КАК Режим}

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Таблица.Ссылка
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;Счет90)
	И Таблица.Ссылка &lt;&gt; &amp;Счет902
	И Таблица.Ссылка &lt;&gt; &amp;Счет961
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
	И Таблица.Ссылка &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
	И ВЫБОР
			КОГДА (ВЫРАЗИТЬ(&amp;Счета_44_или_90 КАК ЧИСЛО)) = 1
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_Счета90
ИЗ
	ПланСчетов.Финансовый КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Финансовый.Продажи))
	И Таблица.Родитель &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПустаяСсылка)
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Ссылка КАК Ссылка
ПОМЕСТИТЬ ТЗ_СтатьиИнвестиционные
ИЗ
	Справочник.СтатьиДоходовРасходов КАК Таблица
ГДЕ
	Таблица.Ссылка В ИЕРАРХИИ(&amp;СтатьиДР_Группа_СписаниеИнвестиций)
	И Таблица.Ссылка &lt;&gt; &amp;СтатьиДР_ВыбытиеОС
	И НЕ Таблица.ЭтоГруппа
	И &amp;ПризнакВыводитьСуммыКА
{ГДЕ
	("по ДР") КАК Режим}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таблица.Организация КАК Организация,
	ИСТИНА КАК ПризнакВыручкаВРазрезеМесяца,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ) КАК Период,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -Таблица.СуммаОборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт
		КОНЕЦ) КАК СуммаВыручки,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -Таблица.СуммаМСФООборот
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаВыручкиКорр,
	СУММА(ВЫБОР
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая)
				ТОГДА -(Таблица.СуммаОборот + Таблица.СуммаМСФООборот)
			КОГДА Таблица.Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.БонусыИСертификаты)
				ТОГДА Таблица.СуммаОборотКт + Таблица.СуммаМСФООборотКт
		КОНЕЦ) КАК СуммаВыручкиМСФО
ПОМЕСТИТЬ ТЗ
ИЗ
	РегистрБухгалтерии.Финансовый.Обороты(
			&amp;НачалоПериода,
			&amp;КонецПериода,
			Месяц,
			Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаТорговыхТочек)
				ИЛИ Счет = ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ВыручкаПрочая),
			&amp;ВидыСубконто90,
			&amp;ПризнакВыводитьСуммыКА
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ВыручкаОтПродажиОС
				И Субконто2 &lt;&gt; &amp;СтатьиДР_СебестоимостьОптовыхПродаж
				И Субконто2 &lt;&gt; &amp;СтатьиДР_ПроцентыПолученные
				И НЕ Субконто2 В
						(ВЫБРАТЬ
							Таблица.Ссылка
						ИЗ
							ТЗ_СтатьиИнвестиционные КАК Таблица)
				И (&amp;Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
					ИЛИ Субконто1.ТипРозничнойТочки = &amp;Проект) {(Организация).*},
			КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльПрошлыхМесяцев)
				И КорСчет &lt;&gt; ЗНАЧЕНИЕ(ПланСчетов.Финансовый.ПрибыльТекущегоПериода),
			) КАК Таблица

СГРУППИРОВАТЬ ПО
	Таблица.Организация,
	НАЧАЛОПЕРИОДА(Таблица.Период, МЕСЯЦ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТЗ.Организация,
	ТЗ.ПризнакВыручкаВРазрезеМесяца КАК ПризнакВыручкаВРазрезеМесяца_КА,
	ТЗ.Период,
	СУММА(ТЗ.СуммаВыручки) КАК СуммаВыручки_КА,
	СУММА(ТЗ.СуммаВыручкиКорр) КАК СуммаВыручкиКорр_КА,
	СУММА(ТЗ.СуммаВыручкиМСФО) КАК СуммаВыручкиМСФО_КА
ИЗ
	ТЗ КАК ТЗ

СГРУППИРОВАТЬ ПО
	ТЗ.Организация,
	ТЗ.ПризнакВыручкаВРазрезеМесяца,
	ТЗ.Период</query>
	</dataSet>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>СоответствиеСтатей</destinationDataSet>
		<sourceExpression>Статья</sourceExpression>
		<destinationExpression>СтатьяУУ</destinationExpression>
		<required>false</required>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>ВыручкаВРазрезеМесяца_МСФО</destinationDataSet>
		<sourceExpression>ПризнакВыручкаВРазрезеМесяца_МСФО</sourceExpression>
		<destinationExpression>ПризнакВыручкаВРазрезеМесяца_МСФО</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>ВыручкаВРазрезеМесяца_МСФО</destinationDataSet>
		<sourceExpression>Период</sourceExpression>
		<destinationExpression>Период</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>Субконто1_ТорговыеТочки</destinationDataSet>
		<sourceExpression>ТорговыеТочки_ДляСоединения</sourceExpression>
		<destinationExpression>ТорговыеТочки_ДляСоединения</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>Субконто2_СтатьиДР</destinationDataSet>
		<sourceExpression>Статья_ДляСоединения</sourceExpression>
		<destinationExpression>Статья_ДляСоединения</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>Субконто2_СтатьиДР</destinationDataSet>
		<sourceExpression>Раздел</sourceExpression>
		<destinationExpression>Раздел</destinationExpression>
		<parameter>Раздел</parameter>
		<parameterListAllowed>false</parameterListAllowed>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>ВыручкаВРазрезеМесяца_КА</destinationDataSet>
		<sourceExpression>ПризнакВыручкаВРазрезеМесяца_КА</sourceExpression>
		<destinationExpression>ПризнакВыручкаВРазрезеМесяца_КА</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Объединение</sourceDataSet>
		<destinationDataSet>ВыручкаВРазрезеМесяца_КА</destinationDataSet>
		<sourceExpression>Период</sourceExpression>
		<destinationExpression>Период</destinationExpression>
	</dataSetLink>
	<calculatedField>
		<dataPath>Процент</dataPath>
		<expression>ВЫБОР КОГДА  НЕ _Процент ЕСТЬ NULL ТОГДА _Процент
		КОГДА  (ЕСТЬNULL(СуммаВыручки, 0)) = 0
			ТОГДА 0
		ИНАЧЕ Сумма * 100 / (ЕСТЬNULL(СуммаВыручки, 0))
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>ПроцентКорр</dataPath>
		<expression>ВЫБОР  КОГДА  НЕ _ПроцентКорр ЕСТЬ NULL ТОГДА _ПроцентКорр
		КОГДА ЕСТЬNULL(СуммаВыручкиКорр, 0) = 0
			ТОГДА 0
		ИНАЧЕ СуммаКорр * 100 / ЕСТЬNULL(СуммаВыручкиКорр, 0)
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент корр</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>ПроцентМСФО</dataPath>
		<expression>ВЫБОР  КОГДА  НЕ _ПроцентМСФО ЕСТЬ NULL ТОГДА _ПроцентМСФО
		КОГДА ЕСТЬNULL(СуммаВыручкиМСФО, 0) = 0
			ТОГДА 0
		ИНАЧЕ СуммаМСФО * 100 / ЕСТЬNULL(СуммаВыручкиМСФО, 0)
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент МСФО</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>РазницаМСФО_КА</dataPath>
		<expression>СуммаМСФО - Сумма_КА</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сумма (МСФО - КА)</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>ЧДЦ=</v8:content>
					</v8:item>
				</dcscor:value>
			</dcscor:item>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
				<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
			</dcscor:item>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
				<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>Процент_КА</dataPath>
		<expression>ВЫБОР КОГДА  НЕ _Процент_КА ЕСТЬ NULL ТОГДА _Процент_КА
		КОГДА  (ЕСТЬNULL(СуммаВыручки_КА, 0)) = 0
			ТОГДА 0
		ИНАЧЕ Сумма_КА * 100 / (ЕСТЬNULL(СуммаВыручки_КА, 0))
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент (КА)</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>ПроцентКорр_КА</dataPath>
		<expression>ВЫБОР  КОГДА  НЕ _ПроцентКорр_КА ЕСТЬ NULL ТОГДА _ПроцентКорр_КА
		КОГДА ЕСТЬNULL(СуммаВыручкиКорр_КА, 0) = 0
			ТОГДА 0
		ИНАЧЕ СуммаКорр_КА * 100 / ЕСТЬNULL(СуммаВыручкиКорр_КА, 0)
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент корр (КА)</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<calculatedField>
		<dataPath>ПроцентМСФО_КА</dataPath>
		<expression>ВЫБОР  КОГДА  НЕ _ПроцентМСФО_КА ЕСТЬ NULL ТОГДА _ПроцентМСФО_КА
		КОГДА ЕСТЬNULL(СуммаВыручкиМСФО_КА, 0) = 0
			ТОГДА 0
		ИНАЧЕ СуммаМСФО_КА * 100 / ЕСТЬNULL(СуммаВыручкиМСФО_КА, 0)
	КОНЕЦ</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Процент МСФО (КА)</v8:content>
			</v8:item>
		</title>
		<appearance>
			<dcscor:item xsi:type="dcsset:SettingsParameterValue">
				<dcscor:parameter>Формат</dcscor:parameter>
				<dcscor:value xsi:type="xs:string">ЧДЦ=1</dcscor:value>
			</dcscor:item>
		</appearance>
	</calculatedField>
	<totalField>
		<dataPath>Сумма</dataPath>
		<expression>Сумма(Сумма)</expression>
	</totalField>
	<totalField>
		<dataPath>Процент</dataPath>
		<expression>Сумма(Процент)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаКорр</dataPath>
		<expression>Сумма(СуммаКорр)</expression>
	</totalField>
	<totalField>
		<dataPath>ПроцентКорр</dataPath>
		<expression>Сумма(ПроцентКорр)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаМСФО</dataPath>
		<expression>Сумма(СуммаМСФО)</expression>
	</totalField>
	<totalField>
		<dataPath>ПроцентМСФО</dataPath>
		<expression>Сумма(ПроцентМСФО)</expression>
	</totalField>
	<totalField>
		<dataPath>Сумма_КА</dataPath>
		<expression>Сумма(Сумма_КА)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаКорр_КА</dataPath>
		<expression>Сумма(СуммаКорр_КА)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаМСФО_КА</dataPath>
		<expression>Сумма(СуммаМСФО_КА)</expression>
	</totalField>
	<totalField>
		<dataPath>РазницаМСФО_КА</dataPath>
		<expression>Сумма(ISNULL(СуммаМСФО,0)) - Сумма(ISNULL(Сумма_КА,0))</expression>
	</totalField>
	<totalField>
		<dataPath>Процент_КА</dataPath>
		<expression>Сумма(Процент_КА)</expression>
	</totalField>
	<totalField>
		<dataPath>ПроцентКорр_КА</dataPath>
		<expression>Сумма(ПроцентКорр_КА)</expression>
	</totalField>
	<totalField>
		<dataPath>ПроцентМСФО_КА</dataPath>
		<expression>Сумма(ПроцентМСФО_КА)</expression>
	</totalField>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КП</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>КП</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>КонецПериода(ВЫБОР КОГДА &amp;КонецПериода &lt; ДатаВремя(2017,01,01) ТОГДА &amp;КонецПериода ИНАЧЕ ДатаВремя(2016,12,31,23,59,59) КОНЕЦ, "День")</expression>
	</parameter>
	<parameter>
		<name>НП</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>НП</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>НАЧАЛОПЕРИОДА(ВЫБОР КОГДА &amp;НачалоПериода &gt; ДатаВремя(2017,01,01) ТОГДА &amp;НачалоПериода ИНАЧЕ ДатаВремя(2017,01,01) КОНЕЦ, "День")</expression>
	</parameter>
	<parameter>
		<name>Проект</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Проект</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:EnumRef.ТипыРозничныхТочек</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>ВидыСубконто90</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Виды субконто90</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfCharacteristicTypesRef.ВидыСубконто</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.ТорговыеТочки</value>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.СтатьиДоходовРасходов</value>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.ЦФО</value>
		<useRestriction>true</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>ВидыСубконто44</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Виды субконто44</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfCharacteristicTypesRef.ВидыСубконто</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.ТорговыеТочки</value>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.СтатьиДоходовРасходов</value>
		<value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.ЦФО</value>
		<useRestriction>true</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>Счет90</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет90</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланСчетов.Финансовый.Продажи</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Счет902</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет902</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланСчетов.Финансовый.ЗатратыОбщие</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Счет44</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет44</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланСчетов.Финансовый.ЗатратыДляРаспределения</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Счет442</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет442</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">ПланСчетов.Финансовый.ЗатратыОбщиеДляРаспределения</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Счет445</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет445</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>ПланыСчетов.Финансовый.НайтиПоКоду("44.5")</expression>
	</parameter>
	<parameter>
		<name>Счет961</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счет961</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:ChartOfAccountsRef.Финансовый</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>ПланыСчетов.Финансовый.НайтиПоКоду("96.1")</expression>
	</parameter>
	<parameter>
		<name>ЗатратыПостоянные</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Затраты постоянные</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>УЕК</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>УЕК</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>СтатьиДР_Корректировки</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Корректировки</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20120")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьяДР_ВыручкаОптовыхПродаж</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Выручка оптовых продаж</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10105") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьяДР_СебестоимостьОптовыхПродаж</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Себестоимость оптовых продаж1</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20129")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьяДР_СебестоимостьПроданногоТовара</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Себестоимость проданного товара</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20110") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_НалогУпр</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Налог упр</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20742") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_ПодарочныеСертификаты</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Подарочные сертификаты</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("21002") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_ВыбытиеОС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Выбытие ОС</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61014") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_АмортизацияИнвестицийВТТ</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Амортизация инвестиций в ТТ</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_Группа_СписаниеИнвестиций</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Списание инвестиций</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("6    ") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_Группа_Резервы</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Резервы</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("213  ") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_Группа_НалогНаПрибыль</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Налог на прибыль</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("207  ") </expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_ПеремещениеОС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р группа себестоимость1</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("39131")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_ВыручкаОтПродажиОС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р перемещение о с1</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10110")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьяТД_ДоставкаТоваров</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья т д доставка товаров</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиТовародвижения</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиТовародвижения.НайтиПоКоду("00000023")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Организация_ПроектИзбенка</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Организация проект избенка</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Организации</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.Организации.НайтиПоКоду("000000005")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Счета_44_или_90</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Счета 44 или 90</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:decimal</v8:Type>
			<v8:NumberQualifiers>
				<v8:Digits>0</v8:Digits>
				<v8:FractionDigits>0</v8:FractionDigits>
				<v8:AllowedSign>Any</v8:AllowedSign>
			</v8:NumberQualifiers>
		</valueType>
		<value xsi:type="xs:decimal">0</value>
		<useRestriction>false</useRestriction>
		<availableValue>
			<value xsi:nil="true"/>
			<presentation xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>По 44м счетам</v8:content>
				</v8:item>
			</presentation>
		</availableValue>
		<availableValue>
			<value xsi:type="xs:decimal">1</value>
			<presentation xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>По 90м счетам</v8:content>
				</v8:item>
			</presentation>
		</availableValue>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КонецПериода_Заглушка</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода заглушка</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьяДР_ОС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р ОС</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61054") </expression>
	</parameter>
	<parameter>
		<name>Раздел</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Раздел</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:string</v8:Type>
			<v8:StringQualifiers>
				<v8:Length>19</v8:Length>
				<v8:AllowedLength>Variable</v8:AllowedLength>
			</v8:StringQualifiers>
		</valueType>
		<value xsi:type="xs:string"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>СтатьяДР_РезервНаВыплатуОтпускныхПрочегоПерсонала</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р резерв на выплату отпускных прочего персонала</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("37197") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_РезервНаНалогиФОТ_ОтпускныеПрочегоПерсонала</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р резерв на налоги ФОТ отпускные прочего персонала</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("37198") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_ЗарплатаОфис</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р зарплата офис</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("37110") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_НаНалогиФОТ_ЗарплатаОфис</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р на налоги ФОТ зарплата офис</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("37115") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_ЗП_УправлениеРасчетаЗаказов</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р з п управление расчета заказов</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("34010") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_ЗП_УправлениеРозницей</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р з п управление розницей</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("33010") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_НалогиФОТ_УправениеРозницей</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р налоги ФОТ управение розницей</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("33011") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_НалогиФОТ_УправлениеРасчетаЗаказов</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р налоги ФОТ управление расчета заказов</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("34011") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ПодаркиПокупателям</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р подарки покупателям</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("21001") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_СебестоимостьОптовыхПродаж</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р себестоимость оптовых продаж</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20129") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_ЗП_УЕК</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р з п УЕК</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("41010") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_НалогиФОТ_УЕК</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р налоги ФОТ УЕК</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("41020") </expression>
	</parameter>
	<parameter>
		<name>СтатьяДР_НалогиФОТ_УправлениеКачеством</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья д р налоги ФОТ управление качеством</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("36120") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ГруппаВыручкаОтПрочейДеятельности</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р группа выручка от прочей деятельности</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("101    ") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ГруппаОборудованиеДляТТ</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р группа оборудование для ТТ</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("391    ")</expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_БонусыПокупателям</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р бонусы покупателям</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20901")</expression>
	</parameter>
	<parameter>
		<name>ПризнакВыводитьСуммыКА</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Признак выводить суммы КА</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ПризнакМСФО</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Признак МСФО</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтатьиДР_ПроцентыУплаченные</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р проценты уплаченные</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("39396") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_РасходыНаДисконтирование</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р расходы на дисконтирование</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("21306") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ПроцентыПолученные</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р проценты полученные</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("39395") </expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р доходы от начисление процентов на дисконтирование депозитов</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("31017") </expression>
	</parameter>
	<parameter>
		<name>ВидДоходаРасхода_Себестоимость</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Вид дохода расхода себестоимость</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.ВидыДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.ВидыДоходовРасходов.НайтиПоКоду("000000006")</expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_ГруппаСебестоимость</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р группа себестоимость</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("201")</expression>
	</parameter>
	<parameter>
		<name>СтатьиДР_НДС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статьи д р НДС</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиДоходовРасходов</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20745")</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:lwsTitle>
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Финансовый</v8:content>
						</v8:item>
					</dcsset:lwsTitle>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Сумма</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Процент</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:lwsTitle>
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Корректировка МСФО</v8:content>
						</v8:item>
					</dcsset:lwsTitle>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>СуммаКорр</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ПроцентКорр</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:lwsTitle>
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>МСФО (Фин + Корр)</v8:content>
						</v8:item>
					</dcsset:lwsTitle>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>СуммаМСФО</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ПроцентМСФО</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ВидыСубконто44</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DesignTimeValue">ПланВидовХарактеристик.ВидыСубконто.ТорговыеТочки</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Счет90</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Счет902</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_Корректировки</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20120")</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьяДР_ВыручкаОптовыхПродаж</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">Справочники.СтатьиДоходовРасходов.НайтиПоКоду("10105") </dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьяДР_СебестоимостьПроданногоТовара</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">Справочники.СтатьиДоходовРасходов.НайтиПоКоду("20110") </dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_ВыбытиеОС</dcscor:parameter>
					<dcscor:value xsi:type="xs:string"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ПризнакВыводитьСуммыКА</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_ПроцентыУплаченные</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_РасходыНаДисконтирование</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_ПроцентыПолученные</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>СтатьиДР_ДоходыОтНачислениеПроцентовНаДисконтированиеДепозитов</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>РасположениеРеквизитов</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionAttributesPlacement">Separately</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьОтбор</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemTable">
				<dcsset:column>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Год</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Месяц</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
				</dcsset:column>
				<dcsset:row>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>ГруппаУр1.Код</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>ГруппаУр1</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
					<dcsset:conditionalAppearance>
						<dcsset:item>
							<dcsset:use>false</dcsset:use>
							<dcsset:selection/>
							<dcsset:filter/>
							<dcsset:appearance>
								<dcscor:item xsi:type="dcsset:SettingsParameterValue">
									<dcscor:parameter>ЦветФона</dcscor:parameter>
									<dcscor:value xsi:type="v8ui:Color">web:Orange</dcscor:value>
								</dcscor:item>
							</dcsset:appearance>
						</dcsset:item>
						<dcsset:item>
							<dcsset:selection>
								<dcsset:item>
									<dcsset:field>ГруппаУр1</dcsset:field>
								</dcsset:item>
								<dcsset:item>
									<dcsset:field>ГруппаУр1.Код</dcsset:field>
								</dcsset:item>
							</dcsset:selection>
							<dcsset:filter/>
							<dcsset:appearance>
								<dcscor:item xsi:type="dcsset:SettingsParameterValue">
									<dcscor:parameter>Шрифт</dcscor:parameter>
									<dcscor:value xsi:type="v8ui:Font" ref="sys:DefaultGUIFont" bold="true" italic="false" underline="false" strikeout="false" kind="WindowsFont"/>
								</dcscor:item>
							</dcsset:appearance>
						</dcsset:item>
					</dcsset:conditionalAppearance>
					<dcsset:item>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ГруппаУр2.Код</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ГруппаУр2</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
						</dcsset:selection>
						<dcsset:item>
							<dcsset:use>false</dcsset:use>
							<dcsset:groupItems>
								<dcsset:item xsi:type="dcsset:GroupItemField">
									<dcsset:field>Статья</dcsset:field>
									<dcsset:groupType>Items</dcsset:groupType>
									<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
									<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
									<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
								</dcsset:item>
							</dcsset:groupItems>
							<dcsset:order>
								<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
							</dcsset:order>
							<dcsset:selection>
								<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
							</dcsset:selection>
						</dcsset:item>
					</dcsset:item>
				</dcsset:row>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>