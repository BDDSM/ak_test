

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УстановитьПривилегированныйРежим(Истина);
	
	ТекФизЛицо = ПараметрыСеанса.ТекущийПользователь.ФизЛицо;
	Если ЗначениеЗаполнено(ТекФизЛицо) И Справочники.КартыДизайнПроектов.ПолучитьМассивВсехТехнологов().Найти(ТекФизЛицо) <> Неопределено Тогда
		Технолог = ТекФизЛицо;
		Элементы.Технолог.ТолькоПросмотр = Истина;
	КонецЕсли;
	
	УстановитьПривилегированныйРежим(Ложь);
	
КонецПроцедуры

&НаКлиенте
Процедура Сформировать(Команда)
	
	ПолеКД_Технолог = Новый ПолеКомпоновкиДанных("Сотрудник");
	
	ЭлементыОтбора = Отчёт.КомпоновщикНастроек.Настройки.Отбор.Элементы;
	Для Каждого ЭлементОтбора Из ЭлементыОтбора Цикл
		
		Если ЭлементОтбора.ЛевоеЗначение = ПолеКД_Технолог И ЗначениеЗаполнено(ЭлементОтбора.ИдентификаторПользовательскойНастройки) Тогда
			ЭлементОтбораПН = Отчёт.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы.Найти(ЭлементОтбора.ИдентификаторПользовательскойНастройки);
			ЭлементОтбораПН.ПравоеЗначение = Технолог;
			ЭлементОтбораПН.Использование = ЗначениеЗаполнено(Технолог);
		КонецЕсли;
		
	КонецЦикла;
	
	СкомпоноватьРезультат();
	
КонецПроцедуры
