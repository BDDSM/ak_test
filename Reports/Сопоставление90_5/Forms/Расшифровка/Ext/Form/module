
Процедура ПриОткрытии()
	
	ЭлементыФормы.ПолеРасшифровка.Очистить();
	
	ТабСопоставление = Новый ТаблицаЗначений();
	ТабСопоставление.Колонки.Добавить("СсылкаНаДок");
	ТабСопоставление.Колонки.Добавить("Дата");
	ТабСопоставление.Колонки.Добавить("ДокФинансы");
	ТабСопоставление.Колонки.Добавить("ДокБухия");
	ТабСопоставление.Колонки.Добавить("СуммаФин", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(15, 2)));
	ТабСопоставление.Колонки.Добавить("СуммаБух", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(15, 2)));
	
	//+++АК Susk (Суслин К.В.) 2018.06.05 ИП-00018793
	//перенес сюда, в рамках оптимизации	
	СтрокаПодключения = ПолныеПрава.ПолучитьСтрокуПодключения_Бух();
	
	v82COMОбъект = Новый COMОбъект(ПолныеПрава.ПолучитьВерсиюКомОбъекта_Бух() + ".COMConnector");
	Попытка
		v82 = v82COMОбъект.Connect(СтрокаПодключения);
		ПодключениеУстановлено=Истина;
	Исключение
		ПодключениеУстановлено=Ложь;
		Сообщить("Не удалось подключиться к базе бухгалтерии!");
		Возврат;
	КонецПопытки;
	
	//+
	МДНом = v82.XMLTypeOf(v82.Справочники.Номенклатура.ПустаяСсылка());
	МДПДР = v82.XMLTypeOf(v82.Справочники.ПрочиеДоходыИРасходы.ПустаяСсылка());
	
	//перенес шапку запроса сюда с каждого условия одно и тоже было. Плюс оптимизация.
	ЗапросБухия = v82.NewObject("Запрос");
	ЗапросБухия.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
	ЗапросБухия.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
	ЗапросБухия.УстановитьПараметр("Орг", ПолучитьОрганизациюБух(Организация, v82));
	ЗапросБухия.УстановитьПараметр("СчетДт", v82.ПланыСчетов.Хозрасчетный.РасчетыСПокупателями); //62.01
	ЗапросБухия.УстановитьПараметр("СчетКт", v82.ПланыСчетов.Хозрасчетный.ВыручкаНеЕНВД); //90.01.1
	ЗапросБухия.УстановитьПараметр("Счет91_01", v82.ПланыСчетов.Хозрасчетный.ПрочиеДоходы); //91.01
	ЗапросБухия.УстановитьПараметр("Счет91_02", v82.ПланыСчетов.Хозрасчетный.ПрочиеРасходы); //91.02
	ЗапросБухия.УстановитьПараметр("Свойство1", v82.ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию("Это документ перепродажи", Истина));
	ЗапросБухия.УстановитьПараметр("Свойство2", v82.ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию("Это документ перепродажи по 10.01", Истина));	
	ЗапросБухия.УстановитьПараметр("СтатьяРеализацияОС", v82.XMLValue(v82.FromXMLType(МДПДР), "047452b5-f6ee-11df-9731-001e5848397d")); //Доходы (расходы), связанные с реализацией основных средств
	МассивАренда = v82.NewObject("Массив");
	МассивАренда.Добавить(v82.XMLValue(v82.FromXMLType(МДНом),"6c6750ae-d70b-11e1-8a91-000c29e4e694")); //Аренда помещений, код 00000001174
	ЗапросБухия.УстановитьПараметр("Аренда", МассивАренда);
	ЗапросБухия.УстановитьПараметр("ДоходыПоАренде", v82.XMLValue(v82.FromXMLType(МДПДР),"047452b0-f6ee-11df-9731-001e5848397d")); //Доходы (расходы), связанные со сдачей имущества в аренду (субаренду)	
	//---АК Susk (Суслин К.В.) 
	
	Если СтруктураРасшифровки.Вид = "Реализации" Тогда		
		
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор) КАК ДокПредставление,
							|	ХозрасчетныйДвиженияССубконто.Регистратор КАК Док,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетДт = &СчетДт
							|				И СчетКт = &СчетКт,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
							|		ПО ХозрасчетныйДвиженияССубконто.Регистратор = ЗначенияСвойствОбъектов.Объект
							|			И (ЗначенияСвойствОбъектов.Свойство В (&Свойство1, &Свойство2))
							|ГДЕ
							|	ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
							|	И ЕСТЬNULL(ЗначенияСвойствОбъектов.Значение, ЛОЖЬ) = ЛОЖЬ
							//+++АК Susk (Суслин К.В.) 2018.06.05 ИП-00018793							 
							|	И НЕ СубконтоКт1 = &СтатьяРеализацияОС
							//---АК Susk (Суслин К.В.) 
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата
							|ОБЪЕДИНИТЬ ВСЕ
							|ВЫБРАТЬ
							|	СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор) КАК ДокПредставление,
							|	ХозрасчетныйДвиженияССубконто.Регистратор КАК Док,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетДт = &СчетДт
							|				И СчетКт = &Счет91_01,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
							|		ПО ХозрасчетныйДвиженияССубконто.Регистратор = ЗначенияСвойствОбъектов.Объект
							|			И (ЗначенияСвойствОбъектов.Свойство В (&Свойство1, &Свойство2))
							|ГДЕ
							|	ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
							|	И ЕСТЬNULL(ЗначенияСвойствОбъектов.Значение, ЛОЖЬ) = ЛОЖЬ 
							|	И НЕ (СубконтоКт1 = &ДоходыПоАренде
							|					И СубконтоКт2 В (&Аренда))
							//+++АК Susk (Суслин К.В.) 2018.06.05 ИП-00018793							 
							|	И НЕ СубконтоКт1 = &СтатьяРеализацияОС
							//---АК Susk (Суслин К.В.) 
							|
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата";
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		Пока ВыборкаБух.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;
			СтрокаДоб.СсылкаНаДок = Документы.РеализацияТоваровУслуг.ПолучитьСсылку(Новый УникальныйИдентификатор(v82.String(ВыборкаБух.Док.УникальныйИдентификатор())));
		КонецЦикла;
		
		ЗапросФин = Новый Запрос();
		ЗапросФин.УстановитьПараметр("Орг", Организация);
		ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
		ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
		
		//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793	
	 
		//ЗапросФин.УстановитьПараметр("Счет1", ПланыСчетов.Финансовый.НайтиПоКоду("90.5"));
		ЗапросФин.УстановитьПараметр("Счет1", Счет90);  
		//---АК Susk (Суслин К.В.) 
	
		ЗапросФин.УстановитьПараметр("Счет2", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
		ЗапросФин.Текст = "ВЫБРАТЬ
		                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
		                  |ИЗ
		                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                  |			&ДатаНач,
		                  |			&ДатаКон,
		                  |			СчетКт В (&Счет1, &Счет2)
		                  |				И Организация = &Орг,
		                  |			,
		                  |			) КАК ФинансовыйДвиженияССубконто
		                  |ГДЕ
		                  |	ФинансовыйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
		                  |
		                  |СГРУППИРОВАТЬ ПО
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата";
							
		Выборка = ЗапросФин.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
			Если СтрокаДоб = Неопределено Тогда
				СтрокаДоб = ТабСопоставление.Добавить();
				СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
			КонецЕсли;
			СтрокаДоб.Дата = Выборка.Дата;
			СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
			СтрокаДоб.СуммаФин = Выборка.Сумма;
		КонецЦикла;	
		
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
				Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;
		
	//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793
	ИначеЕсли СтруктураРасшифровки.Вид = "Возврат товаров от покупателя" Тогда		
				
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	-СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор) КАК ДокПредставление,
							|	ХозрасчетныйДвиженияССубконто.Регистратор КАК Док,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетДт = &СчетДт
							|				И СчетКт = &СчетКт,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|ГДЕ
							|	ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.ВозвратТоваровОтПокупателя							
							|
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Дата";
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		
		Пока ВыборкаБух.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;
			СтрокаДоб.СсылкаНаДок = Документы.ВозвратТоваровОтПокупателя.ПолучитьСсылку(Новый УникальныйИдентификатор(v82.String(ВыборкаБух.Док.УникальныйИдентификатор())));
		КонецЦикла;
		
		ЗапросФин = Новый Запрос();
		ЗапросФин.УстановитьПараметр("Орг", Организация);
		ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
		ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
		
		ЗапросФин.УстановитьПараметр("Счет1", Счет90);  		
		ЗапросФин.Текст = "ВЫБРАТЬ
		                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Дата КАК Дата
		                  |ИЗ
		                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                  |			&ДатаНач,
		                  |			&ДатаКон,
		                  |			СчетДт В (&Счет1)
		                  |				И Организация = &Орг,
		                  |			,
		                  |			) КАК ФинансовыйДвиженияССубконто
		                  |ГДЕ
		                  |	ФинансовыйДвиженияССубконто.Регистратор ССЫЛКА Документ.ВозвратТоваровОтПокупателя
		                  |
		                  |СГРУППИРОВАТЬ ПО
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.ВозвратТоваровОтПокупателя).Дата";
							
		Выборка = ЗапросФин.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
			Если СтрокаДоб = Неопределено Тогда
				СтрокаДоб = ТабСопоставление.Добавить();
				СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
			КонецЕсли;
			СтрокаДоб.Дата = Выборка.Дата;
			СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
			СтрокаДоб.СуммаФин = Выборка.Сумма;
		КонецЦикла;	
		
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
				Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;

	//---АК Susk (Суслин К.В.)
	
	//+++АК Susk (Суслин К.В.) 2018.06.04 ИП-00018793
	ИначеЕсли СтруктураРасшифровки.Вид = "Начисление процентов по договорам" Тогда	
				
		ЗапросБухия.УстановитьПараметр("СчетДт", v82.ПланыСчетов.Хозрасчетный.РасчетыПоПричитающимсяДивидендам);
		ЗапросБухия.УстановитьПараметр("СчетКт", v82.ПланыСчетов.Хозрасчетный.ПрочиеДоходы);		
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор) КАК ДокПредставление,
							|	ХозрасчетныйДвиженияССубконто.Регистратор КАК Док,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.ОперацияБух).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетДт = &СчетДт
							|				И СчетКт = &СчетКт,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|ГДЕ
							|	ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.ОперацияБух							
							|
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.ОперацияБух).Дата";
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		
		Пока ВыборкаБух.Следующий() Цикл
						
			ГуидБП = v82.String(ВыборкаБух.Док.УникальныйИдентификатор());
			ДокНП = Документы.НачислениеПроцентовПоДоговорам.ПолучитьСсылку(Новый УникальныйИдентификатор(ГуидБП));
			
			Если ДокНП.ПолучитьОбъект() = Неопределено Тогда
				ДокНп = Документы.Операция.ПолучитьСсылку(Новый УникальныйИдентификатор(ГуидБП));
				
				Если ДокНП.ПолучитьОбъект() = Неопределено Тогда
					Продолжить;
				КонецЕсли;
				
			КонецЕсли;
			
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;		
			СтрокаДоб.СсылкаНаДок = ДокНп;
			
		КонецЦикла;
		
		ЗапросФин = Новый Запрос();
		ЗапросФин.УстановитьПараметр("Орг", Организация);
		ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
		ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
		
		ЗапросФин.УстановитьПараметр("Счет1", Счет90);  		
		ЗапросФин.Текст = "ВЫБРАТЬ
		                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.НачислениеПроцентовПоДоговорам).Дата КАК Дата
		                  |ИЗ
		                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                  |			&ДатаНач,
		                  |			&ДатаКон,
		                  |			СчетКт В (&Счет1)
		                  |				И Организация = &Орг,
		                  |			,
		                  |			) КАК ФинансовыйДвиженияССубконто
		                  |ГДЕ
		                  |	(ФинансовыйДвиженияССубконто.Регистратор ССЫЛКА Документ.НачислениеПроцентовПоДоговорам
		                  |			ИЛИ ФинансовыйДвиженияССубконто.Регистратор ССЫЛКА Документ.Операция
		                  |				И ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.Операция).ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийДокументаОперация.НачислениеПроцентовПоДепозитамЗаймам))
		                  |
		                  |СГРУППИРОВАТЬ ПО
		                  |	ФинансовыйДвиженияССубконто.Регистратор,
		                  |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор КАК Документ.НачислениеПроцентовПоДоговорам).Дата";
							
		Выборка = ЗапросФин.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
			Если СтрокаДоб = Неопределено Тогда
				СтрокаДоб = ТабСопоставление.Добавить();
				СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
			КонецЕсли;
			СтрокаДоб.Дата = Выборка.Дата;
			СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
			СтрокаДоб.СуммаФин = Выборка.Сумма;
		КонецЦикла;	
		
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
				Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;            
	//---АК Susk (Суслин К.В.) 
		
	ИначеЕсли СтруктураРасшифровки.Вид = "Начисление арендной платы арендаторам" Тогда		
				
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	СУММА(ВЗ_Запрос.Сумма) КАК Сумма,
							|	ВЗ_Запрос.Регистратор,
							|	ПРЕДСТАВЛЕНИЕ(ВЗ_Запрос.Регистратор) КАК ДокПредставление,
		                  	|	ВЫРАЗИТЬ(ВЗ_Запрос.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
							|ИЗ
							|	(ВЫБРАТЬ
							|		ХозрасчетныйДвиженияССубконто.Сумма КАК Сумма,
							|		ХозрасчетныйДвиженияССубконто.Регистратор КАК Регистратор
							|	ИЗ
							|		РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|				&ДатаНач,
							|				&ДатаКон,
							|				Организация = &Орг
							|					И СчетКт = &Счет91_01
							|					И СубконтоКт1 = &ДоходыПоАренде
							|					И СубконтоКт2 В (&Аренда),
							|				,
							|				) КАК ХозрасчетныйДвиженияССубконто
							|	ГДЕ
							|		ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
							|	
							|	ОБЪЕДИНИТЬ ВСЕ
							|	
							|	ВЫБРАТЬ
							|		ХозрасчетныйДвиженияССубконто.Сумма * -1,
							|		ХозрасчетныйДвиженияССубконто.Регистратор
							|	ИЗ
							|		РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|				&ДатаНач,
							|				&ДатаКон,
							|				Организация = &Орг
							|					И СчетДт = &Счет91_02
							|					И СубконтоДт1 = &ДоходыПоАренде
							|					И СубконтоДт2 В (&Аренда),
							|				,
							|				) КАК ХозрасчетныйДвиженияССубконто
							|	ГДЕ
							|		ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг) КАК ВЗ_Запрос
                            |
							|СГРУППИРОВАТЬ ПО
							|	ВЗ_Запрос.Регистратор,
							|	ВЫРАЗИТЬ(ВЗ_Запрос.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата";
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		Пока ВыборкаБух.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;
			//СтрокаДоб.СсылкаНаДок = Документы.РеализацияТоваровУслуг.ПолучитьСсылку(Новый УникальныйИдентификатор(v82.String(ВыборкаБух.Док.УникальныйИдентификатор())));
		КонецЦикла;
		
		Если ЗначениеЗаполнено(СтруктураРасшифровки.Тип) Тогда
			ЗапросФин = Новый Запрос();
			ЗапросФин.УстановитьПараметр("Орг", Организация);
			ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
			ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
			
			//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793	
	 
			//ЗапросФин.УстановитьПараметр("Счет1", ПланыСчетов.Финансовый.НайтиПоКоду("90.5"));
			ЗапросФин.УстановитьПараметр("Счет1", Счет90);  
			//---АК Susk (Суслин К.В.) 
		
			ЗапросФин.УстановитьПараметр("Счет2", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
			ЗапросФин.УстановитьПараметр("Тип", СтруктураРасшифровки.Тип);
			ЗапросФин.Текст = "ВЫБРАТЬ
			                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата КАК Дата
			                  |ИЗ
			                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
			                  |			&ДатаНач,
			                  |			&ДатаКон,
			                  |			СчетКт В (&Счет1, &Счет2)
			                  |				И Организация = &Орг,
			                  |			,
			                  |			) КАК ФинансовыйДвиженияССубконто
			                  |ГДЕ
			                  |	ТИПЗНАЧЕНИЯ(ФинансовыйДвиженияССубконто.Регистратор) = &Тип
			                  |
			                  |СГРУППИРОВАТЬ ПО
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата";
								
			Выборка = ЗапросФин.Выполнить().Выбрать();
			Пока Выборка.Следующий() Цикл
				СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
				Если СтрокаДоб = Неопределено Тогда
					СтрокаДоб = ТабСопоставление.Добавить();
					СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
				КонецЕсли;
				СтрокаДоб.Дата = Выборка.Дата;
				СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
				СтрокаДоб.СуммаФин = Выборка.Сумма;
			КонецЦикла;	
		КонецЕсли;	
			
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			//Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
			//	Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			//КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;
		
	//+++АК Susk (Суслин К.В.) 2018.06.04 полностью переписал	 	
	ИначеЕсли СтруктураРасшифровки.Вид = "Операция" Тогда		
				
		ЗапросБухия.УстановитьПараметр("Счет76_03", v82.ПланыСчетов.Хозрасчетный.РасчетыПоПричитающимсяДивидендам); //76.03
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор) КАК ДокПредставление,
		                  	|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетДт = &Счет76_03
							|				И СчетКт = &Счет91_01,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|ГДЕ
							|	ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.ОперацияБух 
                            |
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата";
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		Пока ВыборкаБух.Следующий() Цикл
			//нужно исключить операции по начислению процентов. 
			//Для этого ищем по гуиду, либо это начисление процентов документ, либо операция сопределенным видом операции.
			ГуидБП = v82.String(ВыборкаБух.Регистратор.УникальныйИдентификатор());
			
			ДокНП = Документы.НачислениеПроцентовПоДоговорам.ПолучитьСсылку(Новый УникальныйИдентификатор(ГуидБП));
			
			Если ДокНП.ПолучитьОбъект() = Неопределено Тогда
				ДокНп = Документы.Операция.ПолучитьСсылку(Новый УникальныйИдентификатор(ГуидБП));		
			
				Если ДокНП.ПолучитьОбъект() <> Неопределено Тогда
					Если ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ДокНП.Ссылка, "ВидОперации") = Перечисления.ВидыОперацийДокументаОперация.НачислениеПроцентовПоДепозитамЗаймам Тогда
						Продолжить;
					КонецЕсли;
				КонецЕсли;
			Иначе
				Продолжить;
			КонецЕсли;				
			
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;			
			
			//СтрокаДоб.СсылкаНаДок = Документы.РеализацияТоваровУслуг.ПолучитьСсылку(Новый УникальныйИдентификатор(v82.String(ВыборкаБух.Док.УникальныйИдентификатор())));
		КонецЦикла;
		
		Если ЗначениеЗаполнено(СтруктураРасшифровки.Тип) Тогда
			ЗапросФин = Новый Запрос();
			ЗапросФин.УстановитьПараметр("Орг", Организация);
			ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
			ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
			
			//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793	
	 
			//ЗапросФин.УстановитьПараметр("Счет1", ПланыСчетов.Финансовый.НайтиПоКоду("90.5"));
			ЗапросФин.УстановитьПараметр("Счет1", Счет90);  
			//---АК Susk (Суслин К.В.) 
			
			ЗапросФин.УстановитьПараметр("Счет2", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
			ЗапросФин.УстановитьПараметр("Тип", СтруктураРасшифровки.Тип);
			ЗапросФин.Текст = "ВЫБРАТЬ
			                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата КАК Дата
			                  |ИЗ
			                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
			                  |			&ДатаНач,
			                  |			&ДатаКон,
			                  |			СчетКт В (&Счет1, &Счет2)
			                  |				И Организация = &Орг,
			                  |			,
			                  |			) КАК ФинансовыйДвиженияССубконто
			                  |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.Операция КАК Операция
			                  |		ПО ФинансовыйДвиженияССубконто.Регистратор = Операция.Ссылка
			                  |ГДЕ
			                  |	ФинансовыйДвиженияССубконто.Регистратор ССЫЛКА Документ.Операция
			                  |	И Операция.ВидОперации <> ЗНАЧЕНИЕ(Перечисление.ВидыОперацийДокументаОперация.НачислениеПроцентовПоДепозитамЗаймам)
			                  |
			                  |СГРУППИРОВАТЬ ПО
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата";
								
			Выборка = ЗапросФин.Выполнить().Выбрать();
			Пока Выборка.Следующий() Цикл
				СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
				Если СтрокаДоб = Неопределено Тогда
					СтрокаДоб = ТабСопоставление.Добавить();
					СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
				КонецЕсли;
				СтрокаДоб.Дата = Выборка.Дата;
				СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
				СтрокаДоб.СуммаФин = Выборка.Сумма;
			КонецЦикла;	
		КонецЕсли;	
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			//Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
			//	Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			//КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;	
	ИначеЕсли СтруктураРасшифровки.Вид = "Иное" Тогда
		Если ЗначениеЗаполнено(СтруктураРасшифровки.Тип) Тогда
			ЗапросФин = Новый Запрос();
			ЗапросФин.УстановитьПараметр("Орг", Организация);
			ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
			ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
			
			//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793	
	 
			//ЗапросФин.УстановитьПараметр("Счет1", ПланыСчетов.Финансовый.НайтиПоКоду("90.5"));
			ЗапросФин.УстановитьПараметр("Счет1", Счет90);  
			//---АК Susk (Суслин К.В.) 
			
			ЗапросФин.УстановитьПараметр("Счет2", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
			ЗапросФин.УстановитьПараметр("Тип", СтруктураРасшифровки.Тип);
			ЗапросФин.Текст = "ВЫБРАТЬ
			                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата КАК Дата
			                  |ИЗ
			                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
			                  |			&ДатаНач,
			                  |			&ДатаКон,
			                  |			СчетКт В (&Счет1, &Счет2)
			                  |				И Организация = &Орг,
			                  |			,
			                  |			) КАК ФинансовыйДвиженияССубконто
			                  |ГДЕ
			                  |	ТИПЗНАЧЕНИЯ(ФинансовыйДвиженияССубконто.Регистратор) = &Тип
			                  |
			                  |СГРУППИРОВАТЬ ПО
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата";
								
			Выборка = ЗапросФин.Выполнить().Выбрать();
			Пока Выборка.Следующий() Цикл
				СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
				Если СтрокаДоб = Неопределено Тогда
					СтрокаДоб = ТабСопоставление.Добавить();
					СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
				КонецЕсли;
				СтрокаДоб.Дата = Выборка.Дата;
				СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
				СтрокаДоб.СуммаФин = Выборка.Сумма;
			КонецЦикла;
		КонецЕсли;	
		
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			//Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
			//	Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			//КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;
	ИначеЕсли СтруктураРасшифровки.Вид = "Реализация ОС" Тогда	
			
		ЗапросБухия.Текст = "ВЫБРАТЬ
							|	СУММА(ВЗ_Запрос.Сумма) КАК Сумма,
							|	ВЗ_Запрос.Регистратор,
							|	ПРЕДСТАВЛЕНИЕ(ВЗ_Запрос.Регистратор) КАК ДокПредставление,
		                  	|	ВЫРАЗИТЬ(ВЗ_Запрос.Регистратор КАК Документ.ПередачаОС).Дата КАК Дата
							|ИЗ
							|	(ВЫБРАТЬ
							|		ХозрасчетныйДвиженияССубконто.Сумма КАК Сумма,
							|		ХозрасчетныйДвиженияССубконто.Регистратор КАК Регистратор
							|	ИЗ
							|		РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг
							|				И СчетКт = &Счет91_01,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто
							|	ГДЕ ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.ПередачаОС) КАК ВЗ_Запрос
                            |
							|СГРУППИРОВАТЬ ПО
							|	ВЗ_Запрос.Регистратор,
							|	ВЫРАЗИТЬ(ВЗ_Запрос.Регистратор КАК Документ.ПередачаОС).Дата
							//+
							//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793
							|ОБЪЕДИНИТЬ ВСЕ
							|
							|ВЫБРАТЬ
							|	СУММА(ХозрасчетныйДвиженияССубконто.Сумма) КАК Сумма,
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйДвиженияССубконто.Регистратор),
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата КАК Дата
							|ИЗ
							|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
							|			&ДатаНач,
							|			&ДатаКон,
							|			Организация = &Орг 
							|				И СчетДт = &СчетДт
							|				И СчетКт = &Счет91_01,
							|			,
							|			) КАК ХозрасчетныйДвиженияССубконто						
							|ГДЕ ХозрасчетныйДвиженияССубконто.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг И СубконтоКт1 = &СтатьяРеализацияОС  
	                        |
							|СГРУППИРОВАТЬ ПО
							|	ХозрасчетныйДвиженияССубконто.Регистратор,
							|	ВЫРАЗИТЬ(ХозрасчетныйДвиженияССубконто.Регистратор КАК Документ.РеализацияТоваровУслуг).Дата";
						//---АК Susk (Суслин К.В.) 	
							
		ВыборкаБух = ЗапросБухия.Выполнить().Выбрать();
		
		Пока ВыборкаБух.Следующий() Цикл
			СтрокаДоб = ТабСопоставление.Добавить();
			СтрокаДоб.ДокБухия = ВыборкаБух.ДокПредставление;
			СтрокаДоб.Дата = ВыборкаБух.Дата;
			СтрокаДоб.СуммаБух = ВыборкаБух.Сумма;
			СтрокаДоб.СсылкаНаДок = Документы.РеализацияОС.ПолучитьСсылку(Новый УникальныйИдентификатор(v82.String(ВыборкаБух.Регистратор.УникальныйИдентификатор())));
		КонецЦикла;
		
		Если ЗначениеЗаполнено(СтруктураРасшифровки.Тип) Тогда
			ЗапросФин = Новый Запрос();
			ЗапросФин.УстановитьПараметр("Орг", Организация);
			ЗапросФин.УстановитьПараметр("ДатаНач", НачалоМесяца(МесяцСверки));
			ЗапросФин.УстановитьПараметр("ДатаКон", КонецМесяца(МесяцСверки));
			
			//+++АК Susk (Суслин К.В.) 2018.05.22 ИП-00018793	
	 
			//ЗапросФин.УстановитьПараметр("Счет1", ПланыСчетов.Финансовый.НайтиПоКоду("90.5"));
			ЗапросФин.УстановитьПараметр("Счет1", Счет90);  
			//---АК Susk (Суслин К.В.) 
			
			ЗапросФин.УстановитьПараметр("Счет2", ПланыСчетов.Финансовый.НайтиПоКоду("96.1"));
			ЗапросФин.УстановитьПараметр("Тип", СтруктураРасшифровки.Тип);
			ЗапросФин.Текст = "ВЫБРАТЬ
			                  |	СУММА(ФинансовыйДвиженияССубконто.Сумма) КАК Сумма,
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ПРЕДСТАВЛЕНИЕ(ФинансовыйДвиженияССубконто.Регистратор) КАК ДокПредставление,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата КАК Дата
			                  |ИЗ
			                  |	РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
			                  |			&ДатаНач,
			                  |			&ДатаКон,
			                  |			СчетКт В (&Счет1, &Счет2)
			                  |				И Организация = &Орг,
			                  |			,
			                  |			) КАК ФинансовыйДвиженияССубконто
			                  |ГДЕ
			                  |	ТИПЗНАЧЕНИЯ(ФинансовыйДвиженияССубконто.Регистратор) = &Тип
			                  |
			                  |СГРУППИРОВАТЬ ПО
			                  |	ФинансовыйДвиженияССубконто.Регистратор,
			                  |	ФинансовыйДвиженияССубконто.Регистратор.Дата";
								
			Выборка = ЗапросФин.Выполнить().Выбрать();
			Пока Выборка.Следующий() Цикл
				СтрокаДоб = ТабСопоставление.Найти(Выборка.Регистратор, "СсылкаНаДок");
				Если СтрокаДоб = Неопределено Тогда
					СтрокаДоб = ТабСопоставление.Добавить();
					СтрокаДоб.СсылкаНаДок = Выборка.Регистратор;
				КонецЕсли;
				СтрокаДоб.Дата = Выборка.Дата;
				СтрокаДоб.ДокФинансы = Выборка.ДокПредставление;
				СтрокаДоб.СуммаФин = Выборка.Сумма;
			КонецЦикла;	
		КонецЕсли;	
			
		ТабСопоставление.Сортировать("Дата");
		
		Макет = Отчеты.Сопоставление90_5.ПолучитьМакет("Расшифровка");
		
		Область = Макет.ПолучитьОбласть("Шапка");
		ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		
		Для Каждого СтрокаТаб Из ТабСопоставление Цикл
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.ДокФин = СтрокаТаб.ДокФинансы;
			Область.Параметры.ДоквБухии = СтрокаТаб.ДокБухия;
			Область.Параметры.СсылкаДокумент = СтрокаТаб.СсылкаНаДок;
			Область.Параметры.СуммаФин = СтрокаТаб.СуммаФин;
			Область.Параметры.СуммаБух = СтрокаТаб.СуммаБух;
			//Если СтрокаТаб.СуммаФин <> СтрокаТаб.СуммаБух Тогда
			//	Область.Область(1, 2, 1, 5).ЦветФона = Новый Цвет(255, 200, 200);
			//КонецЕсли;	
			ЭлементыФормы.ПолеРасшифровка.Вывести(Область);
		КонецЦикла;	
	КонецЕсли;	
		
КонецПроцедуры

//+++АК Susk (Суслин К.В.) 2018.06.04 ИП-00018793
Функция ПолучитьОрганизациюБух(ОргФин, Соединение)
	
	Запрос = Соединение.NewObject("Запрос");	
	Запрос.Текст = "ВЫБРАТЬ
	               |	Организации.Ссылка
	               |ИЗ
	               |	Справочник.Организации КАК Организации
	               |ГДЕ
	               |	Организации.ИНН = &ИНН";
	
	Запрос.УстановитьПараметр("ИНН", ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ОргФин, "ИНН"));
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		Возврат Выборка.Ссылка;
	Иначе
		Возврат Соединение.Справочники.Организации.ПустаяСсылка();
	КонецЕсли;	                                                          
	
КонецФункции

