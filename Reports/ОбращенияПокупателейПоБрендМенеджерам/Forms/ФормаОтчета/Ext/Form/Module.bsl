
#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура КомандаВыполнитьРассылку(Команда)
	ВыполнитьРассылкуНаСервере();
КонецПроцедуры

#КонецОбласти          


#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура ВыполнитьРассылкуНаСервере()
	
	СтруктураПараметров = Новый Структура();
	
	Для каждого ТекущаяНастройка  Из Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл
		Если ТипЗнч(ТекущаяНастройка) = Тип("ЗначениеПараметраНастроекКомпоновкиДанных") Тогда
			Если ТекущаяНастройка.Использование И СокрЛП(ТекущаяНастройка.Параметр) = "Период" Тогда
				СтруктураПараметров.Вставить("Период", ТекущаяНастройка.Значение);
			ИначеЕсли ТекущаяНастройка.Использование И СокрЛП(ТекущаяНастройка.Параметр) = "ТипЖалобы" Тогда
				СтруктураПараметров.Вставить("ТипЖалобы", ТекущаяНастройка.Значение);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	ОтчетОбъект = РеквизитФормыВЗначение("Отчет");
	
	ОтчетОбъект.ВыполнитьРассылкуОбращенийПоТипуЖалобыБрендМенеджерам(СтруктураПараметров);
	
КонецПроцедуры

#КонецОбласти

