
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Для Каждого ЭлементПоставщик Из Параметры.Поставщики Цикл
		СтрокаТаб = Поставщики.Добавить();
		СтрокаТаб.Поставщик = ЭлементПоставщик.Значение;
	КонецЦикла;
	
	Номенклатура = Параметры.Номенклатура;
	
КонецПроцедуры

Функция ПолучитьСписокПоставщиков()
	
	СписокВыбора = Новый Массив();
	
	Запрос = Новый Запрос();
	Запрос.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
	               |	ЗначенияСвойствОбъектов.Значение КАК Значение,
	               |	ХарактеристикиСпр.Владелец.Наименование
	               |ИЗ
	               |	Справочник.ХарактеристикиНоменклатуры КАК ХарактеристикиСпр
	               |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	               |		ПО ХарактеристикиСпр.Ссылка = ЗначенияСвойствОбъектов.Объект
	               |			И (ЗначенияСвойствОбъектов.Свойство = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СвойстваОбъектов.Производитель))
	               |ГДЕ
	               |	ХарактеристикиСпр.Владелец В(&Номенклатура)
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	ХарактеристикиСпр.Владелец.Наименование";
				   
	Запрос.УстановитьПараметр("Номенклатура", Номенклатура);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		СписокВыбора.Добавить(Выборка.Значение);
	КонецЦикла;
	
	Возврат СписокВыбора;
	
КонецФункции	

&НаКлиенте
Процедура ПоставщикиПоставщикНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	
	//СтандартнаяОбработка = Ложь;
	
	Если Номенклатура.Количество() = 0 Тогда
		Элемент.СписокВыбора.Очистить();
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Для выбора поставщика из списка следует сначала заполнить отбор номенклатуры");
	Иначе	
		Элемент.СписокВыбора.ЗагрузитьЗначения(ПолучитьСписокПоставщиков());
	КонецЕсли;	
	
КонецПроцедуры

&НаКлиенте
Процедура ПриЗакрытии()
	
	СписокЗначений = Новый СписокЗначений();
	Для Каждого СтрокаТаб Из Поставщики Цикл
		СписокЗначений.Добавить(СтрокаТаб.Поставщик);
	КонецЦикла;	
	ОповеститьОВыборе(СписокЗначений);
	
КонецПроцедуры
