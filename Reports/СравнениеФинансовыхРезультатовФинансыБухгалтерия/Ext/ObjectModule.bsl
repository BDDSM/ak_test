
#Область ОбработчикиСобытий

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	ДокументРезультат.Очистить();
	
	РезультатРасшифровкиБух.Очистить();
	РезультатРасшифровкиФин.Очистить();
	
	СформироватьОтчет(ДокументРезультат, ДанныеРасшифровки);
	
КонецПроцедуры //--- AK suvv

#КонецОбласти

#Область ВспомогательныеПроцедурыПолученияОборотовОтчета

//+++ AK suvv 2018.08.24 ИП-00019211.01
// разделы "Выручка", "Прочие доходы", "Финансовые доходы" объединяются в раздел "ДОХОДЫ"
// разделы "Себестоимость", "Коммерческие расходы", "Расходы прочие", "Финансовые расходы" объединяются в раздел "РАСХОДЫ"
Процедура ПодготовитьТаблицуДляВидаОтчета1(ТаблицаДляОбработки)
	
	Для Каждого Стр из ТаблицаДляОбработки Цикл
		
		Если Стр.ИтоговыйРаздел_1    = "	ВАЛОВАЯ ПРИБЫЛЬ" и Стр.Раздел = "ВЫРУЧКА" 
			или Стр.ИтоговыйРаздел_1 = "	ДОХОДЫ ПРОЧИЕ" и Стр.Раздел = "ПРОЧИЕ ДОХОДЫ"
			или Стр.ИтоговыйРаздел_1 = "	ЧИСТЫЕ ФИНАНСОВЫЕ РАСХОДЫ" и Стр.Раздел = "ФИНАНСОВЫЕ ДОХОДЫ"
			Тогда 
			Стр.ИтоговыйРаздел_1         = "ДОХОДЫ";
			Стр.ИтоговыйРаздел_1_Порядок = 0;	
		ИначеЕсли Стр.ИтоговыйРаздел_1 = "	ВАЛОВАЯ ПРИБЫЛЬ" и Стр.Раздел = "СЕБЕСТОИМОСТЬ" 
			или Стр.ИтоговыйРаздел_1   = "	КОММЕРЧЕСКИЕ РАСХОДЫ" и Стр.Раздел = "РАСХОДЫ" 
			или Стр.ИтоговыйРаздел_1   = "	РАСХОДЫ ПРОЧИЕ" и Стр.Раздел = "РАСХОДЫ"
			или Стр.ИтоговыйРаздел_1   = "	ЧИСТЫЕ ФИНАНСОВЫЕ РАСХОДЫ" и Стр.Раздел = "ФИНАНСОВЫЕ РАСХОДЫ" 
			Тогда 
			Стр.ИтоговыйРаздел_1         = "РАСХОДЫ";
			Стр.ИтоговыйРаздел_1_Порядок = 0;
		КонецЕсли;	
		
	КонецЦикла;
	
КонецПроцедуры//--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция ПолучитьСоединениеСБазойБух()
	
	Перем ПодключениеУстановлено;
	
	Соединение = Неопределено;
	
	Соединение = ОбменСБП2_0.ВернутьПодключениеКБазеБУ(ПодключениеУстановлено);	
	
	Если Не ПодключениеУстановлено Тогда 
		ВызватьИсключение "Ошибка подключения к базе БУХ";
	КонецЕсли;
	
	Возврат Соединение;
	
КонецФункции //--- AK suvv

#КонецОбласти

#Область ФормированиеОтчета

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура СформироватьОтчет(ДокументРезультат, ДанныеРасшифровки)
	
	ОрганизацииОтчета   = ЗначениеПараметраКД("Организации");	
	ПериодОтчета        = ЗначениеПараметраКД("ПериодОтчета");		 
	НачалоПериода       = НачалоДня(ПериодОтчета.ДатаНачала);
	КонецПериода        = КонецДня(ПериодОтчета.ДатаОкончания);
	ВидОтчета           = ЗначениеПараметраКД("ВидОтчета");;
	
	ДанныеСравнения     = ПолучитьДанныеСравненияОборотов(НачалоПериода, КонецПериода, ОрганизацииОтчета, ВидОтчета);
	
	ОрганизацииСтрокой = "";
	Для Каждого Орг из ОрганизацииОтчета цикл
		ОрганизацииСтрокой = ОрганизацииСтрокой + Орг.Значение.Наименование + ", ";
	КонецЦикла;
	ОрганизацииСтрокой = ?(ОрганизацииСтрокой <> "",Лев(ОрганизацииСтрокой, СтрДлина(ОрганизацииСтрокой) - 2), ОрганизацииСтрокой); 	
	
	ЗаголовокОтчета    = "Анализ фин. результатов ""Финансы""/""Бухгалтерия"" с " + Формат(НачалоПериода,"ДФ=dd.MM.yyyy") + " по " + Формат(КонецПериода, "ДФ=dd.MM.yyyy") + Символы.ПС + "по организациям " + ОрганизацииСтрокой;
	
	ЗаполнитьТабличныйДокумент(ВидОтчета, ДокументРезультат, ДанныеРасшифровки, ДанныеСравнения, ЗаголовокОтчета);
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция ПолучитьДанныеСравненияОборотов(НачалоПериода, КонецПериода, ОрганизацииОтчета, ВидОтчета)
	
	НазванияОрганизаций = Новый Массив;
	Для Каждого Орг из ОрганизацииОтчета цикл
		НазванияОрганизаций.Добавить(Орг.Значение.Наименование);
	КонецЦикла;
	
	ОборотыФин = ОборотыВФинБазе(НачалоПериода, КонецПериода, ОрганизацииОтчета,   ВидОтчета);
	ОборотыБух = ОборотыВБухБазе(НачалоПериода, КонецПериода, НазванияОрганизаций, ВидОтчета);	
	
	Если ВидОтчета = 1 Тогда 
		Различия = СравнитьРасшифровкиФинБух();
	Иначе
		Различия = СравнитьОборотыФинБух(ОборотыФин, ОборотыБух);
	КонецЕсли;
	
	Возврат Различия;
	
КонецФункции //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция СравнитьОборотыФинБух(ОборотыФин, ОборотыБух)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ОборотыФин", ОборотыФин);
	Запрос.УстановитьПараметр("ОборотыБух", ОборотыБух);
	Запрос.Текст = "ВЫБРАТЬ
	|	ОборотыБух.ИтоговыйРаздел_1,
	|	ОборотыБух.ИтоговыйРаздел_1_Порядок,
	|	ОборотыБух.Раздел,
	|	ОборотыБух.Раздел_Порядок,
	|	ОборотыБух.СтатьяДР,
	|	ОборотыБух.Сумма
	|ПОМЕСТИТЬ ВТ_ОборотыБух
	|ИЗ
	|	&ОборотыБух КАК ОборотыБух
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОборотыФин.ИтоговыйРаздел_1,
	|	ОборотыФин.ИтоговыйРаздел_1_Порядок,
	|	ОборотыФин.Раздел,
	|	ОборотыФин.Раздел_Порядок,
	|	ОборотыФин.Аналитика_1,
	|	ОборотыФин.Аналитика_2,
	|	ОборотыФин.СуммаМСФО
	|ПОМЕСТИТЬ ВТ_ОборотыФин
	|ИЗ
	|	&ОборотыФин КАК ОборотыФин
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОборотыФин.ИтоговыйРаздел_1,
	|	ВТ_ОборотыФин.ИтоговыйРаздел_1_Порядок,
	|	ВТ_ОборотыФин.Раздел,
	|	ВТ_ОборотыФин.Раздел_Порядок,
	|	ВТ_ОборотыФин.Аналитика_1,
	|	ВТ_ОборотыФин.Аналитика_2,
	|	ВТ_ОборотыФин.СуммаМСФО КАК СуммаФин,
	|	NULL КАК СтатьяДР,
	|	0 КАК СуммаБух
	|ПОМЕСТИТЬ ВТ_ОбъединениеФинБух
	|ИЗ
	|	ВТ_ОборотыФин КАК ВТ_ОборотыФин
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1,
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1_Порядок,
	|	ВТ_ОборотыБух.Раздел,
	|	ВТ_ОборотыБух.Раздел_Порядок,
	|	NULL,
	|	NULL,
	|	0,
	|	ВТ_ОборотыБух.СтатьяДР,
	|	ВТ_ОборотыБух.Сумма
	|ИЗ
	|	ВТ_ОборотыБух КАК ВТ_ОборотыБух
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1,
	|	ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1_Порядок,
	|	ВТ_ОбъединениеФинБух.Раздел,
	|	ВТ_ОбъединениеФинБух.Раздел_Порядок,
	|	ВТ_ОбъединениеФинБух.Аналитика_1,
	|	ВТ_ОбъединениеФинБух.Аналитика_2,
	|	ВТ_ОбъединениеФинБух.СтатьяДР,
	|	ВТ_ОбъединениеФинБух.СуммаФин,
	|	ВТ_ОбъединениеФинБух.СуммаБух,
	|	ВТ_ОбъединениеФинБух.СуммаФин - ВТ_ОбъединениеФинБух.СуммаБух КАК СуммаРазница
	|ИЗ
	|	ВТ_ОбъединениеФинБух КАК ВТ_ОбъединениеФинБух";
	
	Результат = Запрос.Выполнить().Выгрузить();
	
	Возврат Результат;	
	
КонецФункции //--- AK suvv

//+++ AK suvv 2018.09.19 ИП-00019211.01
Функция СравнитьРасшифровкиФинБух()
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("РезультатРасшифровкиФин", РезультатРасшифровкиФин);
	Запрос.УстановитьПараметр("РезультатРасшифровкиБух", РезультатРасшифровкиБух);
	Запрос.Текст = "ВЫБРАТЬ
	|	РезультатРасшифровкиБух.ОрганизацияНаименование,
	|	РезультатРасшифровкиБух.ИтоговыйРаздел_1,
	|	РезультатРасшифровкиБух.Аналитика_1,
	|	РезультатРасшифровкиБух.СтатьяДР,
	|	РезультатРасшифровкиБух.Сумма
	|ПОМЕСТИТЬ ВТ_ОборотыБух
	|ИЗ
	|	&РезультатРасшифровкиБух КАК РезультатРасшифровкиБух
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РезультатРасшифровкиФин.ОрганизацияНаименование,
	|	РезультатРасшифровкиФин.ИтоговыйРаздел_1,
	|	РезультатРасшифровкиФин.Аналитика_1,
	|	РезультатРасшифровкиФин.СтатьяДР,
	|	РезультатРасшифровкиФин.СуммаМСФО
	|ПОМЕСТИТЬ ВТ_ОборотыФин
	|ИЗ
	|	&РезультатРасшифровкиФин КАК РезультатРасшифровкиФин
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОборотыФин.ИтоговыйРаздел_1,
	|	ВТ_ОборотыФин.Аналитика_1,
	|	ВТ_ОборотыФин.СтатьяДР,
	|	ВТ_ОборотыФин.СуммаМСФО КАК СуммаФин,
	|	0 КАК СуммаБух
	|ПОМЕСТИТЬ ВТ_ОбъединениеФинБух
	|ИЗ
	|	ВТ_ОборотыФин КАК ВТ_ОборотыФин
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1,
	|	ВТ_ОборотыБух.Аналитика_1,
	|	ВТ_ОборотыБух.СтатьяДР,
	|	0,
	|	ВТ_ОборотыБух.Сумма
	|ИЗ
	|	ВТ_ОборотыБух КАК ВТ_ОборотыБух
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.Аналитика_1 = """"
	|				ИЛИ ВТ_ОбъединениеФинБух.Аналитика_1 = ЗНАЧЕНИЕ(Справочник.СтатьиДоходовРасходов.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА NULL
	|		ИНАЧЕ ВТ_ОбъединениеФинБух.Аналитика_1
	|	КОНЕЦ КАК Аналитика_1,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.СтатьяДР = ЗНАЧЕНИЕ(Справочник.ПрочиеДоходыИРасходыБУ.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.СтатьяДР = ЗНАЧЕНИЕ(Справочник.СтатьиЗатратБУ.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА NULL
	|		ИНАЧЕ ВТ_ОбъединениеФинБух.СтатьяДР
	|	КОНЕЦ КАК СтатьяДР,
	|	СУММА(ВТ_ОбъединениеФинБух.СуммаФин) КАК СуммаФин,
	|	СУММА(ВТ_ОбъединениеФинБух.СуммаБух) КАК СуммаБух,
	|	СУММА(ВТ_ОбъединениеФинБух.СуммаФин - ВТ_ОбъединениеФинБух.СуммаБух) КАК СуммаРазница,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ДОХОДЫ""
	|			ТОГДА 1
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""РАСХОДЫ""
	|			ТОГДА 2
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|			ТОГДА 3
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ""
	|			ТОГДА 4
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|			ТОГДА 5
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА 6
	|		ИНАЧЕ 7
	|	КОНЕЦ КАК ИтоговыйРаздел_1_Порядок,
	|	"""" КАК Раздел,
	|	1 КАК Раздел_Порядок,
	|	"""" КАК Аналитика_2
	|ИЗ
	|	ВТ_ОбъединениеФинБух КАК ВТ_ОбъединениеФинБух
	|ГДЕ
	|	(ВТ_ОбъединениеФинБух.СуммаФин <> 0
	|			ИЛИ ВТ_ОбъединениеФинБух.СуммаБух <> 0)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.Аналитика_1 = """"
	|				ИЛИ ВТ_ОбъединениеФинБух.Аналитика_1 = ЗНАЧЕНИЕ(Справочник.СтатьиДоходовРасходов.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА NULL
	|		ИНАЧЕ ВТ_ОбъединениеФинБух.Аналитика_1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.СтатьяДР = ЗНАЧЕНИЕ(Справочник.ПрочиеДоходыИРасходыБУ.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.СтатьяДР = ЗНАЧЕНИЕ(Справочник.СтатьиЗатратБУ.ПустаяСсылка)
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|				ИЛИ ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА NULL
	|		ИНАЧЕ ВТ_ОбъединениеФинБух.СтатьяДР
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ДОХОДЫ""
	|			ТОГДА 1
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""РАСХОДЫ""
	|			ТОГДА 2
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|			ТОГДА 3
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ""
	|			ТОГДА 4
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ""
	|			ТОГДА 5
	|		КОГДА ВТ_ОбъединениеФинБух.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ""
	|			ТОГДА 6
	|		ИНАЧЕ 7
	|	КОНЕЦ";
	
	Результат = Запрос.Выполнить().Выгрузить();
	
	Возврат Результат;	
	
	
КонецФункции

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ЗаполнитьТабличныйДокумент(ВидОтчета, ТабличныйДокумент, ДанныеРасшифровки, ДанныеСравнения, Заголовок)
	
	СхемаКД					= СхемаКомпоновкиДанных;
	КомпоновщикНастроекКД	= КомпоновщикНастроек;
	
	Если ВидОтчета = 1 Тогда
		КомпоновщикНастроекКД.ЗагрузитьНастройки(СхемаКД.ВариантыНастроек.Краткий.Настройки);
	Иначе
		КомпоновщикНастроекКД.ЗагрузитьНастройки(СхемаКД.ВариантыНастроек.Подробный.Настройки);
	КонецЕсли;
	
	КомпоновщикНастроекКД.Настройки.ПараметрыВывода.УстановитьЗначениеПараметра("Заголовок", Заголовок);
	ВнешниеНаборыДанных = Новый Структура("ДанныеСравнения", ДанныеСравнения);
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКД, КомпоновщикНастроекКД.ПолучитьНастройки(), ДанныеРасшифровки);
	
	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки);
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ТабличныйДокумент);
	
	ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);
	
КонецПроцедуры //--- AK suvv

// ПОЛУЧЕНИЕ ОБОРОТОВ ПО БАЗЕ "ФИНАНСЫ"

//+++ AK suvv 2018.09.19 ИП-00019211.01
Процедура ЗаполнитьРезультатРасшифровкиФин(ОборотыВФинБазе);
	
	РезультатРасшифровки_Фин = ОборотыВФинБазе.Скопировать();
	РезультатРасшифровки_Фин.Свернуть("ОрганизацияНаименование, ИтоговыйРаздел_1, Аналитика_1, Аналитика_2", "СуммаМСФО");
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("РезультатРасшифровкиФин", РезультатРасшифровки_Фин);
	Запрос.Текст = "ВЫБРАТЬ
	|	РезультатРасшифровкиФин.ОрганизацияНаименование,
	|	РезультатРасшифровкиФин.ИтоговыйРаздел_1,
	|	РезультатРасшифровкиФин.Аналитика_1,
	|	РезультатРасшифровкиФин.СуммаМСФО,
	|	РезультатРасшифровкиФин.Аналитика_2
	|ПОМЕСТИТЬ ВТ_РезультатРасшифровкиФин
	|ИЗ
	|	&РезультатРасшифровкиФин КАК РезультатРасшифровкиФин
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_РезультатРасшифровкиФин.ОрганизацияНаименование,
	|	""УСЛОВНЫЙ НАЛОГ НА ПРИБЫЛЬ"" КАК ИтоговыйРаздел_1,
	|	ВТ_РезультатРасшифровкиФин.Аналитика_1,
	|	ВТ_РезультатРасшифровкиФин.СуммаМСФО * 20 / 100 * -1 КАК СуммаМСФО,
	|	ВТ_РезультатРасшифровкиФин.Аналитика_2
	|ПОМЕСТИТЬ ВТ_УсловныйНалогНаПрибыль
	|ИЗ
	|	ВТ_РезультатРасшифровкиФин КАК ВТ_РезультатРасшифровкиФин
	|ГДЕ
	|	ВТ_РезультатРасшифровкиФин.ИтоговыйРаздел_1 = ""ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ""
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_РезультатРасшифровкиФин.ОрганизацияНаименование,
	|	ВТ_РезультатРасшифровкиФин.ИтоговыйРаздел_1,
	|	ВТ_РезультатРасшифровкиФин.Аналитика_1,
	|	ВТ_РезультатРасшифровкиФин.СуммаМСФО,
	|	ВТ_РезультатРасшифровкиФин.Аналитика_2
	|ПОМЕСТИТЬ ВТ_ВсеРазделы
	|ИЗ
	|	ВТ_РезультатРасшифровкиФин КАК ВТ_РезультатРасшифровкиФин
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_УсловныйНалогНаПрибыль.ОрганизацияНаименование,
	|	ВТ_УсловныйНалогНаПрибыль.ИтоговыйРаздел_1,
	|	ВТ_УсловныйНалогНаПрибыль.Аналитика_1,
	|	ВТ_УсловныйНалогНаПрибыль.СуммаМСФО,
	|	ВТ_УсловныйНалогНаПрибыль.Аналитика_2
	|ИЗ
	|	ВТ_УсловныйНалогНаПрибыль КАК ВТ_УсловныйНалогНаПрибыль
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ВсеРазделы.ОрганизацияНаименование,
	|	ВТ_ВсеРазделы.ИтоговыйРаздел_1,
	|	ЕСТЬNULL(ВТ_ВсеРазделы.Аналитика_2, ВТ_ВсеРазделы.Аналитика_1) КАК Аналитика_1,
	|	ВТ_ВсеРазделы.СуммаМСФО,
	|	МАКСИМУМ(СоответствиеСтатейДРСтатьямБУ.СтатьяБУ) КАК СтатьяДР
	|ИЗ
	|	ВТ_ВсеРазделы КАК ВТ_ВсеРазделы
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СоответствиеСтатейДРСтатьямБУ КАК СоответствиеСтатейДРСтатьямБУ
	|		ПО (ЕСТЬNULL(ВТ_ВсеРазделы.Аналитика_2, ВТ_ВсеРазделы.Аналитика_1) = СоответствиеСтатейДРСтатьямБУ.Статья)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ВсеРазделы.ИтоговыйРаздел_1,
	|	ВТ_ВсеРазделы.ОрганизацияНаименование,
	|	ВТ_ВсеРазделы.СуммаМСФО,
	|	ЕСТЬNULL(ВТ_ВсеРазделы.Аналитика_2, ВТ_ВсеРазделы.Аналитика_1)";
	
	РезультатРасшифровкиФин.Загрузить(Запрос.Выполнить().Выгрузить());
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура УстановитьЗначенияПараметровИОтборы(НастройкиСКД_ОПУ, НачалоПериода, КонецПериода, Организации)
	
	ПараметрыДанныхСКД_ОПУ = НастройкиСКД_ОПУ.ПараметрыДанных.Элементы;
	
	ЭлементНачалоПериода = ПараметрыДанныхСКД_ОПУ.Найти("НачалоПериода");
	ЭлементНачалоПериода.Использование = Истина;
	ЭлементНачалоПериода.Значение      = НачалоПериода;
	
	ЭлементКонецПериода = ПараметрыДанныхСКД_ОПУ.Найти("КонецПериода");
	ЭлементКонецПериода.Использование = Истина;
	ЭлементКонецПериода.Значение      = КонецПериода;
	
	ЭлементКонсолидированнаяОтчетность = ПараметрыДанныхСКД_ОПУ.Найти("КонсолидированнаяОтчетность");
	ЭлементКонсолидированнаяОтчетность.Использование = Истина;
	ЭлементКонсолидированнаяОтчетность.Значение      = Истина;
	
	ЭлементОрганизацииКО = ПараметрыДанныхСКД_ОПУ.Найти("ОрганизацииКО");
	ЭлементОрганизацииКО.Использование = Истина;
	ЭлементОрганизацииКО.Значение      = Список(ОтчетностьМСФО.ОрганизацииКонсолидированныйБаланс());
	
	ОтборыСКД_ОПУ = НастройкиСКД_ОПУ.Отбор.Элементы;
	УстановитьОтборСКД(ОтборыСКД_ОПУ, "Организация", ВидСравненияКомпоновкиДанных.ВСписке, Организации);
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция ОборотыВФинБазе(НачалоПериода, КонецПериода, Организации, ВидОтчета)
	
	//заполнение таблицы "ОборотыВФинБазе" с колонками:
	//"ОрганизацияНаименование", "ИтоговыйРаздел_1", "ИтоговыйРаздел_1_Порядок", "Раздел", "Раздел_Порядок",
	//"Аналитика1", "Аналитика1Наименование", "Аналитика2", "Аналитика2Наименование", "СуммаМСФО"
	
	СКД_ОПУ          = Отчеты.ОтчетОПрибыляхИУбыткахМСФО.ПолучитьМакет("СКДДляСравнительногоАнализа");		
	НастройкиСКД_ОПУ = СКД_ОПУ.НастройкиПоУмолчанию;	
	
	УстановитьЗначенияПараметровИОтборы(НастройкиСКД_ОПУ, НачалоПериода, КонецПериода, Организации);
	
	КомпоновщикМакетаОПУ     = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновкиДанныхОПУ = КомпоновщикМакетаОПУ.Выполнить(СКД_ОПУ, НастройкиСКД_ОПУ, , , Тип("ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений"));	
	
	ПроцессорКомпоновкиДанныхОПУ = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанныхОПУ.Инициализировать(МакетКомпоновкиДанныхОПУ, , , Истина);
	
	ОборотыВФинБазе    = Новый ТаблицаЗначений;
	ПроцессорВыводаОПУ = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;	
	ПроцессорВыводаОПУ.УстановитьОбъект(ОборотыВФинБазе);
	ПроцессорВыводаОПУ.Вывести(ПроцессорКомпоновкиДанныхОПУ);
	
	Если ВидОтчета = 1 Тогда 
		
		ПодготовитьТаблицуДляВидаОтчета1(ОборотыВФинБазе);
		
		ЗаполнитьРезультатРасшифровкиФин(ОборотыВФинБазе);
		
	КонецЕсли;
	
	Возврат ОборотыВФинБазе;
	
КонецФункции //--- AK suvv

// ПОЛУЧЕНИЕ ОБОРОТОВ ПО БАЗЕ "БУХГАЛТЕРИЯ"

//+++ AK suvv 2018.09.19 ИП-00019211.01
Процедура ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, ИмяРаздела, СтатьяДР, Сумма)
	
	НовСтрока = РезультатРасшифровки.Добавить(); 
	НовСтрока.НазваниеОрганизации = НазваниеОрганизации;
	НовСтрока.ИмяРаздела          = ИмяРаздела;
	НовСтрока.СтатьяДР            = СтатьяДР;
	НовСтрока.Сумма               = Сумма;
	
КонецПроцедуры

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, ИмяРаздела, СтатьяДР, СтатьяДРКод, ЭтоСтатьяЗатрат, Сумма)
	
	НовСтрока = РезультатРасшифровкиБух.Добавить(); 
	НовСтрока.ОрганизацияНаименование = НазваниеОрганизации;
	НовСтрока.ИтоговыйРаздел_1        = ИмяРаздела;
	НовСтрока.СтатьяДР                = СтатьяДР;
	НовСтрока.СтатьяДРКод             = СтатьяДРКод;
	НовСтрока.ЭтоСтатьяЗатрат         = ЭтоСтатьяЗатрат;
	НовСтрока.Сумма                   = Сумма;
	
КонецПроцедуры

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ЗаполнитьТаблицуОборотыВБухБазе(ОборотыВБухБазе, ДанныеБух, НазваниеОрганизации, ВидОтчета)
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "	ВАЛОВАЯ ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 0;
	НовСтрока.Раздел                   = "ВЫРУЧКА";
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Выручка";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100211004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "ДОХОДЫ", "Выручка", "", Ложь, Число(ДанныеБух.П000100211004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "	ВАЛОВАЯ ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 0;
	НовСтрока.Раздел                   = "СЕБЕСТОИМОСТЬ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Себестоимость продаж";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100212004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ", "Себестоимость продаж", "", Ложь, Число(ДанныеБух.П000100212004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "	КОММЕРЧЕСКИЕ РАСХОДЫ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 1;
	НовСтрока.Раздел                   = "РАСХОДЫ";
	НовСтрока.Раздел_Порядок           = 3;
	НовСтрока.СтатьяДР                 = "Коммерческие расходы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100221004);
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "	ДОХОДЫ ПРОЧИЕ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 2;
	НовСтрока.Раздел                   = "ПРОЧИЕ ДОХОДЫ";
	НовСтрока.Раздел_Порядок           = 4;
	НовСтрока.СтатьяДР                 = "Прочие доходы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100234004);
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "	РАСХОДЫ ПРОЧИЕ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 3;
	НовСтрока.Раздел                   = "РАСХОДЫ";
	НовСтрока.Раздел_Порядок           = 5;
	НовСтрока.СтатьяДР                 = "Прочие расходы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100235004);
	
	//++ РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ = Валовая прибыль (Выручка - Себестоимость) - Коммерческие расходы + Прочие доходы - Прочие Расходы
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 4;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Выручка";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100211004);
	Если ВидОтчета <> 1 Тогда
		ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, НовСтрока.ИтоговыйРаздел_1, НовСтрока.СтатьяДР, НовСтрока.Сумма);
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 4;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Себестоимость продаж";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100212004);
	Если ВидОтчета <> 1 Тогда
		ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, НовСтрока.ИтоговыйРаздел_1, НовСтрока.СтатьяДР, НовСтрока.Сумма);
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 4;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Коммерческие расходы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100221004);
	Если ВидОтчета <> 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, НовСтрока.ИтоговыйРаздел_1, НовСтрока.СтатьяДР, НовСтрока.Сумма);
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 4;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Прочие доходы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100234004);
	Если ВидОтчета <> 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, НовСтрока.ИтоговыйРаздел_1, НовСтрока.СтатьяДР, НовСтрока.Сумма);
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "РЕЗУЛЬТАТЫ ОПЕРАЦИОННОЙ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 4;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 0;
	НовСтрока.СтатьяДР                 = "Прочие расходы";	
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100235004);
	Если ВидОтчета <> 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровки(НазваниеОрганизации, НовСтрока.ИтоговыйРаздел_1, НовСтрока.СтатьяДР, НовСтрока.Сумма);
	КонецЕсли;
	//--
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "	ЧИСТЫЕ ФИНАНСОВЫЕ РАСХОДЫ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 5;
	НовСтрока.Раздел                   = "ФИНАНСОВЫЕ ДОХОДЫ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Проценты полученные";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100232004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "ДОХОДЫ", "Проценты к получению (уплате)", "00033", Ложь, Число(ДанныеБух.П000100232004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "	ЧИСТЫЕ ФИНАНСОВЫЕ РАСХОДЫ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 5;
	НовСтрока.Раздел                   = "ФИНАНСОВЫЕ РАСХОДЫ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Проценты к уплате";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100233004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ", "Проценты к уплате", "", Ложь, Число(ДанныеБух.П000100233004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 7;
	НовСтрока.Раздел                   = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Налог на прибыль (упр)";
	НовСтрока.Сумма                     = Число(ДанныеБух.П000100241004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ", "Налог на прибыль (упр)", "", Ложь, Число(ДанныеБух.П000100241004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 7;
	НовСтрока.Раздел                   = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Отложенные налоговые активы";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100245004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ", "Отложенные налоговые активы", "", Ложь, Число(ДанныеБух.П000100245004)); 
	КонецЕсли;

	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 7;
	НовСтрока.Раздел                   = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Отложенные налоговые обязательства";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100243004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ", "Отложенные налоговые обязательства", "", Ложь, Число(ДанныеБух.П000100243004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 7;
	НовСтрока.Раздел                   = "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ";
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "Прочее";
	НовСтрока.Сумма                    = Число(ДанныеБух.П000100246004);
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "РАСХОДЫ ПО НАЛОГУ НА ПРИБЫЛЬ", "Прочее", "", Ложь, Число(ДанныеБух.П000100246004)); 
	КонецЕсли;
	
	НовСтрока = ОборотыВБухБазе.Добавить();
	НовСтрока.ИтоговыйРаздел_1         = "ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 6;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ";
	// AK suvv сумма в регл. отчете округляется; выполняем свой расчет
	//НовСтрока.Сумма                    = Число(ДанныеБух.П000100230004);
	ПрибыльУбытокДоНалогообложения     = Число(ДанныеБух.П000100211004) + Число(ДанныеБух.П000100234004) + Число(ДанныеБух.П000100232004) + Число(ДанныеБух.П000100212004) + Число(ДанныеБух.П000100221004) + Число(ДанныеБух.П000100235004) + Число(ДанныеБух.П000100233004);
	НовСтрока.Сумма                    = ПрибыльУбытокДоНалогообложения;
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ", "ПРИБЫЛЬ/УБЫТОК ДО НАЛОГООБЛОЖЕНИЯ", "", Ложь, ПрибыльУбытокДоНалогообложения); 
	КонецЕсли;

	НовСтрока = ОборотыВБухБазе.Добавить();	
	НовСтрока.ИтоговыйРаздел_1         = "ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ";
	НовСтрока.ИтоговыйРаздел_1_Порядок = 8;
	НовСтрока.Раздел                   = Null;
	НовСтрока.Раздел_Порядок           = 1;
	НовСтрока.СтатьяДР                 = "ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ";
	// AK suvv сумма в регл. отчете округляется; выполняем свой расчет
	//НовСтрока.Сумма                    = Число(ДанныеБух.П000100240004);
	РасходыПоНалогуНаПрибыль = Число(ДанныеБух.П000100241004) + Число(ДанныеБух.П000100245004) + Число(ДанныеБух.П000100243004) + Число(ДанныеБух.П000100246004);
	ПрибыльУбытокОтПродолжающейсяДеятельности = ПрибыльУбытокДоНалогообложения + РасходыПоНалогуНаПрибыль;
	НовСтрока.Сумма                    = ПрибыльУбытокОтПродолжающейсяДеятельности;
	Если ВидОтчета = 1 Тогда 
		ДобавитьСтрокуВРезультатРасшифровкиБух(НазваниеОрганизации, "ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ", "ПРИБЫЛЬ/УБЫТОК ОТ ПРОДОЛЖАЮЩЕЙСЯ ДЕЯТЕЛЬНОСТИ", "", Ложь, ПрибыльУбытокОтПродолжающейсяДеятельности); 
	КонецЕсли;
			
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.09.03 ИП-00019211.01
Процедура ДоработатьРезультатРасшифровкиБух()
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("РезультатРасшифровкиБух", РезультатРасшифровкиБух.Выгрузить());
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	РезультатРасшифровкиБух.ОрганизацияНаименование,
	|	РезультатРасшифровкиБух.ИтоговыйРаздел_1,
	|	РезультатРасшифровкиБух.СтатьяДР,
	|	РезультатРасшифровкиБух.СтатьяДРКод,
	|	РезультатРасшифровкиБух.ЭтоСтатьяЗатрат,
	|	РезультатРасшифровкиБух.Сумма
	|ПОМЕСТИТЬ ВТ_РезультатРасшифровкиБух
	|ИЗ
	|	&РезультатРасшифровкиБух КАК РезультатРасшифровкиБух
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_РезультатРасшифровкиБух.ОрганизацияНаименование,
	|	ВТ_РезультатРасшифровкиБух.ИтоговыйРаздел_1,
	|	ВТ_РезультатРасшифровкиБух.СтатьяДРКод,
	|	ВТ_РезультатРасшифровкиБух.ЭтоСтатьяЗатрат,
	|	ВТ_РезультатРасшифровкиБух.Сумма,
	|	МАКСИМУМ(ЕСТЬNULL(ВЫБОР
	|				КОГДА ВТ_РезультатРасшифровкиБух.ЭтоСтатьяЗатрат
	|					ТОГДА СтатьиЗатратБУ.Ссылка
	|				ИНАЧЕ ПрочиеДоходыИРасходыБУ.Ссылка
	|			КОНЕЦ, ВТ_РезультатРасшифровкиБух.СтатьяДР)) КАК СтатьяДР,
	|	ВТ_РезультатРасшифровкиБух.СтатьяДР КАК Аналитика_1
	|ПОМЕСТИТЬ ВТ_СтатьяДР
	|ИЗ
	|	ВТ_РезультатРасшифровкиБух КАК ВТ_РезультатРасшифровкиБух
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СтатьиЗатратБУ КАК СтатьиЗатратБУ
	|		ПО ВТ_РезультатРасшифровкиБух.СтатьяДРКод = СтатьиЗатратБУ.Код
	|			И (ВТ_РезультатРасшифровкиБух.ЭтоСтатьяЗатрат)
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ПрочиеДоходыИРасходыБУ КАК ПрочиеДоходыИРасходыБУ
	|		ПО ВТ_РезультатРасшифровкиБух.СтатьяДРКод = ПрочиеДоходыИРасходыБУ.Код
	|			И (НЕ ВТ_РезультатРасшифровкиБух.ЭтоСтатьяЗатрат)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РезультатРасшифровкиБух.ОрганизацияНаименование,
	|	ВТ_РезультатРасшифровкиБух.ИтоговыйРаздел_1,
	|	ВТ_РезультатРасшифровкиБух.ЭтоСтатьяЗатрат,
	|	ВТ_РезультатРасшифровкиБух.СтатьяДР,
	|	ВТ_РезультатРасшифровкиБух.СтатьяДРКод,
	|	ВТ_РезультатРасшифровкиБух.Сумма
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_СтатьяДР.ОрганизацияНаименование,
	|	ВТ_СтатьяДР.ИтоговыйРаздел_1,
	|	ВТ_СтатьяДР.СтатьяДРКод,
	|	ВТ_СтатьяДР.ЭтоСтатьяЗатрат,
	|	ВТ_СтатьяДР.Сумма,
	|	ВТ_СтатьяДР.СтатьяДР,
	|	ВТ_СтатьяДР.Аналитика_1,
	|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ СоответствиеСтатейДРСтатьямБУ.Статья) КАК КолвоСтатей
	|ПОМЕСТИТЬ ВТ_КолвоСтатей
	|ИЗ
	|	ВТ_СтатьяДР КАК ВТ_СтатьяДР
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СоответствиеСтатейДРСтатьямБУ КАК СоответствиеСтатейДРСтатьямБУ
	|		ПО ВТ_СтатьяДР.СтатьяДР = СоответствиеСтатейДРСтатьямБУ.СтатьяБУ
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_СтатьяДР.ОрганизацияНаименование,
	|	ВТ_СтатьяДР.ИтоговыйРаздел_1,
	|	ВТ_СтатьяДР.СтатьяДРКод,
	|	ВТ_СтатьяДР.ЭтоСтатьяЗатрат,
	|	ВТ_СтатьяДР.Сумма,
	|	ВТ_СтатьяДР.СтатьяДР,
	|	ВТ_СтатьяДР.Аналитика_1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_КолвоСтатей.ОрганизацияНаименование,
	|	ВТ_КолвоСтатей.ИтоговыйРаздел_1,
	|	ВТ_КолвоСтатей.СтатьяДРКод,
	|	ВТ_КолвоСтатей.ЭтоСтатьяЗатрат,
	|	ВТ_КолвоСтатей.Сумма,
	|	ВТ_КолвоСтатей.СтатьяДР,
	|	ВЫБОР
	|		КОГДА ВТ_КолвоСтатей.КолвоСтатей = 1
	|			ТОГДА СоответствиеСтатейДРСтатьямБУ.Статья
	|		ИНАЧЕ ВТ_КолвоСтатей.Аналитика_1
	|	КОНЕЦ КАК Аналитика_1
	|ИЗ
	|	ВТ_КолвоСтатей КАК ВТ_КолвоСтатей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СоответствиеСтатейДРСтатьямБУ КАК СоответствиеСтатейДРСтатьямБУ
	|		ПО ВТ_КолвоСтатей.СтатьяДР = СоответствиеСтатейДРСтатьямБУ.СтатьяБУ
	|			И (ВТ_КолвоСтатей.КолвоСтатей = 1)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_КолвоСтатей.ОрганизацияНаименование,
	|	ВТ_КолвоСтатей.ИтоговыйРаздел_1,
	|	ВТ_КолвоСтатей.СтатьяДРКод,
	|	ВТ_КолвоСтатей.ЭтоСтатьяЗатрат,
	|	ВТ_КолвоСтатей.Сумма,
	|	ВТ_КолвоСтатей.СтатьяДР,
	|	ВЫБОР
	|		КОГДА ВТ_КолвоСтатей.КолвоСтатей = 1
	|			ТОГДА СоответствиеСтатейДРСтатьямБУ.Статья
	|		ИНАЧЕ ВТ_КолвоСтатей.Аналитика_1
	|	КОНЕЦ";
	
	РезультатРасшифровкиБух.Загрузить(Запрос.Выполнить().Выгрузить());
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ЗаполнитьРасшифровку(Соединение, НачалоПериода, КонецПериода, НазванияОрганизаций)
	
	Запрос = Соединение.NewObject("Запрос");
	
	Запрос.Текст = "ВЫБРАТЬ
	|	ОборотыДт9007.СубконтоКт1.Наименование КАК СтатьяДР,
	|	СУММА(-1 * ОборотыДт9007.СуммаОборот) КАК Сумма,
	|	""	КОММЕРЧЕСКИЕ РАСХОДЫ"" КАК ИтоговыйРаздел_1,
	|	ОборотыДт9007.Организация.Наименование
	|ПОМЕСТИТЬ ВТ_ОборотыБух
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(&НачалоПериода, &КонецПериода, Регистратор, СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу)), , , , Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9007
	|
	|СГРУППИРОВАТЬ ПО
	|	ОборотыДт9007.СубконтоКт1.Наименование,
	|	ОборотыДт9007.Организация.Наименование
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеДоходы.СтатьяДР,
	|	СУММА(ПрочиеДоходы.Сумма),
	|	""	ДОХОДЫ ПРОЧИЕ"",
	|	ПрочиеДоходы.ОрганизацияНаименование
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОборотыКт9101.СубконтоКт1.Наименование КАК СтатьяДР,
	|		СУММА(ОборотыКт9101.СуммаОборот) КАК Сумма,
	|		ОборотыКт9101.Организация.Наименование КАК ОрганизацияНаименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				,
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				(СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСЛиквидациейОсновныхСредств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейЦенныхБумаг)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделок)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделокОР)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОтчисленияВОценочныеРезервы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РазницаМеждуПервоначальнойИНоминальнойСтоимостьюПоДолговымЦеннымБумагам)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ВозмещениеУбытковКПолучениюУплате)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницыПоРасчетамВУЕ)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СписаниеДебиторскойКредиторскойЗадолженности)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСБезвозмезднымПолучениемИмущества)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыСвязанныеСВосстановлениемАмортизационнойПремии)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КорректировкаПрибылиДоРыночныхЦен))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыКт9101
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыКт9101.СубконтоКт1.Наименование,
	|		ОборотыКт9101.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт6802.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт6802.СуммаОборот),
	|		ОборотыДт9102Кт6802.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КорректировкаПрибылиДоРыночныхЦен))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт6802
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт6802.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт6802.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт76ОТ.СуммаОборот),
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт76ОТ
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОбротыКт9901.СубконтоКт1.Наименование,
	|		СУММА(ОбротыКт9901.СуммаОборот),
	|		ОбротыКт9901.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				,
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиБезНалогаНаПрибыль)),
	|				,
	|				Организация.Наименование В (&НазванияОрганизаций)
	|					И СубконтоКт1 = ЗНАЧЕНИЕ(Перечисление.ПрибылиИУбытки.ЧрезвычайныеДоходыРасходы)) КАК ОбротыКт9901
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОбротыКт9901.СубконтоКт1.Наименование,
	|		ОбротыКт9901.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыКт9101Дт010304.СубконтоКт1.Наименование,
	|		СУММА(ОборотыКт9101Дт010304.СуммаОборот),
	|		ОборотыКт9101Дт010304.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства))
	|					ИЛИ СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ))
	|					ИЛИ СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы)),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыКт9101Дт010304
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыКт9101Дт010304.СубконтоКт1.Наименование,
	|		ОборотыКт9101Дт010304.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт0205.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт0205.СуммаОборот),
	|		ОборотыДт9102Кт0205.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств))
	|					ИЛИ СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов),
	|				,
	|				СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт0205
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт0205.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт0205.Организация.Наименование) КАК ПрочиеДоходы
	|
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеДоходы.СтатьяДР,
	|	ПрочиеДоходы.ОрганизацияНаименование
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходы.СтатьяДР,
	|	СУММА(-1 * ПрочиеРасходы.Сумма),
	|	""	РАСХОДЫ ПРОЧИЕ"",
	|	ПрочиеРасходы.ОрганизацияНаименование
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОборотыДт9102.СубконтоДт1.Наименование КАК СтатьяДР,
	|		ОборотыДт9102.СуммаОборот КАК Сумма,
	|		ОборотыДт9102.Организация.Наименование КАК ОрганизацияНаименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				,
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСУчастиемВДругихОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДолевоеУчастиеВРоссийскихОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДолевоеУчастиеВИностранныхОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСЛиквидациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейЦенныхБумаг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделокОР)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделок)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОтчисленияВОценочныеРезервы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РазницаМеждуПервоначальнойИНоминальнойСтоимостьюПоДолговымЦеннымБумагам)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыНаУслугиБанков)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ВозмещениеУбытковКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницыПоРасчетамВУЕ)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.НалогиИСборы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПремияПокупателю)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СписаниеДебиторскойКредиторскойЗадолженности)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.НДСПоСписаннойКредиторскойЗадолженности)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСБезвозмезднымПолучениемИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыПоПередачеТоваровБезвозмездноИДляСобственныхНужд)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыОтСниженияСтоимостиАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеКосвенныеРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеУбыткиПриравненныеКВнереализационнымРасходам))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102.СубконтоДт1.Наименование,
	|		ОборотыДт9102.СуммаОборот,
	|		ОборотыДт9102.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОбротыДт9102Кт6802.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОбротыДт9102Кт6802.СуммаОборот),
	|		ОбротыДт9102Кт6802.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеКосвенныеРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеУбыткиПриравненныеКВнереализационнымРасходам))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОбротыДт9102Кт6802
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОбротыДт9102Кт6802.СубконтоДт1.Наименование,
	|		ОбротыДт9102Кт6802.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт76ОТ.СуммаОборот),
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт76ОТ
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9901.СубконтоДт1.Наименование,
	|		СУММА(ОборотыДт9901.СуммаОборот),
	|		ОборотыДт9901.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиБезНалогаНаПрибыль)),
	|				,
	|				,
	|				,
	|				Организация.Наименование В (&НазванияОрганизаций)
	|					И СубконтоДт1 = ЗНАЧЕНИЕ(Перечисление.ПрибылиИУбытки.ЧрезвычайныеДоходыРасходы)) КАК ОборотыДт9901
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9901.СубконтоДт1.Наименование,
	|		ОборотыДт9901.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт010304.СубконтоДт1.Наименование,
	|		СУММА(ОборотыДт9102Кт010304.СуммаОборот),
	|		ОборотыДт9102Кт010304.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства))
	|					ИЛИ СчетКТ В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ))
	|					ИЛИ СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы)),
	|				,
	|				СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт010304
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт010304.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт010304.Организация.Наименование
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт0205Кт9101.СубконтоКт1.Наименование,
	|		СУММА(-1 * ОборотыДт0205Кт9101.СуммаОборот),
	|		ОборотыДт0205Кт9101.Организация.Наименование
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств))
	|					ИЛИ СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт0205Кт9101
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт0205Кт9101.СубконтоКт1.Наименование,
	|		ОборотыДт0205Кт9101.Организация.Наименование) КАК ПрочиеРасходы
	|
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходы.СтатьяДР,
	|	ПрочиеРасходы.ОрганизацияНаименование
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОборотыБух.СтатьяДР КАК СтатьяДР,
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1 КАК ИтоговыйРаздел_1,
	|	СУММА(ВТ_ОборотыБух.Сумма) КАК Сумма,
	|	ВТ_ОборотыБух.ОрганизацияНаименование
	|ИЗ
	|	ВТ_ОборотыБух КАК ВТ_ОборотыБух
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ОборотыБух.СтатьяДР,
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1,
	|	ВТ_ОборотыБух.ОрганизацияНаименование
	|
	|УПОРЯДОЧИТЬ ПО
	|	ИтоговыйРаздел_1,
	|	СтатьяДР";
	
	Запрос.УстановитьПараметр("НачалоПериода",       НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",        КонецПериода);
	
	ПараметрыНазванияОрганизаций = Соединение.NewObject("СписокЗначений");
	Для Каждого НазваниеОрг Из НазванияОрганизаций Цикл
		ПараметрыНазванияОрганизаций.Добавить(НазваниеОрг);
	КонецЦикла;
	
	Запрос.УстановитьПараметр("НазванияОрганизаций", ПараметрыНазванияОрганизаций);
	
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	РасшифровкаПоСтатьямВБух = ЗначениеИзКОМ(Соединение, РезультатЗапроса);
	
	Для Каждого Стр Из РасшифровкаПоСтатьямВБух Цикл
		НовСтрока = РезультатРасшифровки.Добавить();
		НовСтрока.НазваниеОрганизации = Стр.ОрганизацияНаименование;
		НовСтрока.ИмяРаздела          = Стр.ИтоговыйРаздел_1;
		НовСтрока.СтатьяДР            = Стр.СтатьяДР;
		НовСтрока.Сумма               = Стр.Сумма;
	КонецЦикла;
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Процедура ЗаполнитьРезультатРасшифровкиБух(Соединение, НачалоПериода, КонецПериода, НазванияОрганизаций, ВидОтчета)
	
	ПараметрыНазванияОрганизаций = Соединение.NewObject("СписокЗначений");
	Для Каждого НазваниеОрг Из НазванияОрганизаций Цикл
		ПараметрыНазванияОрганизаций.Добавить(НазваниеОрг);
	КонецЦикла;
	
	Запрос = Соединение.NewObject("Запрос");
	Запрос.УстановитьПараметр("НачалоПериода",       НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",        КонецПериода);
	Запрос.УстановитьПараметр("НазванияОрганизаций", ПараметрыНазванияОрганизаций);
	Запрос.УстановитьПараметр("ВидОтчета",           ВидОтчета);	
	Запрос.Текст = "ВЫБРАТЬ
	|	ОборотыДт9007.СубконтоКт1.Наименование КАК СтатьяДР,
	|	СУММА(-1 * ОборотыДт9007.СуммаОборот) КАК Сумма,
	|	""	КОММЕРЧЕСКИЕ РАСХОДЫ"" КАК ИтоговыйРаздел_1,
	|	ОборотыДт9007.Организация.Наименование,
	|	ОборотыДт9007.СубконтоКт1.Код КАК СтатьяДРКод,
	|	ВЫБОР
	|		КОГДА ОборотыДт9007.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ЭтоСтатьяЗатрат
	|ПОМЕСТИТЬ ВТ_ОборотыБух
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(&НачалоПериода, &КонецПериода, Регистратор, СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу)), , , , Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9007
	|
	|СГРУППИРОВАТЬ ПО
	|	ОборотыДт9007.СубконтоКт1.Наименование,
	|	ОборотыДт9007.Организация.Наименование,
	|	ОборотыДт9007.СубконтоКт1.Код,
	|	ВЫБОР
	|		КОГДА ОборотыДт9007.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеДоходы.СтатьяДР,
	|	СУММА(ПрочиеДоходы.Сумма),
	|	""	ДОХОДЫ ПРОЧИЕ"",
	|	ПрочиеДоходы.ОрганизацияНаименование,
	|	ПрочиеДоходы.СтатьяДРКод,
	|	ПрочиеДоходы.ЭтоСтатьяЗатрат
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОборотыКт9101.СубконтоКт1.Наименование КАК СтатьяДР,
	|		СУММА(ОборотыКт9101.СуммаОборот) КАК Сумма,
	|		ОборотыКт9101.Организация.Наименование КАК ОрганизацияНаименование,
	|		ОборотыКт9101.СубконтоКт1.Код КАК СтатьяДРКод,
	|		ВЫБОР
	|			КОГДА ОборотыКт9101.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ КАК ЭтоСтатьяЗатрат
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				,
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				(СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСЛиквидациейОсновныхСредств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейЦенныхБумаг)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделок)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделокОР)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОтчисленияВОценочныеРезервы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РазницаМеждуПервоначальнойИНоминальнойСтоимостьюПоДолговымЦеннымБумагам)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ВозмещениеУбытковКПолучениюУплате)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницыПоРасчетамВУЕ)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СписаниеДебиторскойКредиторскойЗадолженности)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСБезвозмезднымПолучениемИмущества)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыСвязанныеСВосстановлениемАмортизационнойПремии)
	|					ИЛИ СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КорректировкаПрибылиДоРыночныхЦен))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыКт9101
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыКт9101.СубконтоКт1.Наименование,
	|		ОборотыКт9101.Организация.Наименование,
	|		ОборотыКт9101.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыКт9101.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт6802.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт6802.СуммаОборот),
	|		ОборотыДт9102Кт6802.Организация.Наименование,
	|		ОборотыДт9102Кт6802.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт6802.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КорректировкаПрибылиДоРыночныхЦен))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт6802
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт6802.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт6802.Организация.Наименование,
	|		ОборотыДт9102Кт6802.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт6802.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт76ОТ.СуммаОборот),
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование,
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт76ОТ.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт76ОТ
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование,
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт76ОТ.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОбротыКт9901.СубконтоКт1.Наименование,
	|		СУММА(ОбротыКт9901.СуммаОборот),
	|		ОбротыКт9901.Организация.Наименование,
	|		ОбротыКт9901.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОбротыКт9901.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				,
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиБезНалогаНаПрибыль)),
	|				,
	|				Организация.Наименование В (&НазванияОрганизаций)
	|					И СубконтоКт1 = ЗНАЧЕНИЕ(Перечисление.ПрибылиИУбытки.ЧрезвычайныеДоходыРасходы)) КАК ОбротыКт9901
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОбротыКт9901.СубконтоКт1.Наименование,
	|		ОбротыКт9901.Организация.Наименование,
	|		ОбротыКт9901.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОбротыКт9901.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыКт9101Дт010304.СубконтоКт1.Наименование,
	|		СУММА(ОборотыКт9101Дт010304.СуммаОборот),
	|		ОборотыКт9101Дт010304.Организация.Наименование,
	|		ОборотыКт9101Дт010304.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыКт9101Дт010304.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства))
	|					ИЛИ СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ))
	|					ИЛИ СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы)),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыКт9101Дт010304
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыКт9101Дт010304.СубконтоКт1.Наименование,
	|		ОборотыКт9101Дт010304.Организация.Наименование,
	|		ОборотыКт9101Дт010304.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыКт9101Дт010304.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт0205.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт0205.СуммаОборот),
	|		ОборотыДт9102Кт0205.Организация.Наименование,
	|		ОборотыДт9102Кт0205.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт0205.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств))
	|					ИЛИ СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов),
	|				,
	|				СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт0205
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт0205.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт0205.Организация.Наименование,
	|		ОборотыДт9102Кт0205.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт0205.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ПрочиеДоходы
	|
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеДоходы.СтатьяДР,
	|	ПрочиеДоходы.ОрганизацияНаименование,
	|	ПрочиеДоходы.СтатьяДРКод,
	|	ПрочиеДоходы.ЭтоСтатьяЗатрат
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходы.СтатьяДР,
	|	СУММА(-1 * ПрочиеРасходы.Сумма),
	|	""	РАСХОДЫ ПРОЧИЕ"",
	|	ПрочиеРасходы.ОрганизацияНаименование,
	|	ПрочиеРасходы.СтатьяДРКод,
	|	ПрочиеРасходы.ЭтоСтатьяЗатрат
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОборотыДт9102.СубконтоДт1.Наименование КАК СтатьяДР,
	|		СУММА(ОборотыДт9102.СуммаОборот) КАК Сумма,
	|		ОборотыДт9102.Организация.Наименование КАК ОрганизацияНаименование,
	|		ОборотыДт9102.СубконтоДт1.Код КАК СтатьяДРКод,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ КАК ЭтоСтатьяЗатрат
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				,
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСУчастиемВДругихОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДолевоеУчастиеВРоссийскихОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДолевоеУчастиеВИностранныхОрганизациях)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСЛиквидациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейЦенныхБумаг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделокОР)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыПоОперациямСФинансовымиИнструментамиСрочныхСделок)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОтчисленияВОценочныеРезервы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РазницаМеждуПервоначальнойИНоминальнойСтоимостьюПоДолговымЦеннымБумагам)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыНаУслугиБанков)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ВозмещениеУбытковКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.КурсовыеРазницыПоРасчетамВУЕ)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.НалогиИСборы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПремияПокупателю)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СписаниеДебиторскойКредиторскойЗадолженности)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.НДСПоСписаннойКредиторскойЗадолженности)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСБезвозмезднымПолучениемИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыПоПередачеТоваровБезвозмездноИДляСобственныхНужд)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РасходыОтСниженияСтоимостиАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеКосвенныеРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеУбыткиПриравненныеКВнереализационнымРасходам))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102.СубконтоДт1.Наименование,
	|		ОборотыДт9102.Организация.Наименование,
	|		ОборотыДт9102.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОбротыДт9102Кт6802.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОбротыДт9102Кт6802.СуммаОборот),
	|		ОбротыДт9102Кт6802.Организация.Наименование,
	|		ОбротыДт9102Кт6802.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОбротыДт9102Кт6802.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейНематериальныхАктивов)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПрочегоИмущества)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияКакОказанияФинансовыхУслуг)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияДоНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейПраваТребованияПослеНаступленияСрокаПлатежа)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравКромеПраваТребования)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейИмущественныхПравПоОбъектамОбслуживающихПроизводств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСоСдачейИмуществаВАренду)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеОперационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеКосвенныеРасходы)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеУбыткиПриравненныеКВнереализационнымРасходам))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОбротыДт9102Кт6802
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОбротыДт9102Кт6802.СубконтоДт1.Наименование,
	|		ОбротыДт9102Кт6802.Организация.Наименование,
	|		ОбротыДт9102Кт6802.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОбротыДт9102Кт6802.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		СУММА(-1 * ОборотыДт9102Кт76ОТ.СуммаОборот),
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование,
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт76ОТ.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке),
	|				,
	|				(СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОсновныхСредств)
	|					ИЛИ СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСРеализациейОбъектовСтроительства))
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт76ОТ
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт76ОТ.Организация.Наименование,
	|		ОборотыДт9102Кт76ОТ.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт76ОТ.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9901.СубконтоДт1.Наименование,
	|		СУММА(ОборотыДт9901.СуммаОборот),
	|		ОборотыДт9901.Организация.Наименование,
	|		ОборотыДт9901.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9901.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиБезНалогаНаПрибыль)),
	|				,
	|				,
	|				,
	|				Организация.Наименование В (&НазванияОрганизаций)
	|					И СубконтоДт1 = ЗНАЧЕНИЕ(Перечисление.ПрибылиИУбытки.ЧрезвычайныеДоходыРасходы)) КАК ОборотыДт9901
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9901.СубконтоДт1.Наименование,
	|		ОборотыДт9901.Организация.Наименование,
	|		ОборотыДт9901.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9901.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт9102Кт010304.СубконтоДт1.Наименование,
	|		СУММА(ОборотыДт9102Кт010304.СуммаОборот),
	|		ОборотыДт9102Кт010304.Организация.Наименование,
	|		ОборотыДт9102Кт010304.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт010304.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|				,
	|				СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства))
	|					ИЛИ СчетКТ В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ))
	|					ИЛИ СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы)),
	|				,
	|				СубконтоДт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт9102Кт010304
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт9102Кт010304.СубконтоДт1.Наименование,
	|		ОборотыДт9102Кт010304.Организация.Наименование,
	|		ОборотыДт9102Кт010304.СубконтоДт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт9102Кт010304.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ОборотыДт0205Кт9101.СубконтоКт1.Наименование,
	|		СУММА(-1 * ОборотыДт0205Кт9101.СуммаОборот),
	|		ОборотыДт0205Кт9101.Организация.Наименование,
	|		ОборотыДт0205Кт9101.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт0205Кт9101.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				Регистратор,
	|				СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств))
	|					ИЛИ СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов),
	|				,
	|				СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|				,
	|				СубконтоКт1.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ДоходыРасходыСвязанныеСПереоценкойВнеоборотныхАктивов)
	|					И Организация.Наименование В (&НазванияОрганизаций)) КАК ОборотыДт0205Кт9101
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОборотыДт0205Кт9101.СубконтоКт1.Наименование,
	|		ОборотыДт0205Кт9101.Организация.Наименование,
	|		ОборотыДт0205Кт9101.СубконтоКт1.Код,
	|		ВЫБОР
	|			КОГДА ОборотыДт0205Кт9101.СубконтоКт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ПрочиеРасходы
	|
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходы.СтатьяДР,
	|	ПрочиеРасходы.ОрганизацияНаименование,
	|	ПрочиеРасходы.СтатьяДРКод,
	|	ПрочиеРасходы.ЭтоСтатьяЗатрат
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_ОборотыБух.СтатьяДР КАК СтатьяДР,
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1 КАК ИтоговыйРаздел_1,
	|	СУММА(ВТ_ОборотыБух.Сумма) КАК Сумма,
	|	ВТ_ОборотыБух.ОрганизацияНаименование,
	|	ВТ_ОборотыБух.СтатьяДРКод,
	|	ВТ_ОборотыБух.ЭтоСтатьяЗатрат
	|ПОМЕСТИТЬ ВТ_Сгруппировано
	|ИЗ
	|	ВТ_ОборотыБух КАК ВТ_ОборотыБух
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ОборотыБух.СтатьяДР,
	|	ВТ_ОборотыБух.ИтоговыйРаздел_1,
	|	ВТ_ОборотыБух.ОрганизацияНаименование,
	|	ВТ_ОборотыБух.СтатьяДРКод,
	|	ВТ_ОборотыБух.ЭтоСтатьяЗатрат
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ_Сгруппировано.СтатьяДР,
	|	ВЫБОР
	|		КОГДА &ВидОтчета = 1
	|			ТОГДА ВЫБОР
	|					КОГДА ВТ_Сгруппировано.ИтоговыйРаздел_1 = ""	ДОХОДЫ ПРОЧИЕ""
	|						ТОГДА ""ДОХОДЫ""
	|					ИНАЧЕ ""РАСХОДЫ""
	|				КОНЕЦ
	|		ИНАЧЕ ВТ_Сгруппировано.ИтоговыйРаздел_1
	|	КОНЕЦ КАК ИтоговыйРаздел_1,
	|	ВТ_Сгруппировано.Сумма,
	|	ВТ_Сгруппировано.ОрганизацияНаименование,
	|	ВТ_Сгруппировано.СтатьяДРКод,
	|	ВТ_Сгруппировано.ЭтоСтатьяЗатрат
	|ИЗ
	|	ВТ_Сгруппировано КАК ВТ_Сгруппировано";
	
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	ТЗРезультат = ЗначениеИзКОМ(Соединение, РезультатЗапроса);
	
	Для Каждого Стр из ТЗРезультат Цикл
		ДобавитьСтрокуВРезультатРасшифровкиБух(Стр.ОрганизацияНаименование, Стр.ИтоговыйРаздел_1, Стр.СтатьяДР, Стр.СтатьяДРКод, Стр.ЭтоСтатьяЗатрат, Стр.Сумма);
	КонецЦикла;
	
КонецПроцедуры //--- AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция ПолучитьОборотыВБухБазе(Соединение, НачалоПериода, КонецПериода, НазванияОрганизаций, ВидОтчета)
	
	ОборотыВБухБазе = Новый ТаблицаЗначений;	
	ОборотыВБухБазе.Колонки.Добавить("ИтоговыйРаздел_1",         Новый ОписаниеТипов("Строка"));
	ОборотыВБухБазе.Колонки.Добавить("ИтоговыйРаздел_1_Порядок", Новый ОписаниеТипов("Число"));
	ОборотыВБухБазе.Колонки.Добавить("Раздел",                   Новый ОписаниеТипов("Строка"));
	ОборотыВБухБазе.Колонки.Добавить("Раздел_Порядок",           Новый ОписаниеТипов("Число"));
	ОборотыВБухБазе.Колонки.Добавить("СтатьяДР",                 Новый ОписаниеТипов("Строка"));
	ОборотыВБухБазе.Колонки.Добавить("Сумма",                    Новый ОписаниеТипов("Число"));
	
	Запрос = Соединение.NewObject("Запрос");
	Запрос.УстановитьПараметр("ДатаНачала",          НачалоПериода);
	Запрос.УстановитьПараметр("ДатаОкончания",       НачалоДня(КонецПериода));
	
	Для Каждого НазваниеОрганизации из НазванияОрганизаций Цикл 
		
		Запрос.УстановитьПараметр("НазваниеОрганизации", НазваниеОрганизации);
		
		Запрос.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
		| РегламентированныйОтчет.Ссылка КАК СсылкаОтчета,
		| РегламентированныйОтчет.ДанныеОтчета
		| ИЗ
		| Документ.РегламентированныйОтчет КАК РегламентированныйОтчет
		| ГДЕ
		| РегламентированныйОтчет.ИсточникОтчета = ""РегламентированныйОтчетБухОтчетность""
		| И РегламентированныйОтчет.ДатаНачала = &ДатаНачала
		| И РегламентированныйОтчет.ДатаОкончания = &ДатаОкончания
		| И РегламентированныйОтчет.Организация.Наименование = &НазваниеОрганизации
		| УПОРЯДОЧИТЬ ПО
		| РегламентированныйОтчет.ДатаПодписи УБЫВ";
		
		Результат = Запрос.Выполнить().Выбрать();
		
		Если Результат.Следующий() Тогда   	
			Попытка
				ДанныеСохрДок = Результат.ДанныеОтчета.Получить().ПоказателиОтчета.ПолеТабличногоДокументаФормаОтчета;
				ДанныеБух = ЗначениеИзКОМ(Соединение, ДанныеСохрДок);
			Исключение
				ДанныеБух = Неопределено;
			КонецПопытки;
			
			Если ДанныеБух <> Неопределено Тогда
				ЗаполнитьТаблицуОборотыВБухБазе(ОборотыВБухБазе, ДанныеБух, НазваниеОрганизации, ВидОтчета);
			Иначе
				Сообщить("Внимание: в базе 1С Бухгалтерия не найдена сохраненная бухгалтерская отчетность по организации " + НазваниеОрганизации + " за указанный период!");
			КонецЕсли;
		Иначе
			Сообщить("Внимание: в базе 1С Бухгалтерия не найдена сохраненная бухгалтерская отчетность по организации " + НазваниеОрганизации + " за указанный период!");
		КонецЕсли;  
		
	КонецЦикла;
	
	Если ВидОтчета = 1 Тогда 
		
		ЗаполнитьРезультатРасшифровкиБух(Соединение, НачалоПериода, КонецДня(КонецПериода), НазванияОрганизаций, ВидОтчета);
		ПодготовитьТаблицуДляВидаОтчета1(ОборотыВБухБазе);
		ДоработатьРезультатРасшифровкиБух();
		
	Иначе
		
		ЗаполнитьРасшифровку(Соединение, НачалоПериода, КонецДня(КонецПериода), НазванияОрганизаций);
		
	КонецЕсли;
	
	ОборотыВБухБазе.Свернуть("ИтоговыйРаздел_1, ИтоговыйРаздел_1_Порядок, Раздел, Раздел_Порядок, СтатьяДР", "Сумма");
	
	Возврат ОборотыВБухБазе;
	
КонецФункции //---AK suvv

//+++ AK suvv 2018.08.24 ИП-00019211
Функция ОборотыВБухБазе(НачалоПериода, КонецПериода, НазванияОрганизаций, ВидОтчета)
	
	Соединение = ПолучитьСоединениеСБазойБух();
	
	ОборотыВБухБазе = ПолучитьОборотыВБухБазе(Соединение, НачалоПериода, КонецПериода, НазванияОрганизаций, ВидОтчета);
	
	Возврат ОборотыВБухБазе;
	
КонецФункции //--- AK suvv

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ЗначениеПараметраКД(ИмяПараметра, ЗначениеПоУмолчанию = Неопределено)
	
	ЗначениеПараметра = ЗначениеПоУмолчанию;
	
	ПараметрКД = КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.НайтиЗначениеПараметра(
	Новый ПараметрКомпоновкиДанных(ИмяПараметра));
	Если ПараметрКД <> Неопределено
		И ПараметрКД.Использование Тогда
		ЗначениеПараметра = ПараметрКД.Значение;
	КонецЕсли;
	
	Возврат ЗначениеПараметра;
	
КонецФункции

Функция ЗначениеИзКОМ(Соединение, Значение)
	
	Возврат ЗначениеИзСтрокиВнутр(Соединение.ЗначениеВСтрокуВнутр(Значение));
	
КонецФункции

Функция Список(Массив)
	
	Результат = Новый СписокЗначений;	
	Для каждого Элемент из Массив Цикл
		
		Результат.Добавить(Элемент);	
		
	КонецЦикла;	
	
	Возврат Результат;
	
КонецФункции

Процедура УстановитьОтборСКД(ОтборыКомпоновщика, ИмяПоля, ВидОтбора, Значение)
	
	ПолеОтбора = Новый ПолеКомпоновкиДанных(ИмяПоля);
	
	Для Каждого Стр Из ОтборыКомпоновщика Цикл	
		Если Стр.ЛевоеЗначение = ПолеОтбора Тогда
			Отбор = Стр;
		КонецЕсли;
	КонецЦикла;
	
	Если Отбор = Неопределено Тогда
		Отбор = ОтборыКомпоновщика.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
		Отбор.ЛевоеЗначение  = ПолеОтбора;
	КонецЕсли;
	
	Если Значение <> Неопределено Тогда
		Отбор.ВидСравнения   = ВидОтбора;
		Отбор.Использование  = Истина;
		Отбор.ПравоеЗначение = Значение;
	Иначе
		Отбор.Использование  = Ложь;
	КонецЕсли;
	
КонецПроцедуры 

#КонецОбласти
