////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ
//

Перем СоответствиеНастройкаРезультат Экспорт; // Соответствие, в котором хранятся все результаты при текущем открытии отчета
Перем ПредставлениеНастройки Экспорт;         // Представление настройки при редактировании отдельной настройки
Перем ПанельНастроекНарисована;               // Флаг, означающий что панель настроек после открытия нарисована
Перем ДействияЭлементовФормы Экспорт;         // Структура, содеражащая действия элементов формы, формируемых программно

// ДЕЙСТВИЯ С РЕЗУЛЬТАТОМ

Процедура ДействияСРезультатомПечатьНажатие(Элемент)
	
	ИнфокомТиповыеОтчеты.ПечатьТиповогоОтчета(ЭлементыФормы.Результат);
	
КонецПроцедуры

Процедура ДействияСРезультатомВывестиКопиюРезультатаВТабличныйДокумент(Кнопка)

	ИнфокомТиповыеОтчеты.ПоказатьКопиюРезультата(ЭлементыФормы.Результат);
	
КонецПроцедуры

Процедура ДействияСРезультатомСохранитьРезультатВНастройке(Кнопка)
	
	ИнфокомТиповыеОтчеты.СохранитьРезультатВНастройке(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура ДействияСРезультатомСравнитьТекущийРезультатССохраненным(Кнопка)
	
	ИнфокомТиповыеОтчеты.СохранитьРезультатССохраненным(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура ДействияСРезультатомЗаголовок(Кнопка)
	
	Кнопка.Пометка = Не Кнопка.Пометка;
	ИнфокомТиповыеОтчеты.УправлениеОтображениемЭлементовФормыТиповогоОтчета(ЭтотОбъект, ЭтаФорма);
	ИнфокомТиповыеОтчеты.УправлениеОтображениемЗаголовкаТиповогоОтчета(ЭтотОбъект, ЭтаФорма.ЭлементыФормы.Результат);
	
КонецПроцедуры

// ОБЩИЕ ПРОЦЕДУРЫ

Процедура ОбновитьОтчет() Экспорт
	
	СостояниеМодифицированности = Модифицированность;
	Если ПанельНастроекНарисована <> Истина Тогда
		ОбновлениеОтображения();
	КонецЕсли;
	ИнфокомТиповыеОтчеты.ЗагрузитьВРеквизитЗначенияНастроекПанелиПользователя(ЭтотОбъект, ЭтаФорма);
	ПараметрыПанели  = ИнфокомТиповыеОтчеты.ПолучитьПараметрыПанелиПользователяОбъекта(ОтчетОбъект);
	ЗначенияНастроек = ИнфокомТиповыеОтчеты.ПолучитьЗначенияНастроекПанелиПользователяОбъекта(ОтчетОбъект);
	// Установка Динамических отборов
	Отказ = ложь;
	Если ЗначенияНастроек.Свойство("ДинамическиеПараметры") И ПараметрыПанели.Свойство("Параметры") тогда
		Если ПараметрыПанели.Параметры.Колонки.Найти("Заполнено") <> Неопределено тогда
			СтрокиПарамтеровДляПроверки = ПараметрыПанели.Параметры.НайтиСтроки(Новый Структура("Заполнено", истина));
			Если СтрокиПарамтеровДляПроверки.Количество() > 0 тогда
				СтрокаПредупреждения = "Не заполнен(а)";
				Для каждого СтрокаПараметра Из СтрокиПарамтеровДляПроверки Цикл
					ЗначениеПараметра = ЗначенияНастроек.ДинамическиеПараметры[СтрокаПараметра.Параметр];
					Если ЗначениеПараметра = Неопределено или Не ЗначениеЗаполнено(ЗначениеПараметра.Значение) ИЛИ Не ЗначениеПараметра.Использование Тогда
						СтрокаПредупреждения = СтрокаПредупреждения + " " + СтрокаПараметра.Представление;
						Отказ = истина;
					КонецЕсли;
				КонецЦикла;
				Если Отказ тогда
					СтрокаПредупреждения = СтрокаПредупреждения + "!";
					Предупреждение(СтрокаПредупреждения);
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Если Отказ тогда
		Возврат;
	КонецЕсли;
	СформироватьОтчет(ЭлементыФормы.Результат, ДанныеРасшифровки);
	УправлениеОтчетами.УстановитьКолонтитулыПоУмолчанию(ЭлементыФормы.Результат, Заголовок, Строка(ПараметрыСеанса.ТекущийПользователь));
	Модифицированность = СостояниеМодифицированности;
КонецПроцедуры

// ОБРАБОТЧИКИ КНОПОК ФОРМЫ

Процедура ДействияФормыСформировать(Кнопка)
	
	ОбновитьОтчет();
	
КонецПроцедуры

Процедура ДействияФормыСохранитьНастройку(Кнопка)
	
	ИнфокомТиповыеОтчеты.СохранитьТекущуюНастройку(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура ДействияФормыСохранитьНастройкуКак(Кнопка)
	
	ИнфокомТиповыеОтчеты.СохранитьТекущуюНастройкуКак(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура КнопкаСписокВариантовНажатие(Кнопка)
	
	СохранениеНастроек.ВыбратьНастройкуФормы(СохраненнаяНастройка, ЭтаФорма, ИнфокомТиповыеОтчеты.ПолучитьИдентификаторОбъекта(ОтчетОбъект), Ложь);
	
	Если Не РежимРедактированияНастройки Тогда
		ИнфокомТиповыеОтчеты.ОбновитьТаблицуДоступныхНастроекПользователю(ЭтотОбъект);
		ИнфокомТиповыеОтчеты.ОбновитьКнопкиВыбораНастроек(ЭтаФорма, ЭтотОбъект, ПредставлениеНастройки, РежимРедактированияНастройки);
	КонецЕсли;
	
	Модифицированность = Ложь;
	
КонецПроцедуры

Процедура ДействияФормыРедактироватьНастройкуСтруктуры(Кнопка)
	РезультатРедактирования = ИнфокомТиповыеОтчеты.РедактироватьСтруктуруОтчета(ЭтотОбъект, ЭтаФорма);
	Если РезультатРедактирования Тогда
		ОбновитьОтчет();
	КонецЕсли;
КонецПроцедуры

Процедура ДействияФормыРедактироватьПанельПользователя(Кнопка)
	
	ИнфокомТиповыеОтчеты.РедактироватьПанельПользователя(ЭтотОбъект, ЭтаФорма);
		
КонецПроцедуры

Процедура ДействияФормыРедактироватьОписаниеИПользователей(Кнопка)
	
	ИнфокомТиповыеОтчеты.ОткрытьФормуСохраненнойНастройки(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура КоманднаяПанельПанельВариантов(Кнопка)
	
	Кнопка.Пометка = Не Кнопка.Пометка;
	ИнфокомТиповыеОтчеты.УправлениеОтображениемПанелиВариантов(ЭтаФорма);
	
КонецПроцедуры

Процедура КоманднаяПанельПанельПользователя(Кнопка)
	
	Кнопка.Пометка = Не Кнопка.Пометка;
	ИнфокомТиповыеОтчеты.УправлениеОтображениемПанелиПользователя(ЭтаФорма);
	
КонецПроцедуры

// ОБРАБОТЧИКИ ФОРМЫ

Процедура ПриОткрытии()
	
	// Реквизит формы и компоновщик отчета ссылаются на один компоновщик
	КомпоновщикНастроек = ЭтотОбъект.КомпоновщикНастроек;
	
	ИнфокомТиповыеОтчеты.ОбновитьТаблицуДоступныхНастроекПользователю(ЭтотОбъект);
	ИнфокомТиповыеОтчеты.УстановитьВариантПоУмолчанию(ЭтотОбъект, ЭтаФорма);
	
	// Нарисуем кнопки выбора настроек на верхней панели
	ИнфокомТиповыеОтчеты.ОбновитьКнопкиВыбораНастроек(ЭтаФорма, ЭтотОбъект, ПредставлениеНастройки, РежимРедактированияНастройки);
	ИнфокомТиповыеОтчеты.ОбновитьФормуТиповогоОтчетаПоКомпоновщику(ЭтотОбъект, ЭтаФорма);
	ИнфокомТиповыеОтчеты.УстановитьВидимостьПанелиВариантовПоУмолчанию(ЭтотОбъект, ЭтаФорма);
	ИнфокомТиповыеОтчеты.УстановитьВидимостьПанелиПользователяПоУмолчанию(ЭтотОбъект, ЭтаФорма);
	ИнфокомТиповыеОтчеты.ВосстановитьНастройкиФормыОтчета(ЭтотОбъект, ЭтаФорма);
	ИнфокомТиповыеОтчеты.УправлениеОтображениемПанелиВариантов(ЭтаФорма);
	ИнфокомТиповыеОтчеты.УправлениеОтображениемПанелиПользователя(ЭтаФорма);
	
	//ПараметрДанных = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("Проект");
	//ПараметрДанных.Использование = Истина;
	//
	//Если ПараметрДанных.Значение = Перечисления.ТипыРозничныхТочек.Магазин Тогда
	//	Проект = 1;
	//ИначеЕсли ПараметрДанных.Значение = Перечисления.ТипыРозничныхТочек.Избенка Тогда
	//	Проект = 2;
	//КонецЕсли;
	
КонецПроцедуры

Процедура ОбновлениеОтображения() Экспорт
	
	Если ПанельНастроекНарисована <> Истина И Не Модифицированность Тогда
		
		// Инициализация компоновщиков настроек и, если необходимо, загрузка настроек по умолчанию
		ЗагружатьНастройкиПоУмолчанию = Не РежимРедактированияНастройки И Не ЭтоОтработкаРасшифровки И СохраненнаяНастройка.Пустая();
		Схема = ИнфокомТиповыеОтчеты.ИнициализироватьКомпоновщикНастроек(ЭтотОбъект, , ЗагружатьНастройкиПоУмолчанию);
		КомпоновщикНастроекПользователя.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(Схема));
		
		Если Не ЭтоОтработкаРасшифровки И Не РежимРедактированияНастройки Тогда
			ПрименитьНастройку();
			ИнфокомТиповыеОтчеты.ПрименитьНастройкуПользователяНастройкиОтчета(ЭтотОбъект);
			ИнфокомТиповыеОтчеты.ОбработкаФормыПослеПримененияНастройки(ЭтотОбъект, ЭтаФорма);
		Иначе
			// Отработаем изменение отображение панели настроек
			ИнфокомТиповыеОтчеты.УправлениеОтображениемЭлементовФормыТиповогоОтчета(ЭтотОбъект, ЭтаФорма);
			ИнфокомТиповыеОтчеты.ПерерисоватьПанельНастроек(ЭтотОбъект, ЭтаФорма, );
			
		КонецЕсли;
		
		ПанельНастроекНарисована = Истина;
		
	КонецЕсли;
	ИнфокомТиповыеОтчеты.ОбновитьЗаголовокТиповогоОтчета(ЭтотОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура ОбработкаВыбора(ЗначениеВыбора, Источник)
	
	ИнфокомТиповыеОтчеты.ОбработкаВыбораФормыОтчета(ЭтотОбъект, ЭтаФорма, ЗначениеВыбора, Источник);
	
КонецПроцедуры

Процедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ИнфокомТиповыеОтчеты.ОбработкаРасшифровкиТиповогоОтчета(Расшифровка, СтандартнаяОбработка, ЭтотОбъект, ЭтаФорма);
	//ПредставлениеТекущегоВариант = 
	
	//ВариантОтчета = Лев(Сред(Заголовок, Найти(Заголовок, "[") + 1), СтрДлина(Сред(Заголовок, Найти(Заголовок, "[") + 1))- 1);
	//Если ВариантОтчета = "Общий" ИЛИ ВариантОтчета = "Общий по статьям" Тогда	
	//	РасшифроватьПоДокументам_Общий(Расшифровка);
	//ИначеЕсли ВариантОтчета = "по проекту ВкусВилл" Тогда
	//	РасшифроватьПоДокументам_ВкусВилл(Расшифровка);
	//ИначеЕсли ВариантОтчета = "по проекту Избенка" Тогда	
	//	РасшифроватьПоДокументам_Избенка(Расшифровка);
	//ИначеЕсли ВариантОтчета = "по ТТ" Тогда
	//	РасшифроватьПоДокументам_ТТ(Расшифровка);
	//ИначеЕсли ВариантОтчета = "Общий - ЦФО" Тогда
	//	РасшифроватьПоДокументам_ОбщийЦФО(Расшифровка);	
	//ИначеЕсли ВариантОтчета = "Общий по статьям - ЦФО" Тогда
	//	РасшифроватьПоДокументам_ОбщийСтатьиЦФО(Расшифровка);	
	//ИначеЕсли ВариантОтчета = "по проекту ВкусВилл - ЦФО"Тогда
	//	РасшифроватьПоДокументам_ВкусВиллЦФО(Расшифровка);
	//ИначеЕсли ВариантОтчета = "по проекту Избенка - ЦФО" Тогда	
	//	РасшифроватьПоДокументам_ИзбенкаЦФО(Расшифровка);
	//КонецЕсли;
	
КонецПроцедуры

Процедура РасшифроватьПоДокументам_Общий(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = СтатьяДР_Наименование;
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);	
				   
	ИначеЕсли СтатьяДР_Код = "02" Или СтатьяДР_Код = "201" 
		 ИЛИ СтатьяДР_Код = "202" Или СтатьяДР_Код = "203" 
		 ИЛИ СтатьяДР_Код = "204" Или СтатьяДР_Код = "205" 
		 ИЛИ СтатьяДР_Код = "206" Или СтатьяДР_Код = "207"  
		 ИЛИ СтатьяДР_Код = "209" Или СтатьяДР_Код = "210" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		   
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК)) И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК)) И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	ИначеЕсли (СтатьяДР_Код = "310" 
		 ИЛИ СтатьяДР_Код = "320" Или СтатьяДР_Код = "331" 
		 ИЛИ СтатьяДР_Код = "350" Или СтатьяДР_Код = "351" 
		 ИЛИ СтатьяДР_Код = "381" Или СтатьяДР_Код = "391"  
		 ИЛИ СтатьяДР_Код = "392" Или СтатьяДР_Код = "393") И Число(Расшифровка) < 125 Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));
		
	ИначеЕсли СтатьяДР_Код = "410" И Число(Расшифровка) < 125 Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
		
	ИначеЕсли (СтатьяДР_Код = "41023" ИЛИ СтатьяДР_Код = "41025"
		       ИЛИ СтатьяДР_Код = "41027" ИЛИ СтатьяДР_Код = "41028"
			   ИЛИ СтатьяДР_Код = "41029") И Число(Расшифровка) < 444 Тогда 
			   
			  	Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &УЕК
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 = &УЕК
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
       // Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
	ИначеЕсли СтатьяДР_Код = "330" 
		 ИЛИ СтатьяДР_Код = "340" Или СтатьяДР_Код = "350" 
		 ИЛИ СтатьяДР_Код = "351" Или СтатьяДР_Код = "361" 
		 ИЛИ СтатьяДР_Код = "371" Или СтатьяДР_Код = "392"  
		 ИЛИ СтатьяДР_Код = "393" Или СтатьяДР_Код = "410" Или СтатьяДР_Код = "810" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		               	|			СубконтоДт2 В ИЕРАРХИИ (&Общие) И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт2 В ИЕРАРХИИ (&Общие) И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
				
	ИначеЕсли СтатьяДР_Код = "05" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		               	|			(&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	ИначеЕсли СтатьяДР_Код = "10" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""10"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&Счет01),
		               |			,
		               |			(ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |					И КорСубконто2 <> &КорСубконто2
		               |				ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&Счет01)
		               |					И (ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |							И КорСубконто2 <> &КорСубконто2
		               |						ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("Счет01", ПланыСчетов.Финансовый.Инвестиции);	
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));		   
		
	ИначеЕсли СтатьяДР_Код = "20110" Или СтатьяДР_Код = "20120" 
		 ИЛИ СтатьяДР_Код = "20121" Или СтатьяДР_Код = "20210" 
		 ИЛИ СтатьяДР_Код = "20213" Или СтатьяДР_Код = "20214" 
		 ИЛИ СтатьяДР_Код = "20310" Или СтатьяДР_Код = "20320"  
		 ИЛИ СтатьяДР_Код = "20330" Или СтатьяДР_Код = "20332" 
		 ИЛИ СтатьяДР_Код = "20410" Или СтатьяДР_Код = "20510" 
		 ИЛИ СтатьяДР_Код = "20520" Или СтатьяДР_Код = "20610" 
		 ИЛИ СтатьяДР_Код = "20612" Или СтатьяДР_Код = "20613"  
		 ИЛИ СтатьяДР_Код = "20742" Или СтатьяДР_Код = "20901" 
		 ИЛИ СтатьяДР_Код = "21001" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 = &ЗатратыПеременные
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 = &ЗатратыПеременные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 	
		
		
	ИначеЕсли (СтатьяДР_Код = "31010"  Или СтатьяДР_Код = "31012"
		 ИЛИ СтатьяДР_Код = "31013" Или СтатьяДР_Код = "32023" 
		 ИЛИ СтатьяДР_Код = "32024" Или СтатьяДР_Код = "32025" 
		 ИЛИ СтатьяДР_Код = "32026" Или СтатьяДР_Код = "33120" 
		 ИЛИ СтатьяДР_Код = "33110" Или СтатьяДР_Код = "33121" 
		 ИЛИ СтатьяДР_Код = "35012" Или СтатьяДР_Код = "35013" 
		 ИЛИ СтатьяДР_Код = "35014" Или СтатьяДР_Код = "35015" 
		 ИЛИ СтатьяДР_Код = "35110" Или СтатьяДР_Код = "38110" 
		 ИЛИ СтатьяДР_Код = "38111" Или СтатьяДР_Код = "38112" 
		 ИЛИ СтатьяДР_Код = "38115" Или СтатьяДР_Код = "39110" 
		 ИЛИ СтатьяДР_Код = "39111" Или СтатьяДР_Код = "39112" 
		 ИЛИ СтатьяДР_Код = "39113" Или СтатьяДР_Код = "39114"  
		 ИЛИ СтатьяДР_Код = "39210" Или СтатьяДР_Код = "39220" 
		 ИЛИ СтатьяДР_Код = "39230" Или СтатьяДР_Код = "39290" 
		 ИЛИ СтатьяДР_Код = "39311" Или СтатьяДР_Код = "39312"
         ИЛИ СтатьяДР_Код = "39313" Или СтатьяДР_Код = "39320" 
		 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39399" 
		 ИЛИ СтатьяДР_Код = "39115" Или СтатьяДР_Код = "39116") И Число(Расшифровка) < 444 Тогда 
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &ЗатратыПостоянные
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 = &ЗатратыПостоянные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));

		ИначеЕсли СтатьяДР_Код = "33010" Или СтатьяДР_Код = "33011"
			 ИЛИ СтатьяДР_Код = "34010" Или СтатьяДР_Код = "34011" 
			 ИЛИ СтатьяДР_Код = "35010" Или СтатьяДР_Код = "35011" 
			 ИЛИ СтатьяДР_Код = "35113" Или СтатьяДР_Код = "36110"  
			 ИЛИ СтатьяДР_Код = "36120" Или СтатьяДР_Код = "36190" 
			 ИЛИ СтатьяДР_Код = "36198" Или СтатьяДР_Код = "36201" 
			 ИЛИ СтатьяДР_Код = "37110" Или СтатьяДР_Код = "37115"   
			 ИЛИ СтатьяДР_Код = "37120" Или СтатьяДР_Код = "37190"  
			 ИЛИ СтатьяДР_Код = "37195" Или СтатьяДР_Код = "39230" 
			 ИЛИ СтатьяДР_Код = "39314" Или СтатьяДР_Код = "39320" 
			 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39397"
			 ИЛИ СтатьяДР_Код = "39399" Или СтатьяДР_Код = "41010"  
			 ИЛИ СтатьяДР_Код = "41020" Или СтатьяДР_Код = "41021" 
			 ИЛИ СтатьяДР_Код = "41022" Или СтатьяДР_Код = "41029" 
			 ИЛИ СтатьяДР_Код = "81010" Или СтатьяДР_Код = "81011"
             ИЛИ СтатьяДР_Код = "81012" Или СтатьяДР_Код = "81013"
			Тогда   
  

		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		               	|			СубконтоДт2 = &Общие И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт2 = &Общие И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));

	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ОбщийЦФО(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	Попытка
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
	Исключение
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	

	КонецПопытки;
	СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = СтатьяДР_Наименование;
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто3 = &ЦФО
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто3 = &ЦФО
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
				   
	ИначеЕсли СтатьяДР_Код = "02" Или СтатьяДР_Код = "201" 
		 ИЛИ СтатьяДР_Код = "202" Или СтатьяДР_Код = "203" 
		 ИЛИ СтатьяДР_Код = "204" Или СтатьяДР_Код = "205" 
		 ИЛИ СтатьяДР_Код = "206" Или СтатьяДР_Код = "207"  
		 ИЛИ СтатьяДР_Код = "209" Или СтатьяДР_Код = "210" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт3 = &ЦФО
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("ЦФО", ЦФО); 
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	ИначеЕсли (СтатьяДР_Код = "310" 
		 ИЛИ СтатьяДР_Код = "320" Или СтатьяДР_Код = "331" 
		 ИЛИ СтатьяДР_Код = "350" Или СтатьяДР_Код = "351" 
		 ИЛИ СтатьяДР_Код = "381" Или СтатьяДР_Код = "391"  
		 ИЛИ СтатьяДР_Код = "392" Или СтатьяДР_Код = "393") И СтатьяГруппировка = "Постоянные затраты" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "410" И СтатьяГруппировка = "Постоянные затраты" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 В ИЕРАРХИИ (&УЕК) И СубконтоДт3 = &ЦФО
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли (СтатьяДР_Код = "41023" ИЛИ СтатьяДР_Код = "41025"
		       ИЛИ СтатьяДР_Код = "41027" ИЛИ СтатьяДР_Код = "41028"
			   ИЛИ СтатьяДР_Код = "41029") И Число(Расшифровка) < 444 Тогда 
			   
			  	Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &УЕК
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 = &УЕК
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
       // Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
	    Запрос.УстановитьПараметр("ЦФО", ЦФО);
	   
	ИначеЕсли СтатьяДР_Код = "330" 
		 ИЛИ СтатьяДР_Код = "340" Или СтатьяДР_Код = "350" 
		 ИЛИ СтатьяДР_Код = "351" Или СтатьяДР_Код = "361" 
		 ИЛИ СтатьяДР_Код = "371" Или СтатьяДР_Код = "392"  
		 ИЛИ СтатьяДР_Код = "393" Или СтатьяДР_Код = "410" Или СтатьяДР_Код = "810" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&Общие)
		                |				И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 В ИЕРАРХИИ (&Общие)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "05" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "10" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""10"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&Счет01),
		               |			,
		               |			Субконто3 = &ЦФО
		               |				И (ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |						И КорСубконто2 <> &КорСубконто2
		               |					ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&Счет01)
		               |					И Субконто3 = &ЦФО
		               |					И (ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |							И КорСубконто2 <> &КорСубконто2
		               |						ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("Счет01", ПланыСчетов.Финансовый.Инвестиции);	
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));		   
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "20110" Или СтатьяДР_Код = "20120" 
		 ИЛИ СтатьяДР_Код = "20121" Или СтатьяДР_Код = "20210" 
		 ИЛИ СтатьяДР_Код = "20213" Или СтатьяДР_Код = "20214" 
		 ИЛИ СтатьяДР_Код = "20310" Или СтатьяДР_Код = "20320"  
		 ИЛИ СтатьяДР_Код = "20330" Или СтатьяДР_Код = "20332" 
		 ИЛИ СтатьяДР_Код = "20410" Или СтатьяДР_Код = "20510" 
		 ИЛИ СтатьяДР_Код = "20520" Или СтатьяДР_Код = "20610" 
		 ИЛИ СтатьяДР_Код = "20612" Или СтатьяДР_Код = "20613"  
		 ИЛИ СтатьяДР_Код = "20742" Или СтатьяДР_Код = "20901" 
		 ИЛИ СтатьяДР_Код = "21001" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 = &ЗатратыПеременные
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 = &ЗатратыПеременные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли (СтатьяДР_Код = "31010"  Или СтатьяДР_Код = "31012"
		 ИЛИ СтатьяДР_Код = "31013" Или СтатьяДР_Код = "32023" 
		 ИЛИ СтатьяДР_Код = "32024" Или СтатьяДР_Код = "32025" 
		 ИЛИ СтатьяДР_Код = "32026" Или СтатьяДР_Код = "33120" 
		 ИЛИ СтатьяДР_Код = "33110" Или СтатьяДР_Код = "33121" 
		 ИЛИ СтатьяДР_Код = "35012" Или СтатьяДР_Код = "35013" 
		 ИЛИ СтатьяДР_Код = "35014" Или СтатьяДР_Код = "35015" 
		 ИЛИ СтатьяДР_Код = "35110" Или СтатьяДР_Код = "38110" 
		 ИЛИ СтатьяДР_Код = "38111" Или СтатьяДР_Код = "38112" 
		 ИЛИ СтатьяДР_Код = "38115" Или СтатьяДР_Код = "39110" 
		 ИЛИ СтатьяДР_Код = "39111" Или СтатьяДР_Код = "39112" 
		 ИЛИ СтатьяДР_Код = "39113" Или СтатьяДР_Код = "39114"  
		 ИЛИ СтатьяДР_Код = "39210" Или СтатьяДР_Код = "39220" 
		 ИЛИ СтатьяДР_Код = "39230" Или СтатьяДР_Код = "39290" 
		 ИЛИ СтатьяДР_Код = "39311" Или СтатьяДР_Код = "39312"
         ИЛИ СтатьяДР_Код = "39313" Или СтатьяДР_Код = "39320" 
		 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39399" 
		 ИЛИ СтатьяДР_Код = "39115" Или СтатьяДР_Код = "39116") И СтатьяГруппировка = "Постоянные затраты" Тогда 
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &ЗатратыПостоянные И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442 И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 = &ЗатратыПостоянные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);

		ИначеЕсли СтатьяДР_Код = "33010" Или СтатьяДР_Код = "33011"
			 ИЛИ СтатьяДР_Код = "34010" Или СтатьяДР_Код = "34011" 
			 ИЛИ СтатьяДР_Код = "35010" Или СтатьяДР_Код = "35011" 
			 ИЛИ СтатьяДР_Код = "35113" Или СтатьяДР_Код = "36110"  
			 ИЛИ СтатьяДР_Код = "36120" Или СтатьяДР_Код = "36190" 
			 ИЛИ СтатьяДР_Код = "36198" Или СтатьяДР_Код = "36201" 
			 ИЛИ СтатьяДР_Код = "37110" Или СтатьяДР_Код = "37115"   
			 ИЛИ СтатьяДР_Код = "37120" Или СтатьяДР_Код = "37190"  
			 ИЛИ СтатьяДР_Код = "37195" Или СтатьяДР_Код = "39230" 
			 ИЛИ СтатьяДР_Код = "39314" Или СтатьяДР_Код = "39320" 
			 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39397"
			 ИЛИ СтатьяДР_Код = "39399" Или СтатьяДР_Код = "41010"  
			 ИЛИ СтатьяДР_Код = "41020" Или СтатьяДР_Код = "41021" 
			 ИЛИ СтатьяДР_Код = "41022" Или СтатьяДР_Код = "41029" 
			 ИЛИ СтатьяДР_Код = "81010" Или СтатьяДР_Код = "81011"
             ИЛИ СтатьяДР_Код = "81012" Или СтатьяДР_Код = "81013"
			Тогда   
  

		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		               	|			СубконтоДт2 = &Общие И СубконтоДт3 = &ЦФО И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт2 = &Общие И СубконтоДт3 = &ЦФО И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);

	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ОбщийСтатьиЦФО(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	Попытка
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
	Исключение
		Попытка
			ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
			ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
			СтатьяГруппировка = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
		Исключение
			ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
			ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
			СтатьяГруппировка = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
		
		КонецПопытки;
	КонецПопытки;
	
	СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = СтатьяДР_Наименование;
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто3 = &ЦФО
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто3 = &ЦФО
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
				   
	ИначеЕсли СтатьяДР_Код = "02" Или СтатьяДР_Код = "201" 
		 ИЛИ СтатьяДР_Код = "202" Или СтатьяДР_Код = "203" 
		 ИЛИ СтатьяДР_Код = "204" Или СтатьяДР_Код = "205" 
		 ИЛИ СтатьяДР_Код = "206" Или СтатьяДР_Код = "207"  
		 ИЛИ СтатьяДР_Код = "209" Или СтатьяДР_Код = "210" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт3 = &ЦФО
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("ЦФО", ЦФО); 
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	ИначеЕсли (СтатьяДР_Код = "310" 
		 ИЛИ СтатьяДР_Код = "320" Или СтатьяДР_Код = "331" 
		 ИЛИ СтатьяДР_Код = "350" Или СтатьяДР_Код = "351" 
		 ИЛИ СтатьяДР_Код = "381" Или СтатьяДР_Код = "391"  
		 ИЛИ СтатьяДР_Код = "392" Или СтатьяДР_Код = "393") И СтатьяГруппировка = "Постоянные затраты" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "410" И СтатьяГруппировка = "Постоянные затраты" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 В ИЕРАРХИИ (&УЕК) И СубконтоДт3 = &ЦФО
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли (СтатьяДР_Код = "41023" ИЛИ СтатьяДР_Код = "41025"
		       ИЛИ СтатьяДР_Код = "41027" ИЛИ СтатьяДР_Код = "41028"
			   ИЛИ СтатьяДР_Код = "41029") И Число(Расшифровка) < 444 Тогда 
			   
			  	Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &УЕК
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт2 = &УЕК
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
       // Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
	    Запрос.УстановитьПараметр("ЦФО", ЦФО);
	   
	ИначеЕсли СтатьяДР_Код = "330" 
		 ИЛИ СтатьяДР_Код = "340" Или СтатьяДР_Код = "350" 
		 ИЛИ СтатьяДР_Код = "351" Или СтатьяДР_Код = "361" 
		 ИЛИ СтатьяДР_Код = "371" Или СтатьяДР_Код = "392"  
		 ИЛИ СтатьяДР_Код = "393" Или СтатьяДР_Код = "410" Или СтатьяДР_Код = "810" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 В ИЕРАРХИИ (&Общие)
		                |				И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 В ИЕРАРХИИ (&Общие)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "05" Тогда   
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "10" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""10"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&Счет01),
		               |			,
		               |			Субконто3 = &ЦФО
		               |				И (ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |						И КорСубконто2 <> &КорСубконто2
		               |					ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&Счет01)
		               |					И Субконто3 = &ЦФО
		               |					И (ТИПЗНАЧЕНИЯ(КорСубконто2) = ТИПЗНАЧЕНИЯ(&КорСубконто2)
		               |							И КорСубконто2 <> &КорСубконто2
		               |						ИЛИ ТИПЗНАЧЕНИЯ(КорСубконто2) <> ТИПЗНАЧЕНИЯ(&КорСубконто2))
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("Счет01", ПланыСчетов.Финансовый.Инвестиции);	
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));		   
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "20110" Или СтатьяДР_Код = "20120" 
		 ИЛИ СтатьяДР_Код = "20121" Или СтатьяДР_Код = "20210" 
		 ИЛИ СтатьяДР_Код = "20213" Или СтатьяДР_Код = "20214" 
		 ИЛИ СтатьяДР_Код = "20310" Или СтатьяДР_Код = "20320"  
		 ИЛИ СтатьяДР_Код = "20330" Или СтатьяДР_Код = "20332" 
		 ИЛИ СтатьяДР_Код = "20410" Или СтатьяДР_Код = "20510" 
		 ИЛИ СтатьяДР_Код = "20520" Или СтатьяДР_Код = "20610" 
		 ИЛИ СтатьяДР_Код = "20612" Или СтатьяДР_Код = "20613"  
		 ИЛИ СтатьяДР_Код = "20742" Или СтатьяДР_Код = "20901" 
		 ИЛИ СтатьяДР_Код = "21001" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 = &ЗатратыПеременные
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И СубконтоДт3 = &ЦФО
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 = &ЗатратыПеременные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 	
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли (СтатьяДР_Код = "31010"  Или СтатьяДР_Код = "31012"
		 ИЛИ СтатьяДР_Код = "31013" Или СтатьяДР_Код = "32023" 
		 ИЛИ СтатьяДР_Код = "32024" Или СтатьяДР_Код = "32025" 
		 ИЛИ СтатьяДР_Код = "32026" Или СтатьяДР_Код = "33120" 
		 ИЛИ СтатьяДР_Код = "33110" Или СтатьяДР_Код = "33121" 
		 ИЛИ СтатьяДР_Код = "35012" Или СтатьяДР_Код = "35013" 
		 ИЛИ СтатьяДР_Код = "35014" Или СтатьяДР_Код = "35015" 
		 ИЛИ СтатьяДР_Код = "35110" Или СтатьяДР_Код = "38110" 
		 ИЛИ СтатьяДР_Код = "38111" Или СтатьяДР_Код = "38112" 
		 ИЛИ СтатьяДР_Код = "38115" Или СтатьяДР_Код = "39110" 
		 ИЛИ СтатьяДР_Код = "39111" Или СтатьяДР_Код = "39112" 
		 ИЛИ СтатьяДР_Код = "39113" Или СтатьяДР_Код = "39114"  
		 ИЛИ СтатьяДР_Код = "39210" Или СтатьяДР_Код = "39220" 
		 ИЛИ СтатьяДР_Код = "39230" Или СтатьяДР_Код = "39290" 
		 ИЛИ СтатьяДР_Код = "39311" Или СтатьяДР_Код = "39312"
         ИЛИ СтатьяДР_Код = "39313" Или СтатьяДР_Код = "39320" 
		 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39399" 
		 ИЛИ СтатьяДР_Код = "39115" Или СтатьяДР_Код = "39116") И СтатьяГруппировка = "Постоянные затраты" Тогда 
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			СубконтоДт2 = &ЗатратыПостоянные И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442 И СубконтоДт3 = &ЦФО
		                |					И СубконтоДт2 = &ЗатратыПостоянные
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);

		ИначеЕсли СтатьяДР_Код = "33010" Или СтатьяДР_Код = "33011"
			 ИЛИ СтатьяДР_Код = "34010" Или СтатьяДР_Код = "34011" 
			 ИЛИ СтатьяДР_Код = "35010" Или СтатьяДР_Код = "35011" 
			 ИЛИ СтатьяДР_Код = "35113" Или СтатьяДР_Код = "36110"  
			 ИЛИ СтатьяДР_Код = "36120" Или СтатьяДР_Код = "36190" 
			 ИЛИ СтатьяДР_Код = "36198" Или СтатьяДР_Код = "36201" 
			 ИЛИ СтатьяДР_Код = "37110" Или СтатьяДР_Код = "37115"   
			 ИЛИ СтатьяДР_Код = "37120" Или СтатьяДР_Код = "37190"  
			 ИЛИ СтатьяДР_Код = "37195" Или СтатьяДР_Код = "39230" 
			 ИЛИ СтатьяДР_Код = "39314" Или СтатьяДР_Код = "39320" 
			 ИЛИ СтатьяДР_Код = "39391" Или СтатьяДР_Код = "39397"
			 ИЛИ СтатьяДР_Код = "39399" Или СтатьяДР_Код = "41010"  
			 ИЛИ СтатьяДР_Код = "41020" Или СтатьяДР_Код = "41021" 
			 ИЛИ СтатьяДР_Код = "41022" Или СтатьяДР_Код = "41029" 
			 ИЛИ СтатьяДР_Код = "81010" Или СтатьяДР_Код = "81011"
             ИЛИ СтатьяДР_Код = "81012" Или СтатьяДР_Код = "81013"
			Тогда   
  

		 Запрос.Текст = "ВЫБРАТЬ
		                |	""05"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт = &Счет442,
		                |			,
		               	|			СубконтоДт2 = &Общие И СубконтоДт3 = &ЦФО И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт = &Счет442
		                |					И СубконтоДт2 = &Общие И СубконтоДт3 = &ЦФО И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		//Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("Общие", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(СтатьяДР_Код));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        //Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);

	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ВкусВилл(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	ГруппаУр1 = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[1].ПолучитьПоля()[0].Значение;
	СтруктурнаяЕдиница = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
	Если ГруппаУр1 = "Выручка" Тогда
		СтатьяДР_Код = "01";
	ИначеЕсли ГруппаУр1 = "Переменные затраты" Тогда
		СтатьяДР_Код = "02";
	ИначеЕсли ГруппаУр1 = "Постоянные затраты" Тогда
		СтатьяДР_Код = "03";
	Иначе
		Возврат;
	КонецЕсли;
	
	//СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	//СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	//пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = ГруппаУр1 + " - " + Строка(СтруктурнаяЕдиница);
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто1 = &СтруктурнаяЕдиница
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто1 = &СтруктурнаяЕдиница
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
				   
	ИначеЕсли СтатьяДР_Код = "02" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);  
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);

		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_Избенка(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	ГруппаУр1 = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[1].ПолучитьПоля()[0].Значение;
	СтруктурнаяЕдиница = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
	Если ГруппаУр1 = "Выручка" Тогда
		СтатьяДР_Код = "01";
	ИначеЕсли ГруппаУр1 = "Переменные затраты" Тогда
		СтатьяДР_Код = "02";
	ИначеЕсли ГруппаУр1 = "Постоянные затраты" Тогда
		СтатьяДР_Код = "03";
	Иначе
		Возврат;
	КонецЕсли;
	
	//СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	//СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	//пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = ГруппаУр1 + " - " + Строка(СтруктурнаяЕдиница);
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто1 = &СтруктурнаяЕдиница
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто1 = &СтруктурнаяЕдиница
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
				   
	ИначеЕсли СтатьяДР_Код = "02" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);  
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);

		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ВкусВиллЦФО(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	
	Попытка
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
	Исключение
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	

	КонецПопытки;
	
	ГруппаУр1 = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[1].ПолучитьПоля()[0].Значение;
	СтруктурнаяЕдиница = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
	Если ГруппаУр1 = "Выручка" Тогда
		СтатьяДР_Код = "01";
	ИначеЕсли ГруппаУр1 = "Переменные затраты" Тогда
		СтатьяДР_Код = "02";
	ИначеЕсли ГруппаУр1 = "Постоянные затраты" Тогда
		СтатьяДР_Код = "03";
	Иначе
		Возврат;
	КонецЕсли;
	
	//СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	//СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	//пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = ГруппаУр1 + " - " + Строка(СтруктурнаяЕдиница);
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто3 = &ЦФО
		               |				И Субконто1 = &СтруктурнаяЕдиница
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто3 = &ЦФО
		               |					И Субконто1 = &СтруктурнаяЕдиница
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
		Запрос.УстановитьПараметр("ЦФО", ЦФО);		   
		
	ИначеЕсли СтатьяДР_Код = "02" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И СубконтоДт3 = &ЦФО
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);  
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница И СубконтоДт3 = &ЦФО
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница И СубконтоДт3 = &ЦФО
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Магазин);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
        Запрос.УстановитьПараметр("ЦФО", ЦФО);
		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ИзбенкаЦФО(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	
	Попытка
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].получитьродителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	
	Исключение
		ЦФО = ДанныеРасшифровки.Элементы[ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьРодителей()[0].Идентификатор].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
		ЦФО = ?(ЦФО = "", Справочники.СтруктурныеЕдиницы.ПустаяСсылка(), ЦФО);
		СтатьяГруппировка = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;	

	КонецПопытки;
	
	ГруппаУр1 = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[1].ПолучитьПоля()[0].Значение;
	СтруктурнаяЕдиница = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
	Если ГруппаУр1 = "Выручка" Тогда
		СтатьяДР_Код = "01";
	ИначеЕсли ГруппаУр1 = "Переменные затраты" Тогда
		СтатьяДР_Код = "02";
	ИначеЕсли ГруппаУр1 = "Постоянные затраты" Тогда
		СтатьяДР_Код = "03";
	Иначе
		Возврат;
	КонецЕсли;
	
	//СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	//СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	//пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = ГруппаУр1 + " - " + Строка(СтруктурнаяЕдиница);
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто3 = &ЦФО
		               |				И Субконто1 = &СтруктурнаяЕдиница
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто3 = &ЦФО
		               |					И Субконто1 = &СтруктурнаяЕдиница
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		
	ИначеЕсли СтатьяДР_Код = "02" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт3 = &ЦФО
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И СубконтоДт3 = &ЦФО
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);  
		Запрос.УстановитьПараметр("ЦФО", ЦФО); 
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные) И СубконтоДт3 = &ЦФО
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442 И СубконтоДт3 = &ЦФО
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.Избенка);
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
        Запрос.УстановитьПараметр("ЦФО", ЦФО);

		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура РасшифроватьПоДокументам_ТТ(Расшифровка)
	//пКонтрагент = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьПоля()[0].Значение;
	ГруппаУр1 = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[1].ПолучитьПоля()[0].Значение;
	СтруктурнаяЕдиница = ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение;
	Если ГруппаУр1 = "Выручка" Тогда
		СтатьяДР_Код = "01";
	ИначеЕсли ГруппаУр1 = "Переменные затраты" Тогда
		СтатьяДР_Код = "02";
	ИначеЕсли ГруппаУр1 = "Постоянные затраты" Тогда
		СтатьяДР_Код = "03";
	Иначе
		Возврат;
	КонецЕсли;
	
	//СтатьяДР_Код = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[1].Значение);
	//СтатьяДР_Наименование = СокрЛП(ДанныеРасшифровки.Элементы[Расшифровка].ПолучитьРодителей()[0].ПолучитьПоля()[0].Значение);
	
	//пПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	
	НачалоПериода = ЭлементыФормы.ДинамическийОтборДатаНачала.Значение;
	КонецПериода  = ЭлементыФормы.ДинамическийОтборДатаОкончания.Значение;
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("РасшифровкаПоДокументам");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
//	ОбластьОрганизация = Макет.ПолучитьОбласть("СтрокаОрганизация");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтоги = Макет.ПолучитьОбласть("Итоги");
	//
	ОбластьШапка.Параметры.Код = СтатьяДР_Код;
	ОбластьШапка.Параметры.Статья = ГруппаУр1 + " - " + Строка(СтруктурнаяЕдиница);
	
	ТабДокумент.Вывести(ОбластьШапка);
	//
	Запрос = Новый Запрос;
	Если СтатьяДР_Код = "01" Тогда				   
		
		Запрос.Текст = "ВЫБРАТЬ
		               |	""01"" КАК Код,
		               |	ФинансовыйОбороты.Регистратор КАК Документ,
		               |	СУММА(-ФинансовыйОбороты.СуммаОборот) КАК Сумма
		               |ПОМЕСТИТЬ ВремТаб
		               |ИЗ
		               |	РегистрБухгалтерии.Финансовый.Обороты(
		               |			&НачалоПериода,
		               |			&КонецПериода,
		               |			Регистратор,
		               |			Счет В ИЕРАРХИИ (&СчетПродажи),
		               |			,
		               |			Субконто2 В ИЕРАРХИИ (&Выручка)
		               |				И Субконто1 = &СтруктурнаяЕдиница
		               |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |					ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |			,
		               |			) КАК ФинансовыйОбороты
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ФинансовыйОбороты.Регистратор
		               |;
		               |
		               |////////////////////////////////////////////////////////////////////////////////
		               |ВЫБРАТЬ
		               |	ВремТаб.Документ,
		               |	ВремТаб.Сумма,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		               |ИЗ
		               |	ВремТаб КАК ВремТаб
		               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		               |				&НачалоПериода,
		               |				&КонецПериода,
		               |				Счет В ИЕРАРХИИ (&СчетПродажи)
		               |					И Субконто2 В ИЕРАРХИИ (&Выручка)
		               |					И Субконто1 = &СтруктурнаяЕдиница
		               |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		               |						ИЛИ Субконто1.ТипРозничнойТочки = &Проект),
		               |				,
		               |				) КАК ФинансовыйДвиженияССубконто
		               |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		               |
		               |СГРУППИРОВАТЬ ПО
		               |	ВремТаб.Документ,
		               |	ФинансовыйДвиженияССубконто.Содержание,
		               |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		               |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		               |	ВремТаб.Сумма
		               |
		               |УПОРЯДОЧИТЬ ПО
		               |	ВремТаб.Документ.Дата";
				   
		Запрос.УстановитьПараметр("Выручка", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);
				   
	ИначеЕсли СтатьяДР_Код = "02" Тогда
		 
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""02"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |				И НЕ СубконтоДт2 = &КорСубконто2
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |					И СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&УЕК)
		                |					И НЕ СубконтоДт2 = &КорСубконто2
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("3"));
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010")); 		
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);  
		
	ИначеЕсли СтатьяДР_Код = "03" Тогда 
		
		 Запрос.Текст = "ВЫБРАТЬ
		                |	""03"" КАК Код,
		                |	СУММА(-ФинансовыйОборотыДтКт.СуммаОборот) КАК Сумма,
		                |	ФинансовыйОборотыДтКт.Регистратор КАК Документ
		                |ПОМЕСТИТЬ ВремТаб
		                |ИЗ
		                |	РегистрБухгалтерии.Финансовый.ОборотыДтКт(
		                |			&НачалоПериода,
		                |			&КонецПериода,
		                |			Регистратор,
		                |			СчетДт В ИЕРАРХИИ (&СчетПродажи),
		                |			,
		                |			СчетКт В ИЕРАРХИИ (&Счет44)
		                |				И НЕ СчетКт = &Счет442,
		                |			,
		                |			(СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |				ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |				И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |				И СубконтоДт1 = &СтруктурнаяЕдиница
		                |				И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |					ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект)) КАК ФинансовыйОборотыДтКт
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйОборотыДтКт.Регистратор
		                |;
		                |
		                |////////////////////////////////////////////////////////////////////////////////
		                |ВЫБРАТЬ
		                |	ВремТаб.Сумма,
		                |	ВремТаб.Документ,
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)) КАК Комментарий,
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный КАК Автор
		                |ИЗ
		                |	ВремТаб КАК ВремТаб
		                |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Финансовый.ДвиженияССубконто(
		                |				&НачалоПериода,
		                |				&КонецПериода,
		                |				СчетДт В ИЕРАРХИИ (&СчетПродажи)
		                |					И СчетКт В ИЕРАРХИИ (&Счет44)
		                |					И НЕ СчетКт = &Счет442
		                |					И (СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПостоянные)
		                |						ИЛИ СубконтоДт2 В ИЕРАРХИИ (&УЕК))
		                |					И НЕ СубконтоДт2 В ИЕРАРХИИ (&ЗатратыПеременные)
		                |					И СубконтоДт1 = &СтруктурнаяЕдиница
		                |					И (&Проект = ЗНАЧЕНИЕ(Перечисление.ТипыРозничныхТочек.ПустаяСсылка)
		                |						ИЛИ СубконтоДт1.ТипРозничнойТочки = &Проект),
		                |				,
		                |				) КАК ФинансовыйДвиженияССубконто
		                |		ПО ВремТаб.Документ = ФинансовыйДвиженияССубконто.Регистратор
		                |
		                |СГРУППИРОВАТЬ ПО
		                |	ФинансовыйДвиженияССубконто.Регистратор.Ответственный,
		                |	ВЫРАЗИТЬ(ФинансовыйДвиженияССубконто.Регистратор.Комментарий КАК СТРОКА(500)),
		                |	ФинансовыйДвиженияССубконто.Содержание,
		                |	ВремТаб.Документ,
		                |	ВремТаб.Сумма";
				   
		Запрос.УстановитьПараметр("ЗатратыПеременные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("2"));
		Запрос.УстановитьПараметр("ЗатратыПостоянные", Справочники.СтатьиДоходовРасходов.НайтиПоКоду(Строка(Число(СтатьяДР_Код))));
		Запрос.УстановитьПараметр("Проект", Перечисления.ТипыРозничныхТочек.ПустаяСсылка());
	    Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(НачалоПериода));
	    Запрос.УстановитьПараметр("КонецПериода", КонецДня(КонецПериода));
		Запрос.УстановитьПараметр("СчетПродажи", ПланыСчетов.Финансовый.Продажи);
		Запрос.УстановитьПараметр("Счет44", ПланыСчетов.Финансовый.ЗатратыДляРаспределения);
        Запрос.УстановитьПараметр("Счет442", ПланыСчетов.Финансовый.ЗатратыОбщиеДляРаспределения);
        Запрос.УстановитьПараметр("УЕК", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("4"));
		Запрос.УстановитьПараметр("СтруктурнаяЕдиница", СтруктурнаяЕдиница);

		//Запрос.УстановитьПараметр("КорСубконто2", Справочники.СтатьиДоходовРасходов.НайтиПоКоду("61010"));	
		
	Иначе
		Возврат;
	КонецЕсли;		  
	
	Выгрузка = Запрос.Выполнить().Выгрузить();
	ВыгрузкаКопия = Выгрузка.Скопировать();
	ВыгрузкаКопия.Свернуть("Документ");
	//Выборка = Запрос.Выполнить().Выбрать();
	Итог = 0;
	МассивДокументу = ВыгрузкаКопия.ВыгрузитьКолонку("Документ");
	Для Каждого Документ Из МассивДокументу Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("Документ", Документ);
		НайденныеСтроки = Выгрузка.НайтиСтроки(Отбор);
		Содержание = "";
		Автор = "";
		Комментарий = "";
		Сумма = 0;
		
		Для Каждого Строка Из НайденныеСтроки Цикл
			Содержание = Содержание + Строка.Содержание + ", ";		
			Автор = Строка.Автор;
			Комментарий = Строка.Комментарий;
			Сумма = Строка.Сумма;
		КонецЦикла;
		
		Содержание = Лев(Содержание, СтрДлина(СокрЛП(Содержание)) - 1);
		ОбластьСтрока.Параметры.Документ = Документ;
		ОбластьСтрока.Параметры.Содержание = Содержание;
		ОбластьСтрока.Параметры.Автор = Автор;
		ОбластьСтрока.Параметры.Комментарий = Комментарий;
		ОбластьСтрока.Параметры.Сумма = Сумма;
		
        ТабДокумент.Вывести(ОбластьСтрока);
		Итог = Итог + Сумма;
		
	КонецЦикла;
	//
	ОбластьИтоги.Параметры.Сумма = Итог;
	ТабДокумент.Вывести(ОбластьИтоги);
	
	ТабДокумент.ТолькоПросмотр = Истина;
	ТабДокумент.Показать("Расшифровка по документам");
КонецПроцедуры

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	
	Если РежимРедактированияНастройки Тогда
		СтандартнаяОбработка = Ложь;
		Возврат;
	КонецЕсли;
	
	ИнфокомТиповыеОтчеты.ОбработкаЗакрытияНастройкиОтчета(ЭтотОбъект, ЭтаФорма, Отказ, СтандартнаяОбработка);
	Если Не ЭтоОтработкаРасшифровки И Не РежимРедактированияНастройки Тогда
		ИнфокомТиповыеОтчеты.СохранитьПоследнююИспользуемуюНастройку(ЭтотОбъект);
	КонецЕсли;
	
КонецПроцедуры

// ОБРАБОТЧИКИ ЭЛЕМЕНТОВ ФОРМЫ НА ПАНЕЛИ

Процедура ОтборПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	ОформлениеСтроки.Ячейки.ЛевоеЗначениеДляКраткогоОтображенияЭлемента.ОтображатьКартинку = Ложь;
	
КонецПроцедуры

Процедура ОбработкаНажатияКнопкиСохраненнойНастройки(Элемент)
	
	ИнфокомТиповыеОтчеты.ВыборВариантаОтчетаНаПанелиВариантов(ЭтотОбъект, ЭтаФорма, Элемент);
		
КонецПроцедуры

Процедура ДействияПанелиСохранитьСписок(Элемент)
	
	ИнфокомТиповыеОтчеты.СохранитьСписокВТабличномПоле(ЭтотОбъект, ЭлементыФормы, Элемент);
		
КонецПроцедуры

Процедура ДействияПанелиЗагрузитьСписок(Элемент)
	
	ИнфокомТиповыеОтчеты.ЗагрузитьСписокВТабличноеПоле(ЭтотОбъект, ЭлементыФормы, Элемент);
		
КонецПроцедуры

Процедура ДействияПанелиСтандартныйПериодПользователяПриИзменении(Элемент)
	
	СтандартныйПериод.Вариант = Элемент.Значение;
	
КонецПроцедуры

Процедура ДействияПанелиСтандартнаяДатаНачалаПользователяПриИзменении(Элемент)
	
	СтандартнаяДатаНачала.Вариант = Элемент.Значение;
	
КонецПроцедуры

Процедура ДействияПанелиДатаСтандартногоПериодаПриИзменении(Элемент)
	
	ЭлементыФормы.ДинамическийОтборСтандартныйПериодПользователя.Значение = ВариантСтандартногоПериода.ПроизвольныйПериод;
	
КонецПроцедуры

Процедура ДействияПанелиДатаСтандартнойДатыНачалаПриИзменении(Элемент)
	
	ЭлементыФормы.ДинамическийОтборСтандартнаяДатаНачалаПользователя.Значение = ВариантСтандартнойДатыНачала.ПроизвольнаяДата;
	
КонецПроцедуры

Процедура ДействияПанелиИзменениеЗначенияДинамическогоОтбора(Элемент)
	
	ИнфокомТиповыеОтчеты.ОбработкаИзмененияЗначенияДинамическогоОтбора(ЭлементыФормы, Элемент);
	
КонецПроцедуры

Процедура ДействияПанелиОкончаниеРедактированиеТабличногоПоля(Элемент, НоваяСтрока, ОтменаРедактирования)
	
	ИнфокомТиповыеОтчеты.ОбновитьИзмененияТабличногоПоля(ЭлементыФормы, Элемент);
	
КонецПроцедуры

Процедура ДействияПанелиУдалениеСтрокиТабличногоПоля(Элемент)
	
	ИнфокомТиповыеОтчеты.ОбновитьИзмененияТабличногоПоля(ЭлементыФормы, Элемент);
	
КонецПроцедуры
                                                              
Процедура ДействияПанелиКнопкаПодборНажатие(Элемент)
	Отбор = ИнфокомТиповыеОтчеты.ПолучитьОтборИзФормы(ОтчетОбъект, ЭтаФорма, Элемент);
	Если Отбор.СтрокаОтбора.Поле = "ДанныеОРаботнике.ПодразделениеОрганизации" тогда
		Отбор = ИнфокомТиповыеОтчеты.ПолучитьОтборИзФормы(ОтчетОбъект, ЭтаФорма, "ДанныеОРаботнике.ОбособленноеПодразделение");
		//Параметр = ИнфокомТиповыеОтчеты.ПолучитьПараметрИзФормы(ОтчетОбъект, ЭтаФорма, "РежимОтчета");
		ЗначениеВладельца = Отбор.Значение;
	КонецЕсли;
	ИнфокомТиповыеОтчеты.ОбработкаНажатияКнопкиПодбор(ЭтотОбъект, ЭтаФорма, Элемент, ЗначениеВладельца);
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////////////////////

Процедура ПослеВыводаПанелиПользователя(ЗначениеНастроек) Экспорт
	
КонецПроцедуры

Процедура ПриПолучениеНастроекПользователя(ЗначенияНастроек) Экспорт
	
КонецПроцедуры

Процедура ПослеВыводаПериода(СтруктураЭлементовУправления) Экспорт
	
КонецПроцедуры

Процедура ПослеВыводаПараметра(СтруктураЭлементовУправления) Экспорт
	
КонецПроцедуры

Процедура ПослеВыводаГруппировки(СтруктураЭлементовУправления) Экспорт
	
КонецПроцедуры

Процедура ПослеВыводаОтбора(СтруктураЭлементовУправления) Экспорт
	
КонецПроцедуры

Процедура ПриНажатииНаКнопкуВверх(Кнопка)
	ИнфокомТиповыеОтчеты.ПриНажатииКнопкиВверхВниз(ЭтаФорма, ОтчетОбъект, Кнопка);
КонецПроцедуры

Процедура ПриНажатииНаКнопкуВниз(Кнопка)
	ИнфокомТиповыеОтчеты.ПриНажатииКнопкиВверхВниз(ЭтаФорма, ОтчетОбъект, Кнопка);
КонецПроцедуры

Процедура ПриЗакрытии()
	
	ИнфокомТиповыеОтчеты.СохранитьНастройкиФормыОтчета(ОтчетОбъект, ЭтаФорма);
	
КонецПроцедуры

Процедура ГруппировкиПриПолученииДанных(Элемент, ОформленияСтрок)
	ИнфокомТиповыеОтчеты.ГруппировкаПриПолученииДанных(Элемент, ОформленияСтрок);
КонецПроцедуры

Процедура ДействияПанелиДинамическийОтборПериодВыборПриИзменении(Элемент)
	
	ИнфокомТиповыеОтчеты.ДействияПанелиДинамическийОтборПериодВыборПриИзменении(ЭтаФорма, Элемент)
	
КонецПроцедуры	
	
Процедура ДействияПанелиДинамическийОтборПериодВыборПриНачалеВыбораИзСписка(Элемент, СтандартнаяОбработка)
	
	ИнфокомТиповыеОтчеты.ДействияПанелиДинамическийОтборПериодВыборПриНачалеВыбораИзСписка(ЭтаФорма, Элемент, СтандартнаяОбработка)
	
КонецПроцедуры	
	
Процедура ДействияПанелиДинамическийОтборПериодВыборАвтоПодборТекста(Элемент, Текст, ТекстАвтоПодбора, СтандартнаяОбработка) 
	
	ИнфокомТиповыеОтчеты.ДействияПанелиДинамическийОтборПериодВыборАвтоПодборТекста(ЭтаФорма, Элемент, Текст, ТекстАвтоПодбора, СтандартнаяОбработка)
	
КонецПроцедуры	
	
Процедура ДействияПанелиДинамическийОтборПериодВыборОчистка(Элемент, СтандартнаяОбработка) 
	
	ИнфокомТиповыеОтчеты.ДействияПанелиДинамическийОтборПериодВыборОчистка(ЭтаФорма, Элемент, СтандартнаяОбработка)
	
КонецПроцедуры	
	
Процедура ДействияПанелиДинамическийОтборПериодВыборОкончаниеВводаТекста(Элемент, Текст, Значение, СтандартнаяОбработка) 
	
	ИнфокомТиповыеОтчеты.ДействияПанелиДинамическийОтборПериодВыборОкончаниеВводаТекстаОкончаниеВводаТекста(ЭтаФорма, Элемент, Текст, Значение, СтандартнаяОбработка)
	
КонецПроцедуры	

Процедура НадписьПредупреждениеНажатие(Элемент)
	
	
КонецПроцедуры

Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.УстановитьПериод(НачПериода, ?(КонПериода='0001-01-01', КонПериода, КонецДня(КонПериода)));
	Если НастройкаПериода.Редактировать() Тогда
		НачПериода = НастройкаПериода.ПолучитьДатуНачала();
		КонПериода = НастройкаПериода.ПолучитьДатуОкончания();
	КонецЕсли;
КонецПроцедуры

                                                                                           
СоответствиеНастройкаРезультат = Новый Соответствие;

ДействияЭлементовФормы = Новый Структура;
ДействияЭлементовФормы.Вставить("ДействияПанелиДинамическийОтборПериодВыборПриИзменении", Новый Действие("ДействияПанелиДинамическийОтборПериодВыборПриИзменении"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДинамическийОтборПериодВыборПриНачалеВыбораИзСписка", Новый Действие("ДействияПанелиДинамическийОтборПериодВыборПриНачалеВыбораИзСписка"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДинамическийОтборПериодВыборАвтоПодборТекста", Новый Действие("ДействияПанелиДинамическийОтборПериодВыборАвтоПодборТекста"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДинамическийОтборПериодВыборОчистка", Новый Действие("ДействияПанелиДинамическийОтборПериодВыборОчистка"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДинамическийОтборПериодВыборОкончаниеВводаТекста", Новый Действие("ДействияПанелиДинамическийОтборПериодВыборОкончаниеВводаТекста"));

ДействияЭлементовФормы.Вставить("ОбработкаНажатияКнопкиСохраненнойНастройки", Новый Действие("ОбработкаНажатияКнопкиСохраненнойНастройки"));
ДействияЭлементовФормы.Вставить("ДействияПанелиСохранитьСписок", Новый Действие("ДействияПанелиСохранитьСписок"));
ДействияЭлементовФормы.Вставить("ДействияПанелиЗагрузитьСписок", Новый Действие("ДействияПанелиЗагрузитьСписок"));
ДействияЭлементовФормы.Вставить("ДействияПанелиСтандартныйПериодПользователяПриИзменении", Новый Действие("ДействияПанелиСтандартныйПериодПользователяПриИзменении"));
ДействияЭлементовФормы.Вставить("ДействияПанелиСтандартнаяДатаНачалаПользователяПриИзменении", Новый Действие("ДействияПанелиСтандартнаяДатаНачалаПользователяПриИзменении"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДатаСтандартногоПериодаПриИзменении", Новый Действие("ДействияПанелиДатаСтандартногоПериодаПриИзменении"));
ДействияЭлементовФормы.Вставить("ДействияПанелиДатаСтандартнойДатыНачалаПриИзменении", Новый Действие("ДействияПанелиДатаСтандартнойДатыНачалаПриИзменении"));
ДействияЭлементовФормы.Вставить("ДействияПанелиИзменениеЗначенияДинамическогоОтбора", Новый Действие("ДействияПанелиИзменениеЗначенияДинамическогоОтбора"));
ДействияЭлементовФормы.Вставить("ДействияПанелиОкончаниеРедактированиеТабличногоПоля", Новый Действие("ДействияПанелиОкончаниеРедактированиеТабличногоПоля"));
ДействияЭлементовФормы.Вставить("ДействияПанелиУдалениеСтрокиТабличногоПоля", Новый Действие("ДействияПанелиУдалениеСтрокиТабличногоПоля"));
ДействияЭлементовФормы.Вставить("ДействияПанелиКнопкаПодборНажатие", Новый Действие("ДействияПанелиКнопкаПодборНажатие"));
ДействияЭлементовФормы.Вставить("ПриНажатииНаКнопкуВверх", Новый Действие("ПриНажатииНаКнопкуВверх"));
ДействияЭлементовФормы.Вставить("ПриНажатииНаКнопкуВниз", Новый Действие("ПриНажатииНаКнопкуВниз"));
ДействияЭлементовФормы.Вставить("ГруппировкиПриПолученииДанных", Новый Действие("ГруппировкиПриПолученииДанных"));
