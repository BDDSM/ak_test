
Функция	ПолучитьADOСоединение(парСервер = "10.0.0.40", парLogin = "", парПароль = "") Экспорт
	
	Если парСервер = "" Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	парЛогин = ОбщегоНазначенияПовтИсп.ЗначениеКонстанты("ЛогинSQL");
	парПароль = ОбщегоНазначенияПовтИсп.ЗначениеКонстанты("ПарольSQL");
	
	ADOСоединение = Новый COMОбъект("ADODB.Connection");
	ADOСоединение.ConnectionTimeOut = 0;
	ADOСоединение.CommandTimeOut    = 0;
	ADOСоединение.ConnectionString  = "SERVER=" + парСервер + "; DRIVER=SQL Server; UID=" + парЛогин + "; PWD=" + парПароль + "; OLE DB Services=-2;";
	
	
	Попытка
		ADOСоединение.Open();
		
		Если ADOСоединение.State() = 0 Тогда
			Возврат Неопределено;
		Иначе
			Возврат ADOСоединение;
		КонецЕсли;
		
	Исключение
		Возврат Неопределено;
	КонецПопытки;           
	
КонецФункции
