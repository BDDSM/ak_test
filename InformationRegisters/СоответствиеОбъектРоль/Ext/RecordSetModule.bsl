
//+++АК LATV 2018.08.29 ИП-00019667
Процедура ПередЗаписью(Отказ, Замещение)

	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	ТекущийПользователь	= глЗначениеПеременной("глТекущийПользователь");
	Идентификаторы		= ИдентификаторыТиповРолей();
	
	Для каждого Запись Из ЭтотОбъект Цикл
		Запись.Автор = ТекущийПользователь;
		
		Если ПустаяСтрока(Запись.ТипРолиID) Тогда
			Запись.ТипРолиID = Идентификаторы.Получить(Запись.ТипРоли);
		КонецЕсли;
	КонецЦикла;

КонецПроцедуры

//+++АК LATV 2018.08.29 ИП-00019667
Функция ИдентификаторыТиповРолей()

	Идентификаторы = Новый Соответствие;
	
	ТипыРолейБезИдентификаторов = ЭтотОбъект.Выгрузить(, "ТипРоли, ТипРолиID").Скопировать(Новый Структура("ТипРолиID", ""), "ТипРоли");
	Если ТипыРолейБезИдентификаторов.Количество() > 0 Тогда
		
		ТипыРолейБезИдентификаторов.Свернуть("ТипРоли");
		ТипыРолей = ТипыРолейБезИдентификаторов.ВыгрузитьКолонку("ТипРоли");
		Идентификаторы = ОбщегоНазначения.ЗначениеРеквизитаОбъектов(ТипыРолей, "Код");
		
	КонецЕсли;
	
	Возврат Идентификаторы;

КонецФункции
