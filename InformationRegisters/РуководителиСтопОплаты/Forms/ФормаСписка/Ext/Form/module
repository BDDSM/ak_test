
Процедура РегистрСведенийСписокСотрудникПриИзменении(Элемент)
	ТекСтр = ЭлементыФормы.РегистрСведенийСписок.ТекущиеДанные;
	
	Если ЗначениеЗаполнено(ТекСтр.Сотрудник) и ЗначениеЗаполнено(ТекСтр.Сотрудник.ФизЛицо) и не ЗначениеЗаполнено(СокрЛП(ТекСтр.ЭлАдрес)) Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	КонтактнаяИнформация.Объект,
		|	КонтактнаяИнформация.Тип,
		|	КонтактнаяИнформация.Вид,
		|	КонтактнаяИнформация.Представление КАК EmailАдрес
		|ИЗ
		|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|ГДЕ
		|	КонтактнаяИнформация.Тип = &Тип
		|	И КонтактнаяИнформация.Вид = &Вид
		|	И КонтактнаяИнформация.Объект = &Объект";
		
		Запрос.УстановитьПараметр("Вид", Справочники.ВидыКонтактнойИнформации.EmailФизЛица);
		Запрос.УстановитьПараметр("Объект", ТекСтр.Сотрудник.ФизЛицо.Ссылка);
		Запрос.УстановитьПараметр("Тип", Перечисления.ТипыКонтактнойИнформации.АдресЭлектроннойПочты);
		
		Результат = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = Результат.Выбрать();
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			ТекСтр.ЭлАдрес = СокрЛП(ВыборкаДетальныеЗаписи.EmailАдрес);
		КонецЕсли;
	КонецЕсли;
	Если не ЗначениеЗаполнено(СокрЛП(ТекСтр.ЭлАдрес)) Тогда
		Сообщить("Заполните электронный адрес");
	КонецЕсли;
КонецПроцедуры

//+++АК LAGP 2017.11.23 ИП-00017258
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	ЕстьПравоРедактировать = УправлениеДопПравамиПользователей.ПолучитьПравоПользователяУпр(ПланыВидовХарактеристик.ПраваПользователей.РедактированиеРегистраРуководителиСтопОплат, Ложь);
	Если НЕ РольДоступна("ПолныеПрава") Тогда
		ЭтаФорма.ТолькоПросмотр = Не ЕстьПравоРедактировать;
	КонецЕсли;	
	
КонецПроцедуры
