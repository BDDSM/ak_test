
&НаКлиенте
Процедура ХарактеристикаПриИзменении(Элемент)
	Запись.Поставщик=ПолучитьПоставщика();
    Запись.СрокГодности=ПолучитьСрокГодности();
КонецПроцедуры

&НаСервере
Функция ПолучитьПоставщика()

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЦеныПоставщиковСрезПоследних.Поставщик
		|ИЗ
		|	РегистрСведений.ЦеныПоставщиков.СрезПоследних(
		|			,
		|			Номенклатура = &Номенклатура
		|				И Характеристика = &Характеристика) КАК ЦеныПоставщиковСрезПоследних";

	Запрос.УстановитьПараметр("Номенклатура", Запись.Номенклатура);
	Запрос.УстановитьПараметр("Характеристика", Запись.Характеристика);

	Результат = Запрос.Выполнить();

	ВыборкаДетальныеЗаписи = Результат.Выбрать();
    Поставщик=Неопределено;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Поставщик=ВыборкаДетальныеЗаписи.Поставщик;
	КонецЦикла;
    Возврат Поставщик;

КонецФункции // ()

&НаСервере
Функция ПолучитьСрокГодности()
	Если ЗначениеЗаполнено(Запись.Характеристика.СрокГодности) И ЗначениеЗаполнено(Запись.Характеристика.ТипСрокаГодности) Тогда
        Возврат Запись.Характеристика.СрокГодности*Запись.Характеристика.ТипСрокаГодности.КоэффициентВСутках;
	Иначе	
    	Возврат 0;
	КонецЕсли; 
КонецФункции // ()
 