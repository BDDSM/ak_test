	
Процедура РегистрСведенийСписокСотрудникПриИзменении(Элемент)
	
	ТекущаяСтрока = ЭлементыФормы.РегистрСведенийСписок.ТекущиеДанные;
	
	Если ЗначениеЗаполнено(ТекущаяСтрока.Сотрудник) И ЗначениеЗаполнено(ТекущаяСтрока.Сотрудник.ФизЛицо) И НЕ ЗначениеЗаполнено(СокрЛП(ТекущаяСтрока.ЭлектронныйАдрес)) Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КонтактнаяИнформация.Объект,
		|	КонтактнаяИнформация.Тип,
		|	КонтактнаяИнформация.Вид,
		|	КонтактнаяИнформация.Представление КАК EmailАдрес
		|ИЗ
		|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|ГДЕ
		|	КонтактнаяИнформация.Тип = &Тип
		|	И КонтактнаяИнформация.Вид = &Вид
		|	И КонтактнаяИнформация.Объект = &Объект";
		
		Запрос.УстановитьПараметр("Вид", Справочники.ВидыКонтактнойИнформации.EmailФизЛица);
		Запрос.УстановитьПараметр("Объект", ТекущаяСтрока.Сотрудник.ФизЛицо.Ссылка);
		Запрос.УстановитьПараметр("Тип", Перечисления.ТипыКонтактнойИнформации.АдресЭлектроннойПочты);
		
		Результат = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = Результат.Выбрать();
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			ТекущаяСтрока.ЭлектронныйАдрес = СокрЛП(ВыборкаДетальныеЗаписи.EmailАдрес);
		КонецЕсли;
	КонецЕсли;
	
	Если не ЗначениеЗаполнено(СокрЛП(ТекущаяСтрока.ЭлектронныйАдрес)) Тогда
		Сообщить("Заполните электронный адрес");
	КонецЕсли;

КонецПроцедуры
