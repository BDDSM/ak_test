
#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура РаспечататьПротокол(Команда)
	
	НапечататьПротоколКлиент();

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура НапечататьПротоколКлиент()
	
	ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	Если ТекущиеДанные <> Неопределено Тогда 
		
		НапечататьПротоколАттестации(Новый Структура("Организация, ВидАттестации, ФизЛицо, Период", 
			ТекущиеДанные.Организация, ТекущиеДанные.ВидАттестации, ТекущиеДанные.ФизЛицо, ТекущиеДанные.Период));
		
	    Если ТабДок.Области.Количество()> 0 Тогда
			ОткрытьФорму("ОбщаяФорма.ФормаПечати", Новый Структура("ТабДок", ТабДок));
		Иначе
			ПоказатьПредупреждение(,"Отсутствуют данные по установленному отбору! Печать протокола невозможна!");
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура НапечататьПротоколАттестации(СтруктураПараметров)
	
	РегистрыСведений.ИтогиПрохожденияАттестацииСотрудников.НапечататьПротоколАттестации(СтруктураПараметров, ТабДок);
	
КонецПроцедуры

#КонецОбласти

