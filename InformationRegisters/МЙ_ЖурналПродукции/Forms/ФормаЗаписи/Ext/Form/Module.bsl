
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если НЕ ЗначениеЗаполнено(Запись.UUID_ВСД) Тогда
		Элементы.ОткрытьВСД.Заголовок = "Ветеринарный документ в системе ""Ветис"" не привязан";
		Элементы.ОткрытьВСД.Доступность = Ложь;		
	КонецЕсли; 

КонецПроцедуры

&НаСервере
Функция ПолучитьКлючЗаписиВСД()
	
	Результат = ОбменССистемойВетис.ЗагрузитьВСД(,,, Запись.UUID_ВСД, Запись.СтруктурнаяЕдиница);
	
	Если Результат = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли; 
	
	Возврат РегистрыСведений.МЙ_ВетеринарныеДокументы.СоздатьКлючЗаписи(Новый Структура("UUID", Запись.UUID_ВСД));
	
КонецФункции

&НаКлиенте
Процедура ОткрытьВСДНажатие(Элемент)
	
	КлючЗаписи = ПолучитьКлючЗаписиВСД();
	
	Если КлючЗаписи = Неопределено Тогда
		Сообщить("Выбранная ВСД не загружена из системы Ветис!" ); 
		Возврат;
	КонецЕсли; 
	
	ПараметрыОткрытия = Новый Структура("Ключ", КлючЗаписи);
	
	ОткрытьФорму("РегистрСведений.МЙ_ВетеринарныеДокументы.Форма.ФормаЗаписи", ПараметрыОткрытия);

КонецПроцедуры
