
Процедура ПриОткрытии()
	
	Если РольДоступна("Финансист") или  РольДоступна("ПолныеПрава") Тогда
		
	Иначе
		Сообщить("Настройка констант по размену только у ролей Финансист и ПолныеПрава");
		ЭтаФорма.ТолькоПросмотр = Истина;
	КонецЕсли;
	ВремяОкончанияРедакитрования = Константы.АК_ВремяОкончанияРедактированияРазмен.Получить();
	хрКаталоговИнкасаторскихШаблонов = Константы.АК_ПапкаХраненияРазмен.Получить();
	тзКаталогов = хрКаталоговИнкасаторскихШаблонов.Получить();
	Если тзКаталогов = Неопределено Тогда
		тзКаталогов = Новый ТаблицаЗначений;
	КонецЕсли; 
	КаталогХраненияШаблонов.Очистить();
	Для каждого Стр Из тзКаталогов Цикл
		НовСтр = КаталогХраненияШаблонов.Добавить();
		ЗаполнитьЗначенияСвойств(НовСтр,Стр);		
	КонецЦикла;
	
КонецПроцедуры


&НаСервере
Функция РольДоступнаСервер(Роль)
	
	
	Возврат РольДоступна(Роль);
КонецФункции // ()

Процедура АК_ПапкаХраненияРазменНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогОткрытияФайла.ПолноеИмяФайла = КонстантыНабор.АК_ПапкаХраненияРазмен;
	ДиалогОткрытияФайла.Фильтр = "(*.xls)|*.xls";
	ДиалогОткрытияФайла.Заголовок = "Выберите файл шаблона.";
	Если ДиалогОткрытияФайла.Выбрать() Тогда
		КонстантыНабор.АК_ПапкаХраненияРазмен =    ДиалогОткрытияФайла.ПолноеИмяФайла;
	КонецЕсли;
	
	
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	
	Константы.АК_ВремяОкончанияРедактированияРазмен.Установить(ВремяОкончанияРедакитрования);
	
	хрТЗКаталогов = Новый ХранилищеЗначения(КаталогХраненияШаблонов);
	Константы.АК_ПапкаХраненияРазмен.Установить(хрТЗКаталогов);
	
КонецПроцедуры

