
Процедура СкладПриИзменении(Элемент)
	Если ЗначениеЗаполнено(Склад) Тогда
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Склад", Склад);
		Запрос.УстановитьПараметр("ОтборПоСкладу", ЗначениеЗаполнено(Склад));
		Запрос.УстановитьПараметр("ЦФО", ЦФО);
		Запрос.УстановитьПараметр("ОтборПоЦФО", ЗначениеЗаполнено(ЦФО));
		Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		               |	ПоступлениеОС.Ссылка
		               |ИЗ
		               |	Документ.ПоступлениеОС КАК ПоступлениеОС
		               |ГДЕ
		               |	(ПоступлениеОС.Склад = &Склад
		               |				И &ОтборПоСкладу
		               |			ИЛИ ПоступлениеОС.ЦФО = &ЦФО
		               |				И &ОтборПоЦФО)
		               |
		               |ОБЪЕДИНИТЬ ВСЕ
		               |
		               |ВЫБРАТЬ
		               |	ПеремещениеОС.Ссылка
		               |ИЗ
		               |	Документ.ПеремещениеОС КАК ПеремещениеОС
		               |ГДЕ
		               |	((ПеремещениеОС.СкладОтправитель = &Склад
		               |				ИЛИ ПеремещениеОС.СкладПолучатель = &Склад)
		               |				И &ОтборПоСкладу
		               |			ИЛИ (ПеремещениеОС.ЦФООтправитель = &ЦФО
		               |				ИЛИ ПеремещениеОС.ЦФОПолучатель = &ЦФО)
		               |				И &ОтборПоЦФО)
		               |
		               |ОБЪЕДИНИТЬ ВСЕ
		               |
		               |ВЫБРАТЬ
		               |	СписаниеОС.Ссылка
		               |ИЗ
		               |	Документ.СписаниеОС КАК СписаниеОС
		               |ГДЕ
		               |	((СписаниеОС.СкладОтправитель = &Склад
		               |				ИЛИ СписаниеОС.СкладПолучатель = &Склад)
		               |				И &ОтборПоСкладу
		               |			ИЛИ (СписаниеОС.ЦФООтправитель = &ЦФО
		               |				ИЛИ СписаниеОС.ЦФОПолучатель = &ЦФО)
		               |				И &ОтборПоЦФО)";
		ЖурналДокументовСписок.Отбор.Ссылка.ВидСравнения = ВидСравнения.ВСписке;
		спДокументы = Новый СписокЗначений;
		спДокументы.ЗагрузитьЗначения(Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка"));
		ЖурналДокументовСписок.Отбор.Ссылка.Значение = спДокументы;
		ЖурналДокументовСписок.Отбор.Ссылка.Использование = Истина;
	Иначе
		ЖурналДокументовСписок.Отбор.Ссылка.Использование = Ложь;
		ЖурналДокументовСписок.Отбор.Ссылка.ВидСравнения = ВидСравнения.Равно;
		ЖурналДокументовСписок.Отбор.Ссылка.Значение = Неопределено;
	КонецЕсли;
КонецПроцедуры
